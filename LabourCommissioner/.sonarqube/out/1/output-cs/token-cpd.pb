¢N
JD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\aadharcard.cs
	namespace 	
LabourCommissioner
 
. 
Common #
{ 
public		 

class		 

aadharcard		 
{

 
static 
int 
[ 
, 
] 
d 
= 
new 
int !
[! "
," #
]# $
{ 
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
,  !
{ 
$num 
, 
$num 
, 
$num	 

,
 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
}  
} 
; 
static 
int 
[ 
, 
] 
p 
= 
new 
int !
[! "
," #
]# $
{	 

{ 
$num 	
,	 

$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num  !
,! "
$num# $
}$ %
,% &
{ 
$num 	
,	 

$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num  !
,! "
$num# $
}$ %
,% &
{ 
$num 	
,	 

$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num  !
,! "
$num# $
}$ %
,% &
{ 
$num 	
,	 

$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num  !
,! "
$num# $
}$ %
,% &
{ 
$num 	
,	 

$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num 
, 
$num  !
,! "
$num# $
}$ %
,% &
{   
$num   	
,  	 

$num   
,   
$num   
,   
$num   
,   
$num   
,   
$num   
,   
$num   
,   
$num   
,   
$num    !
,  ! "
$num  # $
}  $ %
,  % &
{!! 
$num!! 	
,!!	 

$num!! 
,!! 
$num!! 
,!! 
$num!! 
,!! 
$num!! 
,!! 
$num!! 
,!! 
$num!! 
,!! 
$num!! 
,!! 
$num!!  !
,!!! "
$num!!# $
}!!$ %
,!!% &
{"" 
$num"" 	
,""	 

$num"" 
,"" 
$num"" 
,"" 
$num"" 
,"" 
$num"" 
,"" 
$num"" 
,"" 
$num"" 
,"" 
$num"" 
,"" 
$num""  !
,""! "
$num""# $
}""$ %
}##	 

;##
 
static%% 
int%% 
[%% 
]%% 
inv%% 
=%% 
{%% 
$num%% 
,%% 
$num%%  !
,%%! "
$num%%# $
,%%$ %
$num%%& '
,%%' (
$num%%) *
,%%* +
$num%%, -
,%%- .
$num%%/ 0
,%%0 1
$num%%2 3
,%%3 4
$num%%5 6
,%%6 7
$num%%8 9
}%%: ;
;%%; <
public'' 
static'' 
bool'' 
validateVerhoeff'' +
(''+ ,
string'', 2
num''3 6
)''6 7
{(( 	
int)) 
c)) 
=)) 
$num)) 
;)) 
int)) 
[)) 
])) 
myArray)) $
=))% &$
StringToReversedIntArray))' ?
())? @
num))@ C
)))C D
;))D E
for** 
(** 
int** 
i** 
=** 
$num** 
;** 
i** 
<** 
myArray**  '
.**' (
Length**( .
;**. /
i**0 1
++**1 3
)**3 4
{++ 
c,, 
=,, 
d,, 
[,, 
c,, 
,,, 
p,, 
[,, 
(,, 
i,, 
%,, 
$num,,  !
),,! "
,,," #
myArray,,$ +
[,,+ ,
i,,, -
],,- .
],,. /
],,/ 0
;,,0 1
}-- 
return.. 
c.. 
==.. 
$num.. 
;.. 
}00 	
private11 
static11 
int11 
[11 
]11 $
StringToReversedIntArray11 5
(115 6
string116 <
num11= @
)11@ A
{22 	
int33 
[33 
]33 
myArray33 
=33 
new33 
int33  #
[33# $
num33$ '
.33' (
Length33( .
]33. /
;33/ 0
for44 
(44 
int44 
i44 
=44 
$num44 
;44 
i44 
<44 
num44  #
.44# $
Length44$ *
;44* +
i44, -
++44- /
)44/ 0
{55 
myArray66 
[66 
i66 
]66 
=66 
int66  
.66  !
Parse66! &
(66& '
num66' *
.66* +
	Substring66+ 4
(664 5
i665 6
,666 7
$num668 9
)669 :
)66: ;
;66; <
}77 
Array88 
.88 
Reverse88 
(88 
myArray88 !
)88! "
;88" #
return88$ *
myArray88+ 2
;882 3
}99 	
}:: 
};; 
FD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\Class1.cs
	namespace 	
LabourCommissioner
 
. 
Common #
{ 
public 

class 
Class1 
{ 
} 
} Í
ND:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\CouchDBRequest.cs
	namespace		 	
LabourCommissioner		
 
.		 
Common		 #
{

 
public 

class 
CouchDBRequest 
{ 
[ 	

JsonIgnore	 
] 
public 
string 
Id 
{ 	
get 
; 
set 
; 
} 	
[ 	

JsonIgnore	 
] 
public 
string 
Rev 
{ 	
get 
; 
set 
; 
} 	
public 
string 
Name 
{ 	
get 
; 
set 
; 
} 	
public 
string 
EmailAddress "
{ 	
get   
;   
set!! 
;!! 
}"" 	
public## 
string## 

CourseName##  
{$$ 	
get%% 
;%% 
set&& 
;&& 
}'' 	
public(( 
string(( 
Comments(( 
{)) 	
get** 
;** 
set++ 
;++ 
},, 	
[-- 	

JsonIgnore--	 
]-- 
public.. 
	IFormFile.. 
File.. 
{// 	
get00 
;00 
set11 
;11 
}22 	
public33 
string33 
FileName33 
{44 	
get55 
;55 
set66 
;66 
}77 	
public88 
string88 
FileExtension88 #
{99 	
get:: 
;:: 
set;; 
;;; 
}<< 	
[== 	

JsonIgnore==	 
]== 
public>> 
byte>> 
[>> 
]>> 
AttachmentData>> $
{?? 	
get@@ 
;@@ 
setAA 
;AA 
}BB 	
publicCC 
stringCC 
	CreatedOnCC 
{DD 	
getEE 
;EE 
setFF 
;FF 
}GG 	
}HH 
}II ğ
OD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\CouchDBResponse.cs
	namespace 	
LabourCommissioner
 
. 
Common #
{ 
public 

class 
CouchDBResponse  
{ 
public 
bool 
	IsSuccess 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Rev 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Result 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
Task		 
<		 
byte		 
[		 
]		 
>		 
	ImageData		 %
{		& '
get		( +
;		+ ,
set		- 0
;		0 1
}		2 3
}

 
} ğ¶
JD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\Procedures.cs
	namespace 	
LabourCommissioner
 
. 
Common #
{ 
public		 

class		 

Procedures		 
{

 
public 
static 
string !
AddUpdateRegistration 2
=3 4
$str5 F
;F G
public 
static 
string )
BOCW_SSY_AddUpdateApplication :
=; <
$str= ]
;] ^
public 
static 
string  
GetLevelNoFromPostId 1
=2 3
$str4 H
;H I
public 
static 
string %
BOCW_SSY_AddSchemeDetails 6
=7 8
$str9 W
;W X
public 
static 
string &
GetApplicationCountByRegId 7
=8 9
$str: V
;V W
public 
static 
string 2
&GetApplicationCountByRegIdAndServiceId C
=D E
$strF n
;n o
public 
static 
string 
	GetUserId &
=' (
$str) 9
;9 :
public 
static 
string -
!BOCW_SSY_AddUpdateDocumentDetails >
=? @
$strA a
;a b
public 
static 
string 2
&BOCW_SSY_InsertTabEntryDocumentDetails C
=D E
$strF Y
;Y Z
public 
static 
string 
AthenticateUser ,
=- .
$str/ C
;C D
public 
static 
string 
AthenticateEmployee 0
=1 2
$str3 I
;I J
public 
static 
string !
authenticateotheruser 2
=3 4
$str5 L
;L M
public 
static 
string 
ChangePassword +
=, -
$str. >
;> ?
public 
static 
string &
BindServicesUserWiseFilter 7
=8 9
$str: V
;V W
public 
static 
string 6
*BindAppcountDistrictTalukaWiseForDashboard G
=H I
$strJ v
;v w
public 
static 
string $
BindAppCountForDashboard 5
=6 7
$str8 R
;R S
public 
static 
string )
BindCountForDashboardGLWB_tsy :
=; <
$str= _
;_ `
public 
static 
string "
BindAdminDashBoardData 3
=4 5
$str6 N
;N O
public 
static 
string .
"BindAppCountSchemeWiseForDashboard ?
=@ A
$strB f
;f g
public 
static 
string 
BindMenuRoleWise -
=. /
$str0 B
;B C
public 
static 
string 
CheckPermission ,
=- .
$str/ @
;@ A
public!! 
static!! 
string!!  
GetSchemeByServiceId!! 1
=!!2 3
$str!!4 J
;!!J K
public## 
static## 
string## 
GetServiceId## )
=##* +
$str##, :
;##: ;
public$$ 
static$$ 
string$$ $
GetSchemeByBeneficiaryId$$ 5
=$$6 7
$str$$8 V
;$$V W
public%% 
static%% 
string%% #
CitizenPasswordRecovery%% 4
=%%5 6
$str%%7 P
;%%P Q
public&& 
static&& 
string&& $
GetServiceTabByServiceId&& 5
=&&6 7
$str&&8 R
;&&R S
public'' 
static'' 
string'' )
GetTabSequenceByApplicationId'' :
=''; <
$str''= \
;''\ ]
public(( 
static(( 
string(( %
GetPersonalDetailsByRegNo(( 6
=((7 8
$str((9 T
;((T U
public)) 
static)) 
string)) #
GetWorkerDetailsByRegNo)) 4
=))5 6
$str))7 P
;))P Q
public** 
static** 
string** '
GetCompanyDetailsByUserName** 8
=**9 :
$str**; X
;**X Y
public++ 
static++ 
string++ (
GetHospitalDetailsByUserName++ 9
=++: ;
$str++< Z
;++Z [
public,, 
static,, 
string,, (
GetApplicationDetailsByAppId,, 9
=,,: ;
$str,,< Z
;,,Z [
public-- 
static-- 
string-- -
!GLWB_GetApplicationDetailsByAppId-- >
=--? @
$str--A d
;--d e
public.. 
static.. 
string.. 1
%GLWB_TSY_GetApplicationDetailsByAppId.. B
=..C D
$str..E l
;..l m
public// 
static// 
string// 7
+GLWB_TSY_Claim_GetApplicationDetailsByAppId// H
=//I J
$str//K x
;//x y
public00 
static00 
string00 .
"GetApplicationSchemeDetailsByAppId00 ?
=00@ A
$str00B f
;00f g
public11 
static11 
string11 8
,bocw_Hssy_getapplicationschemedetailsbyappid11 I
=11J K
$str11L z
;11z {
public22 
static22 
string22 8
,BOCW_ACSY_GetApplicationSchemeDetailsByAppId22 I
=22J K
$str22L z
;22z {
public33 
static33 
string33 8
,GetBocw_Tbsy_Claim_ApplicationDetailsByAppId33 I
=33J K
$str33L z
;33z {
public44 
static44 
string44 .
"getbocw_tbsyapplicationforhospital44 ?
=44@ A
$str44B f
;44f g
public55 
static55 
string55 /
#getemployeeuploadeddocumentsbyappid55 @
=55A B
$str55C r
;55r s
public66 
static66 
string66 /
#gethospitaluploadeddocumentsbyappid66 @
=66A B
$str66C r
;66r s
public88 
static88 
string88 5
)Bocw_vrgetapplicationschemedetailsbyappid88 F
=88G H
$str88I t
;88t u
public99 
static99 
string99 G
;Bocw_vrgetapplicationschemedetailsbyappidotherschemedetails99 X
=99Y Z
$str	99[ 
;
99 
public:: 
static:: 
string:: -
!getrpt_bocw_vr_otherschemedetails:: >
=::? @
$str::A d
;::d e
public<< 
static<< 
string<< 9
-BOCW_Nanji_GetApplicationSchemeDetailsByAppId<< J
=<<K L
$str<<M |
;<<| }
public== 
static== 
string== 7
+BOCW_VCY_GetApplicationSchemeDetailsByAppId== H
===I J
$str==K x
;==x y
public>> 
static>> 
string>> 6
*GLWBHSC_GetApplicationSchemeDetailsByAppId>> G
=>>H I
$str>>J v
;>>v w
public?? 
static?? 
string?? 6
*GLWBSSC_GetApplicationSchemeDetailsByAppId?? G
=??H I
$str??J v
;??v w
public@@ 
static@@ 
string@@  
GetUploadedDocuments@@ 1
=@@2 3
$str@@4 J
;@@J K
publicAA 
staticAA 
stringAA 
GetDistrictAA (
=AA) *
$strAA+ ?
;AA? @
publicBB 
staticBB 
stringBB  
GetDistrictForMasterBB 1
=BB2 3
$strBB4 Q
;BBQ R
publicCC 
staticCC 
stringCC 
GetRoleCC $
=CC% &
$strCC' 7
;CC7 8
publicDD 
staticDD 
stringDD 
GetPostDataDD (
=DD) *
$strDD+ 8
;DD8 9
publicEE 
staticEE 
stringEE 
getpostmasterdataEE .
=EE/ 0
$strEE1 D
;EED E
publicFF 
staticFF 
stringFF 
getmenumasterdataFF .
=FF/ 0
$strFF1 D
;FFD E
publicGG 
staticGG 
stringGG 
getdistrictdataGG ,
=GG- .
$strGG/ @
;GG@ A
publicHH 
staticHH 
stringHH #
getserviceschedulerdataHH 4
=HH5 6
$strHH7 P
;HHP Q
publicII 
staticII 
stringII 
getvillagedataII +
=II, -
$strII. >
;II> ?
publicJJ 
staticJJ 
stringJJ !
getdocumentmasterdataJJ 2
=JJ3 4
$strJJ5 L
;JJL M
publicKK 
staticKK 
stringKK 
getresourcedataKK ,
=KK- .
$strKK/ @
;KK@ A
publicLL 
staticLL 
stringLL %
getServicebybenificiaryidLL 6
=LL7 8
$strLL9 M
;LLM N
publicMM 
staticMM 
stringMM 
bindresourcevaluesMM /
=MM0 1
$strMM2 F
;MMF G
publicNN 
staticNN 
stringNN 
bindresourcevaluessNN 0
=NN1 2
$strNN3 H
;NNH I
publicOO 
staticOO 
stringOO 
getdocumentmasterOO .
=OO/ 0
$strOO1 D
;OOD E
publicPP 
staticPP 
stringPP 
gettalukadataPP *
=PP+ ,
$strPP- <
;PP< =
publicQQ 
staticQQ 
stringQQ 
gettalukamasterdataQQ 0
=QQ1 2
$strQQ3 H
;QQH I
publicRR 
staticRR 
stringRR 
GetDistrictMasterRR .
=RR/ 0
$strRR1 D
;RRD E
publicSS 
staticSS 
stringSS %
getServiceschedulermasterSS 6
=SS7 8
$strSS9 T
;SST U
publicTT 
staticTT 
stringTT 
getvillagemastersTT .
=TT/ 0
$strTT1 D
;TTD E
publicUU 
staticUU 
stringUU )
binddiseasesandinjuriesmasterUU :
=UU; <
$strUU= \
;UU\ ]
publicVV 
staticVV 
stringVV  
GetFinancialYearListVV 1
=VV2 3
$strVV4 M
;VVM N
publicWW 
staticWW 
stringWW 
bindglwbemployeeWW -
=WW. /
$strWW0 B
;WWB C
publicXX 
staticXX 
stringXX 2
&GetGLWBEmployeeDetailsbyRegistrationidXX C
=XXD E
$strXXF n
;XXn o
publicYY 
staticYY 
stringYY 
GetDivisionYY (
=YY) *
$strYY+ ?
;YY? @
publicZZ 
staticZZ 
stringZZ %
GetEmployeeRoleForApproveZZ 6
=ZZ7 8
$strZZ9 P
;ZZP Q
public[[ 
static[[ 
string[[ &
GetEmployeeRoleForSendBack[[ 7
=[[8 9
$str[[: R
;[[R S
public\\ 
static\\ 
string\\ #
GetSendBackRoleGLWb_TSY\\ 4
=\\5 6
$str\\7 W
;\\W X
public]] 
static]] 
string]] !
GetApplicationHistory]] 2
=]]3 4
$str]]5 R
;]]R S
public^^ 
static^^ 
string^^ 0
$GetApplicationHistory_Glwb_Tsy_claim^^ A
=^^B C
$str^^D g
;^^g h
public__ 
static__ 
string__ #
GetHospitalScheduleTime__ 4
=__5 6
$str__7 P
;__P Q
public`` 
static`` 
string`` 
GetAllStates`` )
=``* +
$str``, =
;``= >
publicaa 
staticaa 
stringaa !
GetTalukaByDistrictIdaa 2
=aa3 4
$straa5 G
;aaG H
publicbb 
staticbb 
stringbb $
GetSubServiceByServiceIdbb 5
=bb6 7
$strbb8 N
;bbN O
publiccc 
staticcc 
stringcc '
GetDistrictNamebyDivisionIdcc 8
=cc9 :
$strcc; X
;ccX Y
publicdd 
staticdd 
stringdd !
GetSemesterbyCourseIddd 2
=dd3 4
$strdd5 C
;ddC D
publicee 
staticee 
stringee  
GetBenifitByCourseIdee 1
=ee2 3
$stree4 C
;eeC D
publicgg 
staticgg 
stringgg $
GetTotalsahayByServiceIDgg 5
=gg6 7
$strgg8 R
;ggR S
publicii 
staticii 
stringii /
#Get_BOCW_BPSY_TotalsahayByServiceIDii @
=iiA B
$striiC h
;iih i
publicjj 
staticjj 
stringjj -
!GetVillageByDistrictIdAndTalukaIdjj >
=jj? @
$strjjA T
;jjT U
publickk 
statickk 
stringkk .
"GetVillageByDistrictIdAndTalukaIdskk ?
=kk@ A
$strkkB V
;kkV W
publicll 
staticll 
stringll 
BindResourceValuell .
=ll/ 0
$strll1 D
;llD E
publicmm 
staticmm 
stringmm 
GetFileDocumentsmm -
=mm. /
$strmm0 B
;mmB C
publicnn 
staticnn 
stringnn 
GetSchemeUsersnn +
=nn, -
$strnn. >
;nn> ?
publicoo 
staticoo 
stringoo 

GetCitizenoo '
=oo( )
$stroo* :
;oo: ;
publicpp 
staticpp 
stringpp 
GetApplicationpp +
=pp, -
$strpp. >
;pp> ?
publicqq 
staticqq 
stringqq "
GetGLWB_HTYApplicationqq 3
=qq4 5
$strqq6 N
;qqN O
publicrr 
staticrr 
stringrr )
Glwb_TSY_Claim_GetApplicationrr :
=rr; <
$strrr= \
;rr\ ]
publicss 
staticss 
stringss #
GetBocw_TBSYApplicationss 4
=ss5 6
$strss7 P
;ssP Q
publictt 
statictt 
stringtt #
Glwb_TSY_GetApplicationtt 4
=tt5 6
$strtt7 P
;ttP Q
publicuu 
staticuu 
stringuu $
Bocw_Tbsy_GetApplicationuu 5
=uu6 7
$struu8 R
;uuR S
publicvv 
staticvv 
stringvv ,
 Glwb_TSY_Hospital_GetApplicationvv =
=vv> ?
$strvv@ b
;vvb c
publicww 
staticww 
stringww #
GLWB_HSC_GetApplicationww 4
=ww5 6
$strww7 P
;wwP Q
publicxx 
staticxx 
stringxx  
GetDegreeBySubjectIdxx 1
=xx2 3
$strxx4 F
;xxF G
publicyy 
staticyy 
stringyy 
GetLastLevelyy )
=yy* +
$stryy, <
;yy< =
publiczz 
staticzz 
stringzz +
GetReportPersonalDetailsByAppIdzz <
=zz= >
$strzz? V
;zzV W
public{{ 
static{{ 
string{{ 4
(GetReportGLWB_SSC_PersonalDetailsByAppId{{ E
={{F G
$str{{H i
;{{i j
public|| 
static|| 
string|| 4
(GetReportGLWB_PSY_PersonalDetailsByAppId|| E
=||F G
$str||H i
;||i j
public}} 
static}} 
string}} +
getrpt_glwb_asy_personaldetails}} <
=}}= >
$str}}? `
;}}` a
public~~ 
static~~ 
string~~ 4
(GetReportGLWB_Hsc_PersonalDetailsByAppId~~ E
=~~F G
$str~~H i
;~~i j
public 
static 
string 5
)GetReportGLWB_adsy_PersonalDetailsByAppId F
=G H
$strI k
;k l
public
 
static
 
string
 6
(GetReportGLWB_MSL_PersonalDetailsByAppId
 E
=
F G
$str
H i
;
i j
public
 
static
 
string
 6
(GetReportGLWB_CSY_PersonalDetailsByAppId
 E
=
F G
$str
H i
;
i j
public
 
static
 
string
 %
GetSchemeDetailsByAppId
 4
=
5 6
$str
7 L
;
L M
public
 
static
 
string
 '
GetdocumentDetailsByAppId
 6
=
7 8
$str
9 P
;
P Q
public
 
static
 
string
 %
GetSmsContentForService
 4
=
5 6
$str
7 P
;
P Q
public
 
static
 
string
 .
 GLWB_TSY_GetSmsContentForService
 =
=
> ?
$str
@ b
;
b c
public
 
static
 
string
 4
&GLWB_TSY_claim_GetSmsContentForService
 C
=
D E
$str
F n
;
n o
public
 
static
 
string
 8
*GLWBPSY_GetApplicationSchemeDetailsByAppId
 G
=
H I
$str
J w
;
w x
public
 
static
 
string
 8
*GLWBASY_GetApplicationSchemeDetailsByAppId
 G
=
H I
$str
J w
;
w x
public
 
static
 
string
 9
+GLWBADSY_GetApplicationSchemeDetailsByAppId
 H
=
I J
$str
K y
;
y z
public
 
static
 
string
 9
+glwb_hty_getapplicationschemedetailsbyappid
 H
=
I J
$str
K x
;
x y
public
 
static
 
string
 ?
1glwb_hty_claim_getapplicationschemedetailsbyappid
 N
=
O P
$strQ 
; 
public
 
static
 
string
 ,
getrpt_bocw_bpsy_schemedetails
 ;
=
< =
$str
> ^
;
^ _
public
 
static
 
string
 ,
getrpt_bocw_tbsy_schemedetails
 ;
=
< =
$str
> ^
;
^ _
public
 
static
 
string
 +
getrpt_bocw_psy_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 +
getrpt_glwb_hsc_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 +
getrpt_glwb_psy_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 +
getrpt_glwb_ssc_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 +
getrpt_bocw_asy_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 +
getrpt_bocw_tsy_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 +
getrpt_bocw_vcy_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 +
getrpt_bocw_pip_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 *
getrptglwb_hty_schemedetails
 9
=
: ;
$str
< [
;
[ \
public
 
static
 
string
 0
"getrptglwb_hty_claim_schemedetails
 ?
=
@ A
$str
B g
;
g h
public
 
static
 
string
 +
getrpt_glwb_asy_schemedetails
 :
=
; <
$str
= \
;
\ ]
public
   
static
   
string
   '
getrptbocwvrschemedetails
   6
=
  7 8
$str
  9 W
;
  W X
public
¡¡ 
static
¡¡ 
string
¡¡ ,
getrpt_bocw_acsy_schemedetails
¡¡ ;
=
¡¡< =
$str
¡¡> ^
;
¡¡^ _
public
¢¢ 
static
¢¢ 
string
¢¢ .
 GetReportGLWB_adsy_SchemeDetails
¢¢ =
=
¢¢> ?
$str
¢¢@ `
;
¢¢` a
public
¥¥ 
static
¥¥ 
string
¥¥ 6
(GetReportGLWB_tsy_PersonalDetailsByAppId
¥¥ E
=
¥¥F G
$str
¥¥H r
;
¥¥r s
public
¦¦ 
static
¦¦ 
string
¦¦ 6
(GetReportGLWB_HTY_PersonalDetailsByAppId
¦¦ E
=
¦¦F G
$str
¦¦H i
;
¦¦i j
public
¨¨ 
static
¨¨ 
string
¨¨ *
getrptglwb_msl_schemedetails
¨¨ 9
=
¨¨: ;
$str
¨¨< [
;
¨¨[ \
public
©© 
static
©© 
string
©© *
getrptglwb_csy_schemedetails
©© 9
=
©©: ;
$str
©©< [
;
©©[ \
public
¬¬ 
static
¬¬ 
string
¬¬ :
,BOCW_BPSY_GetApplicationSchemeDetailsByAppId
¬¬ I
=
¬¬J K
$str
¬¬L z
;
¬¬z {
public
­­ 
static
­­ 
string
­­ 9
+BOCW_PSY_GetApplicationSchemeDetailsByAppId
­­ H
=
­­I J
$str
­­K x
;
­­x y
public
®® 
static
®® 
string
®® 9
+GLWB_CSY_GetApplicationSchemeDetailsByAppId
®® H
=
®®I J
$str
®®K w
;
®®w x
public
²² 
static
²² 
string
²² '
BOCW_asy_AddSchemeDetails
²² 6
=
²²7 8
$str
²²9 W
;
²²W X
public
³³ 
static
³³ 
string
³³ +
BOCW_asy_AddUpdateApplication
³³ :
=
³³; <
$str
³³= ]
;
³³] ^
public
´´ 
static
´´ 
string
´´ 9
+BOCW_asy_GetApplicationSchemeDetailsByAppId
´´ H
=
´´I J
$str
´´K x
;
´´x y
public
µµ 
static
µµ 
string
µµ :
,BOCW_tbsy_GetApplicationSchemeDetailsByAppId
µµ I
=
µµJ K
$str
µµL z
;
µµz {
public
¶¶ 
static
¶¶ 
string
¶¶ :
,bocw_hssy_getapplicationschemedetailsbyappid
¶¶ I
=
¶¶J K
$str
¶¶L z
;
¶¶z {
public
¹¹ 
static
¹¹ 
string
¹¹ @
2bocw_hssy_getapplicationschemedetailsbyappidHostel
¹¹ O
=
¹¹P Q
$str¹¹R 
;¹¹ 
public
ºº 
static
ºº 
string
ºº G
9bocw_hssy_getapplicationschemedetailsbyappidfamilydetails
ºº V
=
ººW X
$strººY 
;ºº 
public
½½ 
static
½½ 
string
½½ 9
+glwb_tsy_GetApplicationSchemeDetailsByAppId
½½ H
=
½½I J
$str
½½K x
;
½½x y
public
¾¾ 
static
¾¾ 
string
¾¾ ?
1glwb_tsy_claim_GetApplicationSchemeDetailsByAppId
¾¾ N
=
¾¾O P
$str¾¾Q 
;¾¾ 
public
¿¿ 
static
¿¿ 
string
¿¿ >
0Glwb_Tsy_getapplicationschemedetailsbyappidclaim
¿¿ M
=
¿¿N O
$str¿¿P 
;¿¿ 
public
ÀÀ 
static
ÀÀ 
string
ÀÀ *
getrptglwb_tsy_schemedetails
ÀÀ 9
=
ÀÀ: ;
$str
ÀÀ< [
;
ÀÀ[ \
public
ÁÁ 
static
ÁÁ 
string
ÁÁ 1
#getrptglwb_tsy_companyWorkerDetails
ÁÁ @
=
ÁÁA B
$str
ÁÁC i
;
ÁÁi j
public
ÂÂ 
static
ÂÂ 
string
ÂÂ )
getrpt_glwb_tsy_getagecount
ÂÂ 8
=
ÂÂ9 :
$str
ÂÂ; X
;
ÂÂX Y
public
ÅÅ 
static
ÅÅ 
string
ÅÅ 9
+BOCW_tsy_GetApplicationSchemeDetailsByAppId
ÅÅ H
=
ÅÅI J
$str
ÅÅK x
;
ÅÅx y
public
ÆÆ 
static
ÆÆ 
string
ÆÆ '
BOCW_tsy_AddSchemeDetails
ÆÆ 6
=
ÆÆ7 8
$str
ÆÆ9 W
;
ÆÆW X
public
ÇÇ 
static
ÇÇ 
string
ÇÇ +
BOCW_tsy_AddUpdateApplication
ÇÇ :
=
ÇÇ; <
$str
ÇÇ= ]
;
ÇÇ] ^
public
ÊÊ 
static
ÊÊ 
string
ÊÊ 9
+BOCW_pip_GetApplicationSchemeDetailsByAppId
ÊÊ H
=
ÊÊI J
$str
ÊÊK x
;
ÊÊx y
public
ËË 
static
ËË 
string
ËË '
BOCW_pip_AddSchemeDetails
ËË 6
=
ËË7 8
$str
ËË9 W
;
ËËW X
public
ÌÌ 
static
ÌÌ 
string
ÌÌ +
BOCW_pip_AddUpdateApplication
ÌÌ :
=
ÌÌ; <
$str
ÌÌ= ]
;
ÌÌ] ^
public
ÎÎ 
static
ÎÎ 
string
ÎÎ 8
*GLWBMSL_GetApplicationSchemeDetailsByAppId
ÎÎ G
=
ÎÎH I
$str
ÎÎJ v
;
ÎÎv w
public
ÑÑ 
static
ÑÑ 
string
ÑÑ ,
BOCW_GetApplicationDetailsList
ÑÑ ;
=
ÑÑ< =
$str
ÑÑ> ^
;
ÑÑ^ _
public
ÒÒ 
static
ÒÒ 
string
ÒÒ ,
GLWB_GetApplicationDetailsList
ÒÒ ;
=
ÒÒ< =
$str
ÒÒ> ^
;
ÒÒ^ _
public
ÓÓ 
static
ÓÓ 
string
ÓÓ 5
'GLWB_Hospital_GetApplicationDetailsList
ÓÓ D
=
ÓÓE F
$str
ÓÓG k
;
ÓÓk l
public
ÔÔ 
static
ÔÔ 
string
ÔÔ 1
#GLWBHospitalApplicationDetailsClaim
ÔÔ @
=
ÔÔA B
$str
ÔÔC m
;
ÔÔm n
public
ÕÕ 
static
ÕÕ 
string
ÕÕ ,
GetUploadedDocumentForEmployee
ÕÕ ;
=
ÕÕ< =
$str
ÕÕ> _
;
ÕÕ_ `
public
ÖÖ 
static
ÖÖ 
string
ÖÖ 4
&GetGlwb_TsyUploadedDocumentForEmployee
ÖÖ C
=
ÖÖD E
$str
ÖÖF o
;
ÖÖo p
public
×× 
static
×× 
string
×× (
AddMultipleApprovalDetails
×× 7
=
××8 9
$str
××: V
;
××V W
public
ØØ 
static
ØØ 
string
ØØ 8
*bocw_tbsy_claim_addmultipleapprovaldetails
ØØ G
=
ØØH I
$str
ØØJ v
;
ØØv w
public
ÙÙ 
static
ÙÙ 
string
ÙÙ 1
#GLWB_HTY_AddMultipleApprovalDetails
ÙÙ @
=
ÙÙA B
$str
ÙÙC h
;
ÙÙh i
public
ÜÜ 
static
ÜÜ 
string
ÜÜ *
GLWB_HLS_Insertschemedetails
ÜÜ 9
=
ÜÜ: ;
$str
ÜÜ< Z
;
ÜÜZ [
public
İİ 
static
İİ 
string
İİ '
GLWB_HLS_Getschemedetails
İİ 6
=
İİ7 8
$str
İİ9 T
;
İİT U
public
ŞŞ 
static
ŞŞ 
string
ŞŞ -
getrpt_glwb_hls_personaldetails
ŞŞ <
=
ŞŞ= >
$str
ŞŞ? `
;
ŞŞ` a
public
ßß 
static
ßß 
string
ßß +
getrpt_glwb_hls_schemedetails
ßß :
=
ßß; <
$str
ßß= \
;
ßß\ ]
public
åå 
static
åå 
string
åå 8
*GLWBHSS_GetApplicationSchemeDetailsByAppId
åå G
=
ååH I
$str
ååJ v
;
ååv w
public
ææ 
static
ææ 
string
ææ 6
(GetReportGLWB_Hss_PersonalDetailsByAppId
ææ E
=
ææF G
$str
ææH i
;
ææi j
public
çç 
static
çç 
string
çç +
getrpt_glwb_hss_schemedetails
çç :
=
çç; <
$str
çç= \
;
çç\ ]
public
êê 
static
êê 
string
êê .
 RPTBOCWGETApplicationDetailsList
êê =
=
êê> ?
$str
êê@ b
;
êêb c
public
ëë 
static
ëë 
string
ëë 6
(GetRPTBOCWApplicationDetailsListGLWB_TSY
ëë E
=
ëëF G
$str
ëëH r
;
ëër s
public
ìì 
static
ìì 
string
ìì ,
GetRPTDistrictWisePendencyData
ìì ;
=
ìì< =
$str
ìì> [
;
ìì[ \
public
íí 
static
íí 
string
íí (
RPTBOCWGETPendencyDaysList
íí 7
=
íí8 9
$str
íí: R
;
ííR S
public
ğğ 
static
ğğ 
string
ğğ )
GetApplicationSchemeDetails
ğğ 8
=
ğğ9 :
$str
ğğ; X
;
ğğX Y
public
óó 
static
óó 
string
óó 8
*GLWBLSY_GetApplicationSchemeDetailsByAppId
óó G
=
óóH I
$str
óóJ v
;
óóv w
public
ôô 
static
ôô 
string
ôô 6
(GetReportGLWB_Lsy_PersonalDetailsByAppId
ôô E
=
ôôF G
$str
ôôH i
;
ôôi j
public
õõ 
static
õõ 
string
õõ +
getrpt_glwb_lsy_schemedetails
õõ :
=
õõ; <
$str
õõ= \
;
õõ\ ]
public
øø 
static
øø 
string
øø 6
(GetReportGLWB_Tsy_PersonalDetailsByAppId
øø E
=
øøF G
$str
øøH i
;
øøi j
public
üü 
static
üü 
string
üü <
.GetReportGLWB_Tsy_Claim_PersonalDetailsByAppId
üü K
=
üüL M
$str
üüN u
;
üüu v
public
ıı 
static
ıı 
string
ıı 0
"getrptglwb_tsy_claim_schemedetails
ıı ?
=
ıı@ A
$str
ııB g
;
ııg h
public
şş 
static
şş 
string
şş 7
)getrptglwb_tsy_claim_companyWorkerDetails
şş F
=
şşG H
$str
şşI u
;
şşu v
public
ÿÿ 
static
ÿÿ 
string
ÿÿ /
!getrpt_glwb_tsy_claim_getagecount
ÿÿ >
=
ÿÿ? @
$str
ÿÿA d
;
ÿÿd e
public
 
static
 
string
 +
getrptbocw_hssy_schemedetails
 :
=
; <
$str
= ]
;
] ^
public
 
static
 
string
 .
 getrpt_bocw_nanaji_schemedetails
 =
=
> ?
$str
@ b
;
b c
public
 
static
 
string
 2
$getrpt_bocw_hssy_familyschemedetails
 A
=
B C
$str
D j
;
j k
public
 
static
 
string
 :
,getrpt_bocw_hssy_childrenfamilyschemedetails
 I
=
J K
$str
L z
;
z {
public
 
static
 
string
 :
,getrpt_bocw_hssy_childrenhostelschemedetails
 I
=
J K
$str
L z
;
z {
public
 
static
 
string
 B
4getrpt_bocw_nanaji_Familymembersdetailsschemedetails
 Q
=
R S
$strT 
; 
public
 
static
 
string
 3
%getrpt_glwb_hty_Familyssschemedetails
 B
=
C D
$str
E l
;
l m
public
 
static
 
string
 9
+getrpt_glwb_hty_claim_Familyssschemedetails
 H
=
I J
$str
K x
;
x y
public
 
static
 
string
 +
GetRegisteredApplicantDetails
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 &
ViewApplicationStatusNew
 5
=
6 7
$str
8 R
;
R S
public
 
static
 
string
 )
GetRoleForApplicationStatus
 8
=
9 :
$str
; X
;
X Y
public
 
static
 
string
 (
GetTotalApplicationDetails
 7
=
8 9
$str
: V
;
V W
public
 
static
 
string
 -
GetServiceMasterByBeneficiaryId
 <
=
= >
$str
? R
;
R S
public
 
static
 
string
 3
%GetServiceMasterByBeneficiaryIdforCMD
 B
=
C D
$str
E ^
;
^ _
public
 
static
 
string
 $
CheckENirmanCardExpiry
 3
=
4 5
$str
6 N
;
N O
public
 
static
 
string
 (
UpdateeNirmanCardxpiryDate
 7
=
8 9
$str
: W
;
W X
public
 
static
 
string
 +
ViewApplicationEmployeeSearch
 :
=
; <
$str
= \
;
\ ]
public
 
static
 
string
 4
&GetRoleForApplicationStatusForEmployee
 C
=
D E
$str
F n
;
n o
public
 
static
 
string
 6
(getaadharcardcountbyaadharnoandserviceid
 E
=
F G
$str
H r
;
r s
public
 
static
 
string
 3
%BOCWGetCompletedApplicationForPayment
 B
=
C D
$str
E m
;
m n
public
 
static
 
string
 /
!GetAppDetailsByAppIdForViewAadesh
 >
=
? @
$str
A d
;
d e
public
 
static
 
string
 #
BOCWViewAadeshDetails
 2
=
3 4
$str
5 M
;
M N
public
 
static
 
string
 (
GetAadeshDetailsbyAadeshid
 7
=
8 9
$str
: V
;
V W
public
 
static
 
string
  
BOCWSendForPayment
 /
=
0 1
$str
2 F
;
F G
public
 
static
 
string
 )
BOCWGetAadeshDataForRoutine
 8
=
9 :
$str
; X
;
X Y
public
 
static
 
string
 #
UpdateBOCWPaymentInfo
 2
=
3 4
$str
5 L
;
L M
public
 
static
 
string
 3
%GetAppDetailsByAppIdForGLWBViewAadesh
 B
=
C D
$str
E l
;
l m
public
   
static
   
string
   #
GLWBViewAadeshDetails
   2
=
  3 4
$str
  5 M
;
  M N
public
¡¡ 
static
¡¡ 
string
¡¡ (
Glwb_Tsy_ViewAadeshDetails
¡¡ 7
=
¡¡8 9
$str
¡¡: V
;
¡¡V W
public
¢¢ 
static
¢¢ 
string
¢¢ ,
GetGLWBAadeshDetailsbyAadeshid
¢¢ ;
=
¢¢< =
$str
¢¢> ^
;
¢¢^ _
public
££ 
static
££ 
string
££ /
!GetGlwbTSYAadeshDetailsbyAadeshid
££ >
=
££? @
$str
££A d
;
££d e
public
¥¥ 
static
¥¥ 
string
¥¥ 4
&BOCWGetAadeshDataForFetchReturnCSVFile
¥¥ C
=
¥¥D E
$str
¥¥F i
;
¥¥i j
public
¦¦ 
static
¦¦ 
string
¦¦ %
SaveBOCWPaymentResponse
¦¦ 4
=
¦¦5 6
$str
¦¦7 P
;
¦¦P Q
public
§§ 
static
§§ 
string
§§ #
GetBOCWPaymentHistory
§§ 2
=
§§3 4
$str
§§5 L
;
§§L M
public
¨¨ 
static
¨¨ 
string
¨¨  
GLWBSendForPayment
¨¨ /
=
¨¨0 1
$str
¨¨2 F
;
¨¨F G
public
ªª 
static
ªª 
string
ªª )
GLWBGetAadeshDataForRoutine
ªª 8
=
ªª9 :
$str
ªª; X
;
ªªX Y
public
«« 
static
«« 
string
«« #
UpdateGLWBPaymentInfo
«« 2
=
««3 4
$str
««5 L
;
««L M
public
¬¬ 
static
¬¬ 
string
¬¬ 4
&GLWBGetAadeshDataForFetchReturnCSVFile
¬¬ C
=
¬¬D E
$str
¬¬F i
;
¬¬i j
public
­­ 
static
­­ 
string
­­ #
GetGLWBPaymentHistory
­­ 2
=
­­3 4
$str
­­5 L
;
­­L M
public
®® 
static
®® 
string
®® ,
BOCWSendForPaymentFailedRecord
®® ;
=
®®< =
$str
®®> ^
;
®®^ _
public
¯¯ 
static
¯¯ 
string
¯¯ ,
GLWBSendForPaymentFailedRecord
¯¯ ;
=
¯¯< =
$str
¯¯> ^
;
¯¯^ _
public
°° 
static
°° 
string
°° %
GetCCApplicationDetails
°° 4
=
°°5 6
$str
°°7 _
;
°°_ `
public
±± 
static
±± 
string
±± )
GetCCCompletedAppForPayment
±± 8
=
±±9 :
$str
±±; g
;
±±g h
public
²² 
static
²² 
string
²² ,
GetCCApplicationDetailsByAppId
²² ;
=
²²< =
$str
²²> m
;
²²m n
public
³³ 
static
³³ 
string
³³ *
InsertPaymentTransactionInfo
³³ 9
=
³³: ;
$str
³³< i
;
³³i j
public
´´ 
static
´´ 
string
´´ -
CheckTransactionTokenExistorNot
´´ <
=
´´= >
$str
´´? o
;
´´o p
public
µµ 
static
µµ 
string
µµ *
UpdatePaymentTransactionInfo
µµ 9
=
µµ: ;
$str
µµ< i
;
µµi j
public
¶¶ 
static
¶¶ 
string
¶¶ &
GetDataForCTPMakePayment
¶¶ 5
=
¶¶6 7
$str
¶¶8 a
;
¶¶a b
public
¸¸ 
static
¸¸ 
string
¸¸ 
GetYear
¸¸ $
=
¸¸% &
$str
¸¸' 8
;
¸¸8 9
public
¹¹ 
static
¹¹ 
string
¹¹ 
GetMonth
¹¹ %
=
¹¹& '
$str
¹¹( 9
;
¹¹9 :
public
ºº 
static
ºº 
string
ºº *
GetCMDApplicationDetailslist
ºº 9
=
ºº: ;
$str
ºº< f
;
ººf g
public
»» 
static
»» 
string
»» /
!GetCMDApplicationDetailsForInsert
»» >
=
»»? @
$str
»»A p
;
»»p q
public
¼¼ 
static
¼¼ 
string
¼¼ *
GetBOCWCMDApplicationDetails
¼¼ 9
=
¼¼: ;
$str
¼¼< f
;
¼¼f g
}
¾¾ 
}¿¿ Â×
SD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\Utility\CommonUtils.cs
	namespace 	
LabourCommissioner
 
. 
Common #
.# $
Utility$ +
{ 
public 

class 
CommonUtils 
{ 
private 
readonly 
IConfiguration '
	appConfig( 1
;1 2
private 
readonly 
IHttpClientFactory +
_clientFactory, :
;: ;
private   
readonly   
string   
_couchDbUrl    +
;  + ,
private!! 
readonly!! 
string!! 
_couchDbName!!  ,
;!!, -
private"" 
readonly"" 
string"" 
_couchDbUser""  ,
;"", -
private$$ 
readonly$$ 
string$$ $
_sMTPConfigSenderAddress$$  8
;$$8 9
private%% 
readonly%% 
string%% (
_sMTPConfigSenderDisplayName%%  <
;%%< =
private&& 
readonly&& 
string&& 
_sMTPConfigUserName&&  3
;&&3 4
private'' 
readonly'' 
string'' 
_sMTPConfigPassword''  3
;''3 4
private(( 
readonly(( 
string(( 
_sMTPConfigHost((  /
;((/ 0
private)) 
readonly)) 
int)) 
_sMTPConfigPort)) ,
;)), -
private** 
readonly** 
bool**  
_sMTPConfigEnableSSL** 2
;**2 3
private++ 
readonly++ 
string++ ,
 _sMTPConfigUseDefaultCredentials++  @
;++@ A
private,, 
readonly,, 
string,, !
_sMTPConfigIsBodyHTML,,  5
;,,5 6
private-- 
static-- 
string--  
_otherKeyValueEncKey-- 2
;--2 3
private.. 
readonly.. 
string.. 
_isSMSRequired..  .
;... /
private// 
readonly// 
string// 
_messageUrl//  +
;//+ ,
private00 
readonly00 
string00 
_messageUserName00  0
;000 1
private11 
readonly11 
string11 
_messagePassword11  0
;110 1
private22 
readonly22 
string22 
_messageSenderId22  0
;220 1
private33 
readonly33 
string33 

_secureKey33  *
;33* +
private44 
readonly44 
string44 
_emailforexception44  2
;442 3
private55 
readonly55 
string55  
_bocwRegistrationAPI55  4
;554 5
private66 
readonly66 
string66 
_bocwAuthHeader66  /
;66/ 0
private88 
readonly88 
string88 &
_sftpDestinationUploadPath88  :
;88: ;
private99 
readonly99 
string99 $
_sftpDestinationReadPath99  8
;998 9
private:: 
readonly:: 
string:: 
	_sftpHost::  )
;::) *
private;; 
readonly;; 
int;; 
	_sftpPort;; &
;;;& '
private<< 
readonly<< 
string<< 
_sftpUserName<<  -
;<<- .
private== 
readonly== 
string== 
_sftpPassword==  -
;==- .
private>> 
readonly>> 
string>> 
_BOCWResponsePath>>  1
;>>1 2
private?? 
readonly?? 
string?? 
_BOCWCorporateId??  0
;??0 1
privateAA 
readonlyAA 
stringAA 
_GLWBResponsePathAA  1
;AA1 2
privateBB 
readonlyBB 
stringBB 
_GLWBCorporateIdBB  0
;BB0 1
publicFF 
CommonUtilsFF 
(FF 
IConfigurationFF )
configFF* 0
)FF0 1
{GG 	
	appConfigHH 
=HH 
configHH 
??HH !
throwHH" '
newHH( +!
ArgumentNullExceptionHH, A
(HHA B
nameofHHB H
(HHH I
configHHI O
)HHO P
)HHP Q
;HHQ R
_couchDbUrlII 
=II 
	appConfigII #
[II# $
$strII$ 1
]II1 2
;II2 3
_couchDbNameJJ 
=JJ 
	appConfigJJ $
[JJ$ %
$strJJ% 5
]JJ5 6
;JJ6 7
_couchDbUserKK 
=KK 
	appConfigKK $
[KK$ %
$strKK% 3
]KK3 4
;KK4 5$
_sMTPConfigSenderAddressMM $
=MM% &
	appConfigMM' 0
[MM0 1
$strMM1 L
]MML M
;MMM N(
_sMTPConfigSenderDisplayNameNN (
=NN) *
	appConfigNN+ 4
[NN4 5
$strNN5 T
]NNT U
;NNU V
_sMTPConfigUserNameOO 
=OO  !
	appConfigOO" +
[OO+ ,
$strOO, B
]OOB C
;OOC D
_sMTPConfigPasswordPP 
=PP  !
	appConfigPP" +
[PP+ ,
$strPP, B
]PPB C
;PPC D
_sMTPConfigHostQQ 
=QQ 
	appConfigQQ '
[QQ' (
$strQQ( :
]QQ: ;
;QQ; <
_sMTPConfigPortRR 
=RR 
ConvertRR %
.RR% &
ToInt32RR& -
(RR- .
	appConfigRR. 7
[RR7 8
$strRR8 J
]RRJ K
)RRK L
;RRL M 
_sMTPConfigEnableSSLSS  
=SS! "
ConvertSS# *
.SS* +
	ToBooleanSS+ 4
(SS4 5
	appConfigSS5 >
[SS> ?
$strSS? V
]SSV W
)SSW X
;SSX Y,
 _sMTPConfigUseDefaultCredentialsTT ,
=TT- .
	appConfigTT/ 8
[TT8 9
$strTT9 \
]TT\ ]
;TT] ^!
_sMTPConfigIsBodyHTMLUU !
=UU" #
	appConfigUU$ -
[UU- .
$strUU. F
]UUF G
;UUG H 
_otherKeyValueEncKeyVV  
=VV! "
	appConfigVV# ,
[VV, -
$strVV- C
]VVC D
;VVD E
_isSMSRequiredWW 
=WW 
	appConfigWW &
[WW& '
$strWW' @
]WW@ A
;WWA B
_messageUrlXX 
=XX 
	appConfigXX #
[XX# $
$strXX$ :
]XX: ;
;XX; <
_messageUserNameYY 
=YY 
	appConfigYY (
[YY( )
$strYY) D
]YYD E
;YYE F
_messagePasswordZZ 
=ZZ 
	appConfigZZ (
[ZZ( )
$strZZ) D
]ZZD E
;ZZE F
_messageSenderId[[ 
=[[ 
	appConfig[[ (
[[[( )
$str[[) D
][[D E
;[[E F

_secureKey\\ 
=\\ 
	appConfig\\ "
[\\" #
$str\\# 8
]\\8 9
;\\9 :
_emailforexception^^ 
=^^  
	appConfig^^! *
[^^* +
$str^^+ J
]^^J K
;^^K L 
_bocwRegistrationAPI__  
=__! "
	appConfig__# ,
[__, -
$str__- C
]__C D
;__D E
_bocwAuthHeader`` 
=`` 
	appConfig`` '
[``' (
$str``( H
]``H I
;``I J&
_sftpDestinationUploadPathbb &
=bb' (
	appConfigbb) 2
[bb2 3
$strbb3 R
]bbR S
;bbS T$
_sftpDestinationReadPathcc $
=cc% &
	appConfigcc' 0
[cc0 1
$strcc1 N
]ccN O
;ccO P
	_sftpHostdd 
=dd 
	appConfigdd !
[dd! "
$strdd" 0
]dd0 1
;dd1 2
	_sftpPortee 
=ee 
Convertee 
.ee  
ToInt32ee  '
(ee' (
	appConfigee( 1
[ee1 2
$stree2 @
]ee@ A
)eeA B
;eeB C
_sftpUserNameff 
=ff 
	appConfigff %
[ff% &
$strff& 8
]ff8 9
;ff9 :
_sftpPasswordgg 
=gg 
	appConfiggg %
[gg% &
$strgg& 8
]gg8 9
;gg9 :
_BOCWResponsePathhh 
=hh 
	appConfighh  )
[hh) *
$strhh* D
]hhD E
;hhE F
_BOCWCorporateIdii 
=ii 
	appConfigii (
[ii( )
$strii) B
]iiB C
;iiC D
_GLWBResponsePathjj 
=jj 
	appConfigjj  )
[jj) *
$strjj* D
]jjD E
;jjE F
_GLWBCorporateIdkk 
=kk 
	appConfigkk (
[kk( )
$strkk) B
]kkB C
;kkC D
}mm 	
publicnn 
CommonUtilsnn 
(nn 
IConfigurationnn )
confignn* 0
,nn0 1
IHttpClientFactorynn2 D
clientFactorynnE R
)nnR S
{oo 	
	appConfigpp 
=pp 
configpp 
??pp !
throwpp" '
newpp( +!
ArgumentNullExceptionpp, A
(ppA B
nameofppB H
(ppH I
configppI O
)ppO P
)ppP Q
;ppQ R
_clientFactoryqq 
=qq 
clientFactoryqq *
;qq* +
_couchDbUrlrr 
=rr 
	appConfigrr #
[rr# $
$strrr$ 1
]rr1 2
;rr2 3
_couchDbNamess 
=ss 
	appConfigss $
[ss$ %
$strss% 5
]ss5 6
;ss6 7
_couchDbUsertt 
=tt 
	appConfigtt $
[tt$ %
$strtt% 3
]tt3 4
;tt4 5
}vv 	
publicyy 
boolyy 
SendPasswordMailyy $
(yy$ %
stringyy% +
DisplayNameyy, 7
,yy7 8
stringyy9 ?
emailAddressyy@ L
,yyL M
stringyyN T
OTP_CodeyyU ]
,yy] ^
stringyy_ e
UserNameyyf n
,yyn o
stringyyp v
Passwordyyw 
,	yy 
int
yy 
UserType
yy 
,
yy 
string
yy 
	ImagePath
yy 
,
yy  
string
yy¡ §
URL
yy¨ «
,
yy« ¬
string
yy­ ³
beneficiarytype
yy´ Ã
)
yyÃ Ä
{zz 	
string{{ 
strMailBody{{ 
={{  
$str{{! #
;{{# $
string
 
path
 
=
 
string
  
.
  !
Empty
! &
;
& '
if
 
(
 
UserType
 
==
 
$num
 
)
 
{
 
if
 
(
 
OperatingSystem
 #
.
# $
	IsWindows
$ -
(
- .
)
. /
)
/ 0
path
 
=
 
Path
 
.
  
Combine
  '
(
' (
	ImagePath
( 1
+
2 3
$str
4 [
)
[ \
;
\ ]
else
 
if
 
(
 
OperatingSystem
 (
.
( )
IsLinux
) 0
(
0 1
)
1 2
)
2 3
path
 
=
 
Path
 
.
  
Combine
  '
(
' (
	ImagePath
( 1
+
2 3
$str
4 [
)
[ \
;
\ ]
else
 
{
 
path
 
=
 
$str
 
;
 
}
 
}
 
else
 
{
 
if
 
(
 
OperatingSystem
 #
.
# $
	IsWindows
$ -
(
- .
)
. /
)
/ 0
path
 
=
 
Path
 
.
  
Combine
  '
(
' (
	ImagePath
( 1
+
2 3
$str
4 [
)
[ \
;
\ ]
else
 
if
 
(
 
OperatingSystem
 (
.
( )
IsLinux
) 0
(
0 1
)
1 2
)
2 3
path
 
=
 
Path
 
.
  
Combine
  '
(
' (
	ImagePath
( 1
+
2 3
$str
4 [
)
[ \
;
\ ]
else
 
{
 
path
 
=
 
$str
 
;
 
}
 
}
 
StreamReader
 
IDDSbody
 !
=
" #
new
$ '
StreamReader
( 4
(
4 5
path
5 9
)
9 :
;
: ;
string
 
beneficiaryname
 "
=
# $
$str
% '
;
' (
if
 
(
 
beneficiarytype
 
==
  "
$str
# &
)
& '
{
 
beneficiaryname
   
=
    !
$str
  " X
;
  X Y
}
¡¡ 
else
¢¢ 
{
££ 
beneficiaryname
¤¤ 
=
¤¤  !
$str
¤¤" @
;
¤¤@ A
}
¥¥ 
strMailBody
ªª 
=
ªª 
IDDSbody
ªª "
.
ªª" #
	ReadToEnd
ªª# ,
(
ªª, -
)
ªª- .
;
ªª. /
strMailBody
«« 
=
«« 
strMailBody
«« %
.
««% &
Replace
««& -
(
««- .
$str
««. 6
,
««6 7
DisplayName
««8 C
)
««C D
;
««D E
strMailBody
¬¬ 
=
¬¬ 
strMailBody
¬¬ %
.
¬¬% &
Replace
¬¬& -
(
¬¬- .
$str
¬¬. 9
,
¬¬9 :
OTP_Code
¬¬; C
)
¬¬C D
;
¬¬D E
strMailBody
­­ 
=
­­ 
strMailBody
­­ %
.
­­% &
Replace
­­& -
(
­­- .
$str
­­. A
,
­­A B
beneficiaryname
­­C R
)
­­R S
;
­­S T
strMailBody
®® 
=
®® 
strMailBody
®® %
.
®®% &
Replace
®®& -
(
®®- .
$str
®®. 5
,
®®5 6
URL
®®7 :
)
®®: ;
;
®®; <
strMailBody
¯¯ 
=
¯¯ 
strMailBody
¯¯ %
.
¯¯% &
Replace
¯¯& -
(
¯¯- .
$str
¯¯. :
,
¯¯: ;
UserName
¯¯< D
)
¯¯D E
;
¯¯E F
strMailBody
°° 
=
°° 
strMailBody
°° %
.
°°% &
Replace
°°& -
(
°°- .
$str
°°. :
,
°°: ;
Password
°°< D
)
°°D E
;
°°E F
strMailBody
±± 
=
±± 
strMailBody
±± %
.
±±% &
Replace
±±& -
(
±±- .
$str
±±. ;
,
±±; <
	ImagePath
±±= F
)
±±F G
;
±±G H
bool
³³ 
Chk
³³ 
=
³³ 
SendMail
³³ 
(
³³  &
_sMTPConfigSenderAddress
³³  8
,
³³8 9*
_sMTPConfigSenderDisplayName
³³: V
,
³³V W
emailAddress
³³X d
,
³³d e&
_sMTPConfigSenderAddress
³³f ~
,
³³~ 
strMailBody³³ 
,³³ 
$str³³ ¥
,³³¥ ¦
$str³³§ ©
,³³© ª
$str³³« ­
,
´´ 
true
´´ 
,
´´ 
$str
´´ 
,
´´ !
_sMTPConfigUserName
´´ /
,
´´/ 0!
_sMTPConfigPassword
´´1 D
,
´´D E
_sMTPConfigHost
´´F U
,
´´U V
_sMTPConfigPort
´´W f
,
´´f g"
_sMTPConfigEnableSSL
´´h |
)
´´| }
;
´´} ~
return
¶¶ 
Chk
¶¶ 
;
¶¶ 
}
·· 	
public
¹¹ 
bool
¹¹ '
SendCitizenRegisteredMail
¹¹ -
(
¹¹- .
string
¹¹. 4
DisplayName
¹¹5 @
,
¹¹@ A
string
¹¹B H
emailAddress
¹¹I U
,
¹¹U V
string
¹¹W ]
UserId
¹¹^ d
,
¹¹d e
string
¹¹f l
Password
¹¹m u
,
¹¹u v
string
¹¹w }
	emailLogo¹¹~ 
,¹¹ 
string¹¹ 
RootPath¹¹ 
,¹¹ 
string¹¹  
TemplateName¹¹¡ ­
,¹¹­ ®
int¹¹¯ ²
?¹¹² ³
beneficiarytype¹¹´ Ã
)¹¹Ã Ä
{
ºº 	
string
»» 
strMailBody
»» 
=
»»  
$str
»»! #
;
»»# $
string
¿¿ 
path
¿¿ 
=
¿¿ 
string
¿¿  
.
¿¿  !
Empty
¿¿! &
;
¿¿& '
if
ÀÀ 
(
ÀÀ 
OperatingSystem
ÀÀ 
.
ÀÀ  
	IsWindows
ÀÀ  )
(
ÀÀ) *
)
ÀÀ* +
)
ÀÀ+ ,
path
ÁÁ 
=
ÁÁ 
Path
ÁÁ 
.
ÁÁ 
Combine
ÁÁ #
(
ÁÁ# $
RootPath
ÁÁ$ ,
+
ÁÁ- .
$str
ÁÁ/ A
+
ÁÁB C
TemplateName
ÁÁD P
)
ÁÁP Q
;
ÁÁQ R
else
ÂÂ 
if
ÂÂ 
(
ÂÂ 
OperatingSystem
ÂÂ $
.
ÂÂ$ %
IsLinux
ÂÂ% ,
(
ÂÂ, -
)
ÂÂ- .
)
ÂÂ. /
path
ÃÃ 
=
ÃÃ 
Path
ÃÃ 
.
ÃÃ 
Combine
ÃÃ #
(
ÃÃ# $
RootPath
ÃÃ$ ,
+
ÃÃ- .
$str
ÃÃ/ A
+
ÃÃB C
TemplateName
ÃÃD P
)
ÃÃP Q
;
ÃÃQ R
else
ÄÄ 
{
ÅÅ 
path
ÆÆ 
=
ÆÆ 
$str
ÆÆ 
;
ÆÆ 
}
ÇÇ 
StreamReader
ÊÊ 
IDDSbody
ÊÊ !
=
ÊÊ" #
new
ÊÊ$ '
StreamReader
ÊÊ( 4
(
ÊÊ4 5
path
ÊÊ5 9
)
ÊÊ9 :
;
ÊÊ: ;
string
ËË 
beneficiaryname
ËË "
=
ËË# $
$str
ËË% '
;
ËË' (
if
ÌÌ 
(
ÌÌ 
beneficiarytype
ÌÌ 
==
ÌÌ  "
$num
ÌÌ# $
)
ÌÌ$ %
{
ÍÍ 
beneficiaryname
ÎÎ 
=
ÎÎ  !
$str
ÎÎ" X
;
ÎÎX Y
}
ÏÏ 
else
ĞĞ 
{
ÑÑ 
beneficiaryname
ÒÒ 
=
ÒÒ  !
$str
ÒÒ" @
;
ÒÒ@ A
}
ÓÓ 
strMailBody
ÖÖ 
=
ÖÖ 
IDDSbody
ÖÖ "
.
ÖÖ" #
	ReadToEnd
ÖÖ# ,
(
ÖÖ, -
)
ÖÖ- .
;
ÖÖ. /
strMailBody
×× 
=
×× 
strMailBody
×× %
.
××% &
Replace
××& -
(
××- .
$str
××. ;
,
××; <
	emailLogo
××= F
)
××F G
;
××G H
strMailBody
ØØ 
=
ØØ 
strMailBody
ØØ %
.
ØØ% &
Replace
ØØ& -
(
ØØ- .
$str
ØØ. A
,
ØØA B
beneficiaryname
ØØC R
)
ØØR S
;
ØØS T
strMailBody
ÙÙ 
=
ÙÙ 
strMailBody
ÙÙ %
.
ÙÙ% &
Replace
ÙÙ& -
(
ÙÙ- .
$str
ÙÙ. 6
,
ÙÙ6 7
DisplayName
ÙÙ8 C
)
ÙÙC D
;
ÙÙD E
strMailBody
ÚÚ 
=
ÚÚ 
strMailBody
ÚÚ %
.
ÚÚ% &
Replace
ÚÚ& -
(
ÚÚ- .
$str
ÚÚ. 8
,
ÚÚ8 9
UserId
ÚÚ: @
)
ÚÚ@ A
;
ÚÚA B
strMailBody
ÛÛ 
=
ÛÛ 
strMailBody
ÛÛ %
.
ÛÛ% &
Replace
ÛÛ& -
(
ÛÛ- .
$str
ÛÛ. :
,
ÛÛ: ;
Password
ÛÛ< D
)
ÛÛD E
;
ÛÛE F
bool
İİ 
Chk
İİ 
=
İİ 
SendMail
İİ 
(
İİ  &
_sMTPConfigSenderAddress
İİ  8
,
İİ8 9*
_sMTPConfigSenderDisplayName
İİ: V
,
İİV W
emailAddress
İİX d
,
İİd e&
_sMTPConfigSenderAddress
İİf ~
,
İİ~ 
strMailBodyİİ 
,İİ 
$strİİ ¡
,İİ¡ ¢
$strİİ£ ¥
,İİ¥ ¦
$strİİ§ ©
,
ŞŞ 
true
ŞŞ 
,
ŞŞ 
$str
ŞŞ 
,
ŞŞ !
_sMTPConfigUserName
ŞŞ /
,
ŞŞ/ 0!
_sMTPConfigPassword
ŞŞ1 D
,
ŞŞD E
_sMTPConfigHost
ŞŞF U
,
ŞŞU V
_sMTPConfigPort
ŞŞW f
,
ŞŞf g"
_sMTPConfigEnableSSL
ŞŞh |
)
ŞŞ| }
;
ŞŞ} ~
return
àà 
Chk
àà 
;
àà 
}
áá 	
public
ââ 
bool
ââ "
SendCCRegisteredMail
ââ (
(
ââ( )
string
ââ) /
DisplayName
ââ0 ;
,
ââ; <
string
ââ= C
emailAddress
ââD P
,
ââP Q
string
ââR X
UserId
ââY _
,
ââ_ `
string
ââa g
Password
ââh p
,
ââp q
string
ââr x
	emailLogoâây 
,ââ 
stringââ 
RootPathââ 
,ââ 
stringââ 
TemplateNameââ ¨
,ââ¨ ©
intââª ­
?ââ­ ®
beneficiarytypeââ¯ ¾
)ââ¾ ¿
{
ãã 	
string
ää 
strMailBody
ää 
=
ää  
$str
ää! #
;
ää# $
string
èè 
path
èè 
=
èè 
string
èè  
.
èè  !
Empty
èè! &
;
èè& '
if
éé 
(
éé 
OperatingSystem
éé 
.
éé  
	IsWindows
éé  )
(
éé) *
)
éé* +
)
éé+ ,
path
êê 
=
êê 
Path
êê 
.
êê 
Combine
êê #
(
êê# $
RootPath
êê$ ,
+
êê- .
$str
êê/ A
+
êêB C
TemplateName
êêD P
)
êêP Q
;
êêQ R
else
ëë 
if
ëë 
(
ëë 
OperatingSystem
ëë $
.
ëë$ %
IsLinux
ëë% ,
(
ëë, -
)
ëë- .
)
ëë. /
path
ìì 
=
ìì 
Path
ìì 
.
ìì 
Combine
ìì #
(
ìì# $
RootPath
ìì$ ,
+
ìì- .
$str
ìì/ A
+
ììB C
TemplateName
ììD P
)
ììP Q
;
ììQ R
else
íí 
{
îî 
path
ïï 
=
ïï 
$str
ïï 
;
ïï 
}
ğğ 
StreamReader
óó 
IDDSbody
óó !
=
óó" #
new
óó$ '
StreamReader
óó( 4
(
óó4 5
path
óó5 9
)
óó9 :
;
óó: ;
string
ôô 
beneficiaryname
ôô "
=
ôô# $
$str
ôô% '
;
ôô' (
if
õõ 
(
õõ 
beneficiarytype
õõ 
==
õõ  "
$num
õõ# $
)
õõ$ %
{
öö 
beneficiaryname
÷÷ 
=
÷÷  !
$str
÷÷" X
;
÷÷X Y
}
øø 
else
ùù 
{
úú 
beneficiaryname
ûû 
=
ûû  !
$str
ûû" @
;
ûû@ A
}
üü 
strMailBody
ÿÿ 
=
ÿÿ 
IDDSbody
ÿÿ "
.
ÿÿ" #
	ReadToEnd
ÿÿ# ,
(
ÿÿ, -
)
ÿÿ- .
;
ÿÿ. /
strMailBody
 
=
 
strMailBody
 %
.
% &
Replace
& -
(
- .
$str
. ;
,
; <
	emailLogo
= F
)
F G
;
G H
strMailBody
 
=
 
strMailBody
 %
.
% &
Replace
& -
(
- .
$str
. A
,
A B
beneficiaryname
C R
)
R S
;
S T
strMailBody
 
=
 
strMailBody
 %
.
% &
Replace
& -
(
- .
$str
. 6
,
6 7
DisplayName
8 C
)
C D
;
D E
strMailBody
 
=
 
strMailBody
 %
.
% &
Replace
& -
(
- .
$str
. 8
,
8 9
UserId
: @
)
@ A
;
A B
strMailBody
 
=
 
strMailBody
 %
.
% &
Replace
& -
(
- .
$str
. :
,
: ;
Password
< D
)
D E
;
E F
bool
 
Chk
 
=
 
SendMail
 
(
  &
_sMTPConfigSenderAddress
  8
,
8 9*
_sMTPConfigSenderDisplayName
: V
,
V W
emailAddress
X d
,
d e&
_sMTPConfigSenderAddress
f ~
,
~ 
strMailBody 
, 
$str ²
,² ³
$str´ ¶
,¶ ·
$str¸ º
,
 
true
 
,
 
$str
 
,
 !
_sMTPConfigUserName
 /
,
/ 0!
_sMTPConfigPassword
1 D
,
D E
_sMTPConfigHost
F U
,
U V
_sMTPConfigPort
W f
,
f g"
_sMTPConfigEnableSSL
h |
)
| }
;
} ~
return
 
Chk
 
;
 
}
 	
public
 
bool
 +
SendApplicationRegisteredMail
 1
(
1 2
string
2 8
DisplayName
9 D
,
D E
string
F L
emailAddress
M Y
,
Y Z
string
[ a
Message
b i
,
i j
string
k q
RootPath
r z
,
z {
string| 
TemplateName 
, 
string 
beneficiarytype §
)§ ¨
{
 	
string
 
strMailBody
 
=
  
$str
! #
;
# $
string
 
path
 
=
 
string
  
.
  !
Empty
! &
;
& '
if
 
(
 
OperatingSystem
 
.
  
	IsWindows
  )
(
) *
)
* +
)
+ ,
path
 
=
 
Path
 
.
 
Combine
 #
(
# $
RootPath
$ ,
+
- .
$str
/ A
+
B C
TemplateName
D P
)
P Q
;
Q R
else
 
if
 
(
 
OperatingSystem
 $
.
$ %
IsLinux
% ,
(
, -
)
- .
)
. /
path
 
=
 
Path
 
.
 
Combine
 #
(
# $
RootPath
$ ,
+
- .
$str
/ A
+
B C
TemplateName
D P
)
P Q
;
Q R
else
 
{
 
path
 
=
 
$str
 
;
 
}
 
string
 
beneficiaryname
 "
=
# $
$str
% '
;
' (
StreamReader
 
IDDSbody
 !
=
" #
new
$ '
StreamReader
( 4
(
4 5
path
5 9
)
9 :
;
: ;
if
 
(
 
beneficiarytype
 
==
  "
$str
# &
)
& '
{
 
beneficiaryname
   
=
    !
$str
  " X
;
  X Y
}
¡¡ 
else
¢¢ 
{
££ 
beneficiaryname
¤¤ 
=
¤¤  !
$str
¤¤" @
;
¤¤@ A
}
¥¥ 
strMailBody
ªª 
=
ªª 
IDDSbody
ªª "
.
ªª" #
	ReadToEnd
ªª# ,
(
ªª, -
)
ªª- .
;
ªª. /
strMailBody
«« 
=
«« 
strMailBody
«« %
.
««% &
Replace
««& -
(
««- .
$str
««. 6
,
««6 7
DisplayName
««8 C
)
««C D
;
««D E
strMailBody
¬¬ 
=
¬¬ 
strMailBody
¬¬ %
.
¬¬% &
Replace
¬¬& -
(
¬¬- .
$str
¬¬. A
,
¬¬A B
beneficiaryname
¬¬C R
)
¬¬R S
;
¬¬S T
strMailBody
­­ 
=
­­ 
strMailBody
­­ %
.
­­% &
Replace
­­& -
(
­­- .
$str
­­. 9
,
­­9 :
Message
­­; B
)
­­B C
;
­­C D
bool
¯¯ 
Chk
¯¯ 
=
¯¯ 
SendMail
¯¯ 
(
¯¯  &
_sMTPConfigSenderAddress
¯¯  8
,
¯¯8 9*
_sMTPConfigSenderDisplayName
¯¯: V
,
¯¯V W
emailAddress
¯¯X d
,
¯¯d e&
_sMTPConfigSenderAddress
¯¯f ~
,
¯¯~ 
strMailBody¯¯ 
,¯¯ 
$str¯¯ ¥
,¯¯¥ ¦
$str¯¯§ ©
,¯¯© ª
$str¯¯« ­
,
°° 
true
°° 
,
°° 
$str
°° 
,
°° !
_sMTPConfigUserName
°° /
,
°°/ 0!
_sMTPConfigPassword
°°1 D
,
°°D E
_sMTPConfigHost
°°F U
,
°°U V
_sMTPConfigPort
°°W f
,
°°f g"
_sMTPConfigEnableSSL
°°h |
)
°°| }
;
°°} ~
return
²² 
Chk
²² 
;
²² 
}
³³ 	
public
µµ 
bool
µµ $
SendARSApplicationMail
µµ *
(
µµ* +
string
µµ+ 1
DisplayName
µµ2 =
,
µµ= >
string
µµ? E
emailAddress
µµF R
,
µµR S
string
µµT Z
Message
µµ[ b
,
µµb c
string
µµd j
RootPath
µµk s
,
µµs t
string
µµu {
TemplateNameµµ| 
,µµ 
stringµµ 
	emailLogoµµ 
)µµ 
{
¶¶ 	
string
·· 
strMailBody
·· 
=
··  
$str
··! #
;
··# $
string
ºº 
path
ºº 
=
ºº 
string
ºº  
.
ºº  !
Empty
ºº! &
;
ºº& '
if
»» 
(
»» 
OperatingSystem
»» 
.
»»  
	IsWindows
»»  )
(
»») *
)
»»* +
)
»»+ ,
path
¼¼ 
=
¼¼ 
Path
¼¼ 
.
¼¼ 
Combine
¼¼ #
(
¼¼# $
RootPath
¼¼$ ,
+
¼¼- .
$str
¼¼/ A
+
¼¼B C
TemplateName
¼¼D P
)
¼¼P Q
;
¼¼Q R
else
½½ 
if
½½ 
(
½½ 
OperatingSystem
½½ $
.
½½$ %
IsLinux
½½% ,
(
½½, -
)
½½- .
)
½½. /
path
¾¾ 
=
¾¾ 
Path
¾¾ 
.
¾¾ 
Combine
¾¾ #
(
¾¾# $
RootPath
¾¾$ ,
+
¾¾- .
$str
¾¾/ A
+
¾¾B C
TemplateName
¾¾D P
)
¾¾P Q
;
¾¾Q R
else
¿¿ 
{
ÀÀ 
path
ÁÁ 
=
ÁÁ 
$str
ÁÁ 
;
ÁÁ 
}
ÂÂ 
StreamReader
ÄÄ 
IDDSbody
ÄÄ !
=
ÄÄ" #
new
ÄÄ$ '
StreamReader
ÄÄ( 4
(
ÄÄ4 5
path
ÄÄ5 9
)
ÄÄ9 :
;
ÄÄ: ;
strMailBody
ÈÈ 
=
ÈÈ 
IDDSbody
ÈÈ "
.
ÈÈ" #
	ReadToEnd
ÈÈ# ,
(
ÈÈ, -
)
ÈÈ- .
;
ÈÈ. /
strMailBody
ÉÉ 
=
ÉÉ 
strMailBody
ÉÉ %
.
ÉÉ% &
Replace
ÉÉ& -
(
ÉÉ- .
$str
ÉÉ. ;
,
ÉÉ; <
	emailLogo
ÉÉ= F
)
ÉÉF G
;
ÉÉG H
strMailBody
ÊÊ 
=
ÊÊ 
strMailBody
ÊÊ %
.
ÊÊ% &
Replace
ÊÊ& -
(
ÊÊ- .
$str
ÊÊ. 6
,
ÊÊ6 7
DisplayName
ÊÊ8 C
)
ÊÊC D
;
ÊÊD E
strMailBody
ËË 
=
ËË 
strMailBody
ËË %
.
ËË% &
Replace
ËË& -
(
ËË- .
$str
ËË. 9
,
ËË9 :
Message
ËË; B
)
ËËB C
;
ËËC D
bool
ÍÍ 
Chk
ÍÍ 
=
ÍÍ 
SendMail
ÍÍ 
(
ÍÍ  &
_sMTPConfigSenderAddress
ÍÍ  8
,
ÍÍ8 9*
_sMTPConfigSenderDisplayName
ÍÍ: V
,
ÍÍV W
emailAddress
ÍÍX d
,
ÍÍd e&
_sMTPConfigSenderAddress
ÍÍf ~
,
ÍÍ~ 
strMailBodyÍÍ 
,ÍÍ 
$strÍÍ ¡
,ÍÍ¡ ¢
$strÍÍ£ ¥
,ÍÍ¥ ¦
$strÍÍ§ ©
,
ÎÎ 
true
ÎÎ 
,
ÎÎ 
$str
ÎÎ 
,
ÎÎ !
_sMTPConfigUserName
ÎÎ /
,
ÎÎ/ 0!
_sMTPConfigPassword
ÎÎ1 D
,
ÎÎD E
_sMTPConfigHost
ÎÎF U
,
ÎÎU V
_sMTPConfigPort
ÎÎW f
,
ÎÎf g"
_sMTPConfigEnableSSL
ÎÎh |
)
ÎÎ| }
;
ÎÎ} ~
return
ĞĞ 
Chk
ĞĞ 
;
ĞĞ 
}
ÑÑ 	
public
ÓÓ 
static
ÓÓ 
bool
ÓÓ 
SendMail
ÓÓ #
(
ÓÓ# $
string
ÓÓ$ *
	FromEmail
ÓÓ+ 4
,
ÓÓ4 5
string
ÓÓ6 <
FromName
ÓÓ= E
,
ÓÓE F
string
ÓÓG M
ToEmails
ÓÓN V
,
ÓÓV W
string
ÓÓX ^

ReplyEmail
ÓÓ_ i
,
ÓÓi j
string
ÓÓk q
MailBody
ÓÓr z
,
ÓÓz {
stringÓÓ| 
MailSubjectÓÓ 
,ÓÓ 
stringÓÓ 
CcEmailsÓÓ 
,ÓÓ  
stringÓÓ¡ §
	BccEmailsÓÓ¨ ±
,
ÔÔ 
bool
ÔÔ 
IsHtml
ÔÔ 
,
ÔÔ 
string
ÔÔ !
attPath
ÔÔ" )
,
ÔÔ) *
string
ÔÔ+ 1
UserName
ÔÔ2 :
,
ÔÔ: ;
string
ÔÔ< B
Password
ÔÔC K
,
ÔÔK L
string
ÔÔM S
Host
ÔÔT X
,
ÔÔX Y
int
ÔÔZ ]
Port
ÔÔ^ b
,
ÔÔb c
bool
ÔÔd h
	EnableSSL
ÔÔi r
)
ÔÔr s
{
ÕÕ 	

SmtpClient
ÖÖ 

smtpClient
ÖÖ !
=
ÖÖ" #
new
ÖÖ$ '

SmtpClient
ÖÖ( 2
(
ÖÖ2 3
	FromEmail
ÖÖ3 <
)
ÖÖ< =
;
ÖÖ= >

smtpClient
×× 
.
×× #
UseDefaultCredentials
×× ,
=
××- .
false
××/ 4
;
××4 5

smtpClient
ØØ 
.
ØØ 
Credentials
ØØ "
=
ØØ# $
new
ØØ% (
System
ØØ) /
.
ØØ/ 0
Net
ØØ0 3
.
ØØ3 4
NetworkCredential
ØØ4 E
(
ØØE F
UserName
ØØF N
,
ØØN O
Password
ØØP X
)
ØØX Y
;
ØØY Z

smtpClient
ÙÙ 
.
ÙÙ 
Port
ÙÙ 
=
ÙÙ 
Port
ÙÙ "
;
ÙÙ" #

smtpClient
ÚÚ 
.
ÚÚ 
	EnableSsl
ÚÚ  
=
ÚÚ! "
	EnableSSL
ÚÚ# ,
;
ÚÚ, -

smtpClient
ÛÛ 
.
ÛÛ 
Host
ÛÛ 
=
ÛÛ 
Host
ÛÛ "
;
ÛÛ" #
MailMessage
İİ 
objMail
İİ 
=
İİ  !
new
İİ" %
MailMessage
İİ& 1
(
İİ1 2
)
İİ2 3
;
İİ3 4
if
ßß 
(
ßß 
!
ßß 
string
ßß 
.
ßß 
IsNullOrEmpty
ßß %
(
ßß% &
FromName
ßß& .
)
ßß. /
)
ßß/ 0
{
àà 
objMail
áá 
.
áá 
From
áá 
=
áá 
new
áá "
MailAddress
áá# .
(
áá. /
	FromEmail
áá/ 8
,
áá8 9
FromName
áá: B
)
ááB C
;
ááC D
}
ââ 
else
ãã 
{
ää 
objMail
åå 
.
åå 
From
åå 
=
åå 
new
åå "
MailAddress
åå# .
(
åå. /
	FromEmail
åå/ 8
)
åå8 9
;
åå9 :
}
ææ 
if
çç 
(
çç 
!
çç 
string
çç 
.
çç 
IsNullOrEmpty
çç %
(
çç% &

ReplyEmail
çç& 0
)
çç0 1
)
çç1 2
{
èè 
objMail
êê 
.
êê 
ReplyTo
êê 
=
êê  !
new
êê" %
MailAddress
êê& 1
(
êê1 2

ReplyEmail
êê2 <
)
êê< =
;
êê= >
}
ìì 
if
íí 
(
íí 
!
íí 
string
íí 
.
íí 
IsNullOrEmpty
íí %
(
íí% &
ToEmails
íí& .
)
íí. /
)
íí/ 0
{
îî 
objMail
ïï 
.
ïï 
To
ïï 
.
ïï 
Add
ïï 
(
ïï 
ToEmails
ïï '
)
ïï' (
;
ïï( )
}
ğğ 
if
ññ 
(
ññ 
!
ññ 
string
ññ 
.
ññ 
IsNullOrEmpty
ññ %
(
ññ% &
CcEmails
ññ& .
)
ññ. /
)
ññ/ 0
{
òò 
objMail
óó 
.
óó 
CC
óó 
.
óó 
Add
óó 
(
óó 
CcEmails
óó '
)
óó' (
;
óó( )
}
ôô 
if
õõ 
(
õõ 
!
õõ 
string
õõ 
.
õõ 
IsNullOrEmpty
õõ %
(
õõ% &
	BccEmails
õõ& /
)
õõ/ 0
)
õõ0 1
{
öö 
objMail
÷÷ 
.
÷÷ 
Bcc
÷÷ 
.
÷÷ 
Add
÷÷ 
(
÷÷  
	BccEmails
÷÷  )
)
÷÷) *
;
÷÷* +
}
øø 
else
ùù 
{
úú 
}
ıı 
if
şş 
(
şş 
!
şş 
string
şş 
.
şş 
IsNullOrEmpty
şş %
(
şş% &
attPath
şş& -
)
şş- .
)
şş. /
{
ÿÿ 

Attachment
 
path
 
=
  !
new
" %

Attachment
& 0
(
0 1
attPath
1 8
)
8 9
;
9 :
objMail
 
.
 
Attachments
 #
.
# $
Add
$ '
(
' (
path
( ,
)
, -
;
- .
}
 
else
 
{
 
}
 
objMail
 
.
 
Subject
 
=
 
MailSubject
 )
;
) *
objMail
 
.
 
Body
 
=
 
MailBody
 #
;
# $
objMail
 
.
 

IsBodyHtml
 
=
  
IsHtml
! '
;
' (
try
 
{
 

smtpClient
 
.
 
Send
 
(
  
objMail
  '
)
' (
;
( )
return
 
true
 
;
 
}
 
catch
 
(
 
	Exception
 
e
 
)
 
{
 
	Exception
 
ex
 
=
 
e
  
;
  !
return
 
false
 
;
 
}
 
}
 	
public
 
bool
 $
SendChangePasswordMail
 *
(
* +
string
+ 1
DisplayName
2 =
,
= >
string
? E
emailAddress
F R
,
R S
string
T Z
UserName
[ c
,
c d
string
e k
Password
l t
,
t u
string
v |
RootPath} 
, 
string 
beneficiarytype 
) 
{
 	
string
 
strMailBody
 
=
  
$str
! #
;
# $
string
 
path
 
=
 
string
  
.
  !
Empty
! &
;
& '
if
 
(
 
OperatingSystem
 
.
  
	IsWindows
  )
(
) *
)
* +
)
+ ,
path
 
=
 
Path
 
.
 
Combine
 #
(
# $
RootPath
$ ,
+
- .
$str
/ S
)
S T
;
T U
else
   
if
   
(
   
OperatingSystem
   $
.
  $ %
IsLinux
  % ,
(
  , -
)
  - .
)
  . /
path
¡¡ 
=
¡¡ 
Path
¡¡ 
.
¡¡ 
Combine
¡¡ #
(
¡¡# $
RootPath
¡¡$ ,
+
¡¡- .
$str
¡¡/ S
)
¡¡S T
;
¡¡T U
else
¢¢ 
{
££ 
path
¤¤ 
=
¤¤ 
$str
¤¤ 
;
¤¤ 
}
¥¥ 
StreamReader
§§ 
IDDSbody
§§ !
=
§§" #
new
§§$ '
StreamReader
§§( 4
(
§§4 5
path
§§5 9
)
§§9 :
;
§§: ;
string
¨¨ 
beneficiaryname
¨¨ "
=
¨¨# $
$str
¨¨% '
;
¨¨' (
if
©© 
(
©© 
beneficiarytype
©© 
==
©©  "
$str
©©# &
)
©©& '
{
ªª 
beneficiaryname
«« 
=
««  !
$str
««" X
;
««X Y
}
¬¬ 
else
­­ 
{
®® 
beneficiaryname
¯¯ 
=
¯¯  !
$str
¯¯" @
;
¯¯@ A
}
°° 
strMailBody
µµ 
=
µµ 
IDDSbody
µµ "
.
µµ" #
	ReadToEnd
µµ# ,
(
µµ, -
)
µµ- .
;
µµ. /
strMailBody
¶¶ 
=
¶¶ 
strMailBody
¶¶ %
.
¶¶% &
Replace
¶¶& -
(
¶¶- .
$str
¶¶. 6
,
¶¶6 7
DisplayName
¶¶8 C
)
¶¶C D
;
¶¶D E
strMailBody
·· 
=
·· 
strMailBody
·· %
.
··% &
Replace
··& -
(
··- .
$str
··. A
,
··A B
beneficiaryname
··C R
)
··R S
;
··S T
strMailBody
¸¸ 
=
¸¸ 
strMailBody
¸¸ %
.
¸¸% &
Replace
¸¸& -
(
¸¸- .
$str
¸¸. :
,
¸¸: ;
UserName
¸¸< D
)
¸¸D E
;
¸¸E F
strMailBody
¹¹ 
=
¹¹ 
strMailBody
¹¹ %
.
¹¹% &
Replace
¹¹& -
(
¹¹- .
$str
¹¹. :
,
¹¹: ;
Password
¹¹< D
)
¹¹D E
;
¹¹E F
bool
¼¼ 
Chk
¼¼ 
=
¼¼ 
SendMail
¼¼ 
(
¼¼  &
_sMTPConfigSenderAddress
¼¼  8
,
¼¼8 9*
_sMTPConfigSenderDisplayName
¼¼: V
,
¼¼V W
emailAddress
¼¼X d
,
¼¼d e&
_sMTPConfigSenderAddress
¼¼f ~
,
¼¼~ 
strMailBody¼¼ 
,¼¼ 
$str¼¼ £
,¼¼£ ¤
$str¼¼¥ §
,¼¼§ ¨
$str¼¼© «
,
½½ 
true
½½ 
,
½½ 
$str
½½ 
,
½½ !
_sMTPConfigUserName
½½ /
,
½½/ 0!
_sMTPConfigPassword
½½1 D
,
½½D E
_sMTPConfigHost
½½F U
,
½½U V
_sMTPConfigPort
½½W f
,
½½f g"
_sMTPConfigEnableSSL
½½h |
)
½½| }
;
½½} ~
return
¿¿ 
Chk
¿¿ 
;
¿¿ 
}
ÀÀ 	
public
ÂÂ 
bool
ÂÂ 
SendExceptionMail
ÂÂ %
(
ÂÂ% &
ExceptionLogger
ÂÂ& 5
exceptionLogger
ÂÂ6 E
,
ÂÂE F
string
ÂÂG M
RootPath
ÂÂN V
,
ÂÂV W
string
ÂÂX ^
TemplateName
ÂÂ_ k
)
ÂÂk l
{
ÃÃ 	
string
ÄÄ 
strMailBody
ÄÄ 
=
ÄÄ  
$str
ÄÄ! #
;
ÄÄ# $
string
ÇÇ 
path
ÇÇ 
=
ÇÇ 
string
ÇÇ  
.
ÇÇ  !
Empty
ÇÇ! &
;
ÇÇ& '
if
ÈÈ 
(
ÈÈ 
OperatingSystem
ÈÈ 
.
ÈÈ  
	IsWindows
ÈÈ  )
(
ÈÈ) *
)
ÈÈ* +
)
ÈÈ+ ,
path
ÉÉ 
=
ÉÉ 
Path
ÉÉ 
.
ÉÉ 
Combine
ÉÉ #
(
ÉÉ# $
RootPath
ÉÉ$ ,
+
ÉÉ- .
$str
ÉÉ/ A
+
ÉÉB C
TemplateName
ÉÉD P
)
ÉÉP Q
;
ÉÉQ R
else
ÊÊ 
if
ÊÊ 
(
ÊÊ 
OperatingSystem
ÊÊ $
.
ÊÊ$ %
IsLinux
ÊÊ% ,
(
ÊÊ, -
)
ÊÊ- .
)
ÊÊ. /
path
ËË 
=
ËË 
Path
ËË 
.
ËË 
Combine
ËË #
(
ËË# $
RootPath
ËË$ ,
+
ËË- .
$str
ËË/ A
+
ËËB C
TemplateName
ËËD P
)
ËËP Q
;
ËËQ R
else
ÌÌ 
{
ÍÍ 
path
ÎÎ 
=
ÎÎ 
$str
ÎÎ 
;
ÎÎ 
}
ÏÏ 
StreamReader
ÒÒ 
IDDSbody
ÒÒ !
=
ÒÒ" #
new
ÒÒ$ '
StreamReader
ÒÒ( 4
(
ÒÒ4 5
path
ÒÒ5 9
)
ÒÒ9 :
;
ÒÒ: ;
strMailBody
ÖÖ 
=
ÖÖ 
IDDSbody
ÖÖ "
.
ÖÖ" #
	ReadToEnd
ÖÖ# ,
(
ÖÖ, -
)
ÖÖ- .
;
ÖÖ. /
strMailBody
×× 
=
×× 
strMailBody
×× %
.
××% &
Replace
××& -
(
××- .
$str
××. ?
,
××? @
DateTime
××A I
.
××I J
Now
××J M
.
××M N
ToString
××N V
(
××V W
$str
××W m
)
××m n
)
××n o
;
××o p
strMailBody
ØØ 
=
ØØ 
strMailBody
ØØ %
.
ØØ% &
Replace
ØØ& -
(
ØØ- .
$str
ØØ. 8
,
ØØ8 9
Convert
ØØ: A
.
ØØA B
ToString
ØØB J
(
ØØJ K
exceptionLogger
ØØK Z
.
ØØZ [
UserId
ØØ[ a
)
ØØa b
)
ØØb c
;
ØØc d
strMailBody
ÙÙ 
=
ÙÙ 
strMailBody
ÙÙ %
.
ÙÙ% &
Replace
ÙÙ& -
(
ÙÙ- .
$str
ÙÙ. <
,
ÙÙ< =
Convert
ÙÙ> E
.
ÙÙE F
ToString
ÙÙF N
(
ÙÙN O
exceptionLogger
ÙÙO ^
.
ÙÙ^ _

ActionName
ÙÙ_ i
)
ÙÙi j
)
ÙÙj k
;
ÙÙk l
strMailBody
ÚÚ 
=
ÚÚ 
strMailBody
ÚÚ %
.
ÚÚ% &
Replace
ÚÚ& -
(
ÚÚ- .
$str
ÚÚ. @
,
ÚÚ@ A
Convert
ÚÚB I
.
ÚÚI J
ToString
ÚÚJ R
(
ÚÚR S
exceptionLogger
ÚÚS b
.
ÚÚb c
ControllerName
ÚÚc q
)
ÚÚq r
)
ÚÚr s
;
ÚÚs t
strMailBody
ÛÛ 
=
ÛÛ 
strMailBody
ÛÛ %
.
ÛÛ% &
Replace
ÛÛ& -
(
ÛÛ- .
$str
ÛÛ. B
,
ÛÛB C
Convert
ÛÛD K
.
ÛÛK L
ToString
ÛÛL T
(
ÛÛT U
exceptionLogger
ÛÛU d
.
ÛÛd e
ExceptionMessage
ÛÛe u
)
ÛÛu v
)
ÛÛv w
;
ÛÛw x
strMailBody
ÜÜ 
=
ÜÜ 
strMailBody
ÜÜ %
.
ÜÜ% &
Replace
ÜÜ& -
(
ÜÜ- .
$str
ÜÜ. E
,
ÜÜE F
Convert
ÜÜG N
.
ÜÜN O
ToString
ÜÜO W
(
ÜÜW X
exceptionLogger
ÜÜX g
.
ÜÜg h!
ExceptionStackTrace
ÜÜh {
)
ÜÜ{ |
)
ÜÜ| }
;
ÜÜ} ~
strMailBody
İİ 
=
İİ 
strMailBody
İİ %
.
İİ% &
Replace
İİ& -
(
İİ- .
$str
İİ. <
,
İİ< =
Convert
İİ> E
.
İİE F
ToString
İİF N
(
İİN O
exceptionLogger
İİO ^
.
İİ^ _

RequestURI
İİ_ i
)
İİi j
)
İİj k
;
İİk l
strMailBody
ŞŞ 
=
ŞŞ 
strMailBody
ŞŞ %
.
ŞŞ% &
Replace
ŞŞ& -
(
ŞŞ- .
$str
ŞŞ. 8
,
ŞŞ8 9
Convert
ŞŞ: A
.
ŞŞA B
ToString
ŞŞB J
(
ŞŞJ K
exceptionLogger
ŞŞK Z
.
ŞŞZ [

LineNumber
ŞŞ[ e
)
ŞŞe f
)
ŞŞf g
;
ŞŞg h
strMailBody
ßß 
=
ßß 
strMailBody
ßß %
.
ßß% &
Replace
ßß& -
(
ßß- .
$str
ßß. 9
,
ßß9 :
Convert
ßß; B
.
ßßB C
ToString
ßßC K
(
ßßK L
nameof
ßßL R
(
ßßR S

EnumLookup
ßßS ]
.
ßß] ^
exceptionlogfrom
ßß^ n
.
ßßn o
WEB
ßßo r
)
ßßr s
)
ßßs t
)
ßßt u
;
ßßu v
strMailBody
àà 
=
àà 
strMailBody
àà %
.
àà% &
Replace
àà& -
(
àà- .
$str
àà. ;
,
àà; <
Convert
àà= D
.
ààD E
ToString
ààE M
(
ààM N
exceptionLogger
ààN ]
.
àà] ^
	IpAddress
àà^ g
)
ààg h
)
ààh i
;
àài j
strMailBody
áá 
=
áá 
strMailBody
áá %
.
áá% &
Replace
áá& -
(
áá- .
$str
áá. :
,
áá: ;
Convert
áá< C
.
ááC D
ToString
ááD L
(
ááL M
exceptionLogger
ááM \
.
áá\ ]
HostName
áá] e
)
ááe f
)
ááf g
;
áág h
bool
ãã 
Chk
ãã 
=
ãã 
SendMail
ãã 
(
ãã  &
_sMTPConfigSenderAddress
ãã  8
,
ãã8 9*
_sMTPConfigSenderDisplayName
ãã: V
,
ããV W 
_emailforexception
ããX j
,
ããj k'
_sMTPConfigSenderAddressããl 
,ãã 
strMailBodyãã 
,ãã 
$strãã ²
,ãã² ³
$strãã´ ¶
,ãã¶ ·
$strãã¸ º
,
ää 
true
ää 
,
ää 
$str
ää 
,
ää !
_sMTPConfigUserName
ää /
,
ää/ 0!
_sMTPConfigPassword
ää1 D
,
ääD E
_sMTPConfigHost
ääF U
,
ääU V
_sMTPConfigPort
ääW f
,
ääf g"
_sMTPConfigEnableSSL
ääh |
)
ää| }
;
ää} ~
return
ææ 
Chk
ææ 
;
ææ 
}
çç 	
public
ëë 
bool
ëë /
!SendServiceSMSWithDBLogINGujarati
ëë 5
(
ëë5 6
string
ëë6 <

SmsContent
ëë= G
,
ëëG H
string
ëëI O
MobileNo
ëëP X
,
ëëX Y
string
ëëZ `

TemplateId
ëëa k
)
ëëk l
{
ìì 	
if
íí 
(
íí 
_isSMSRequired
íí 
==
íí !
$str
íí" %
)
íí% &
{
îî 
string
ïï 
response
ïï 
=
ïï  !
$str
ïï" $
;
ïï$ %
string
ğğ 

MessageUrl
ğğ !
=
ğğ" #
_messageUrl
ğğ$ /
;
ğğ/ 0
string
ññ 
UserName
ññ 
=
ññ  !
_messageUserName
ññ" 2
;
ññ2 3
string
òò 
Password
òò 
=
òò  !
_messagePassword
òò" 2
;
òò2 3
string
óó 
SenderId
óó 
=
óó  !
_messageSenderId
óó" 2
;
óó2 3
string
ôô 
	SecureKey
ôô  
=
ôô! "

_secureKey
ôô# -
;
ôô- .
if
öö 
(
öö 
!
öö 
string
öö 
.
öö 
IsNullOrEmpty
öö )
(
öö) *

MessageUrl
öö* 4
)
öö4 5
&&
öö6 8
!
öö9 :
string
öö: @
.
öö@ A
IsNullOrEmpty
ööA N
(
ööN O
UserName
ööO W
)
ööW X
&&
ööY [
!
÷÷ 
string
÷÷ 
.
÷÷ 
IsNullOrEmpty
÷÷ )
(
÷÷) *
Password
÷÷* 2
)
÷÷2 3
&&
÷÷4 6
!
÷÷7 8
string
÷÷8 >
.
÷÷> ?
IsNullOrEmpty
÷÷? L
(
÷÷L M
SenderId
÷÷M U
)
÷÷U V
&&
÷÷W Y
!
÷÷Z [
string
÷÷[ a
.
÷÷a b
IsNullOrEmpty
÷÷b o
(
÷÷o p
MobileNo
÷÷p x
)
÷÷x y
&&
øø 
!
øø 
string
øø 
.
øø 
IsNullOrEmpty
øø ,
(
øø, -
	SecureKey
øø- 6
)
øø6 7
)
øø7 8
{
ùù 
response
úú 
=
úú 
SendUnicodeSMS
úú -
(
úú- .

MessageUrl
úú. 8
,
úú8 9
UserName
úú: B
,
úúB C
Password
úúD L
,
úúL M
SenderId
úúN V
,
úúV W
MobileNo
úúX `
,
úú` a

SmsContent
úúb l
,
úúl m
	SecureKey
úún w
,
úúw x

TemplateIdúúy 
)úú 
;úú 
return
ûû 
true
ûû 
;
ûû  
}
ıı 
else
şş 
{
ÿÿ 
return
 
false
  
;
  !
throw
 
new
 
ArgumentException
 /
(
/ 0
$str
0 P
)
P Q
;
Q R
}
 
}
 
else
 
{
 
return
 
true
 
;
 
}
 
}
 	
public
 
static
 
String
 
SendUnicodeSMS
 +
(
+ ,
string
, 2
URL
3 6
,
6 7
String
8 >
username
? G
,
G H
String
I O
password
P X
,
X Y
String
Z `
senderid
a i
,
i j
String
k q
	mobileNos
r {
,
{ |
String} 
Unicodemessage 
, 
String 
	secureKey ¤
,¤ ¥
string¦ ¬

TemplateId­ ·
)· ¸
{
 	
Stream
 

dataStream
 
;
 !
ServicePointManager
 
.
  
SecurityProtocol
  0
=
1 2"
SecurityProtocolType
3 G
.
G H
Tls12
H M
;
M N
HttpWebRequest
 
request
 "
=
# $
(
% &
HttpWebRequest
& 4
)
4 5

WebRequest
5 ?
.
? @
Create
@ F
(
F G
URL
G J
)
J K
;
K L
request
 
.
 
ProtocolVersion
 #
=
$ %
HttpVersion
& 1
.
1 2
	Version10
2 ;
;
; <
request
 
.
 
	KeepAlive
 
=
 
false
  %
;
% &
request
 
.
 
ServicePoint
  
.
  !
ConnectionLimit
! 0
=
1 2
$num
3 4
;
4 5
(
 
(
 
HttpWebRequest
 
)
 
request
 $
)
$ %
.
% &
	UserAgent
& /
=
0 1
$str
2 j
;
j k
request
 
.
 
Method
 
=
 
$str
 #
;
# $
String
  
U_Convertedmessage
 %
=
& '
$str
( *
;
* +
foreach
 
(
 
char
 
c
 
in
 
Unicodemessage
 -
)
- .
{
 
int
 
j
 
=
 
(
 
int
 
)
 
c
 
;
 
String
 
sss
 
=
 
$str
 !
+
" #
j
$ %
+
& '
$str
( +
;
+ , 
U_Convertedmessage
   "
=
  # $ 
U_Convertedmessage
  % 7
+
  8 9
sss
  : =
;
  = >
}
¡¡ 
String
¢¢ 
encryptedPassword
¢¢ $
=
¢¢% &
encryptedPasswod
¢¢' 7
(
¢¢7 8
password
¢¢8 @
)
¢¢@ A
;
¢¢A B
String
££ 
NewsecureKey
££ 
=
££  !
hashGenerator
££" /
(
££/ 0
username
££0 8
.
££8 9
Trim
££9 =
(
££= >
)
££> ?
,
££? @
senderid
££A I
.
££I J
Trim
££J N
(
££N O
)
££O P
,
££P Q 
U_Convertedmessage
££R d
.
££d e
Trim
££e i
(
££i j
)
££j k
,
££k l
	secureKey
££m v
.
££v w
Trim
££w {
(
££{ |
)
££| }
)
££} ~
;
££~ 
String
¦¦ 
smsservicetype
¦¦ !
=
¦¦" #
$str
¦¦$ 0
;
¦¦0 1
String
§§ 
query
§§ 
=
§§ 
$str
§§ &
+
§§' (
HttpUtility
§§) 4
.
§§4 5
	UrlEncode
§§5 >
(
§§> ?
username
§§? G
.
§§G H
Trim
§§H L
(
§§L M
)
§§M N
)
§§N O
+
§§P Q
$str
¨¨ 
+
¨¨ 
HttpUtility
¨¨ *
.
¨¨* +
	UrlEncode
¨¨+ 4
(
¨¨4 5
encryptedPassword
¨¨5 F
)
¨¨F G
+
¨¨H I
$str
©© "
+
©©# $
HttpUtility
©©% 0
.
©©0 1
	UrlEncode
©©1 :
(
©©: ;
smsservicetype
©©; I
)
©©I J
+
©©K L
$str
ªª 
+
ªª 
HttpUtility
ªª )
.
ªª) *
	UrlEncode
ªª* 3
(
ªª3 4 
U_Convertedmessage
ªª4 F
.
ªªF G
Trim
ªªG K
(
ªªK L
)
ªªL M
)
ªªM N
+
ªªO P
$str
«« 
+
«« 
HttpUtility
««  +
.
««+ ,
	UrlEncode
««, 5
(
««5 6
	mobileNos
««6 ?
)
««? @
+
««A B
$str
¬¬ 
+
¬¬ 
HttpUtility
¬¬ *
.
¬¬* +
	UrlEncode
¬¬+ 4
(
¬¬4 5
senderid
¬¬5 =
.
¬¬= >
Trim
¬¬> B
(
¬¬B C
)
¬¬C D
)
¬¬D E
+
¬¬F G
$str
­­ 
+
­­ 
HttpUtility
­­ %
.
­­% &
	UrlEncode
­­& /
(
­­/ 0
NewsecureKey
­­0 <
.
­­< =
Trim
­­= A
(
­­A B
)
­­B C
)
­­C D
+
­­E F
$str
®® 
+
®®  
HttpUtility
®®! ,
.
®®, -
	UrlEncode
®®- 6
(
®®6 7

TemplateId
®®7 A
.
®®A B
Trim
®®B F
(
®®F G
)
®®G H
)
®®H I
;
®®I J
byte
±± 
[
±± 
]
±± 
	byteArray
±± 
=
±± 
Encoding
±± '
.
±±' (
ASCII
±±( -
.
±±- .
GetBytes
±±. 6
(
±±6 7
query
±±7 <
)
±±< =
;
±±= >
request
²² 
.
²² 
ContentType
²² 
=
²²  !
$str
²²" E
;
²²E F
request
³³ 
.
³³ 
ContentLength
³³ !
=
³³" #
	byteArray
³³$ -
.
³³- .
Length
³³. 4
;
³³4 5

dataStream
´´ 
=
´´ 
request
´´  
.
´´  !
GetRequestStream
´´! 1
(
´´1 2
)
´´2 3
;
´´3 4

dataStream
µµ 
.
µµ 
Write
µµ 
(
µµ 
	byteArray
µµ &
,
µµ& '
$num
µµ( )
,
µµ) *
	byteArray
µµ+ 4
.
µµ4 5
Length
µµ5 ;
)
µµ; <
;
µµ< =

dataStream
¶¶ 
.
¶¶ 
Close
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶ 
WebResponse
·· 
response
··  
=
··! "
request
··# *
.
··* +
GetResponse
··+ 6
(
··6 7
)
··7 8
;
··8 9
String
¸¸ 
Status
¸¸ 
=
¸¸ 
(
¸¸ 
(
¸¸ 
HttpWebResponse
¸¸ -
)
¸¸- .
response
¸¸. 6
)
¸¸6 7
.
¸¸7 8
StatusDescription
¸¸8 I
;
¸¸I J

dataStream
¹¹ 
=
¹¹ 
response
¹¹ !
.
¹¹! "
GetResponseStream
¹¹" 3
(
¹¹3 4
)
¹¹4 5
;
¹¹5 6
StreamReader
ºº 
reader
ºº 
=
ºº  !
new
ºº" %
StreamReader
ºº& 2
(
ºº2 3

dataStream
ºº3 =
)
ºº= >
;
ºº> ?
String
»»  
responseFromServer
»» %
=
»»& '
reader
»»( .
.
»». /
	ReadToEnd
»»/ 8
(
»»8 9
)
»»9 :
;
»»: ;
reader
¼¼ 
.
¼¼ 
Close
¼¼ 
(
¼¼ 
)
¼¼ 
;
¼¼ 

dataStream
½½ 
.
½½ 
Close
½½ 
(
½½ 
)
½½ 
;
½½ 
response
¾¾ 
.
¾¾ 
Close
¾¾ 
(
¾¾ 
)
¾¾ 
;
¾¾ 
return
¿¿  
responseFromServer
¿¿ %
;
¿¿% &
}
ÀÀ 	
	protected
ÂÂ 
static
ÂÂ 
String
ÂÂ 
hashGenerator
ÂÂ  -
(
ÂÂ- .
String
ÂÂ. 4
Username
ÂÂ5 =
,
ÂÂ= >
String
ÂÂ? E
	sender_id
ÂÂF O
,
ÂÂO P
String
ÂÂQ W
message
ÂÂX _
,
ÂÂ_ `
String
ÂÂa g

secure_key
ÂÂh r
)
ÂÂr s
{
ÃÃ 	
StringBuilder
ÄÄ 
sb
ÄÄ 
=
ÄÄ 
new
ÄÄ "
StringBuilder
ÄÄ# 0
(
ÄÄ0 1
)
ÄÄ1 2
;
ÄÄ2 3
sb
ÅÅ 
.
ÅÅ 
Append
ÅÅ 
(
ÅÅ 
Username
ÅÅ 
)
ÅÅ 
.
ÅÅ  
Append
ÅÅ  &
(
ÅÅ& '
	sender_id
ÅÅ' 0
)
ÅÅ0 1
.
ÅÅ1 2
Append
ÅÅ2 8
(
ÅÅ8 9
message
ÅÅ9 @
)
ÅÅ@ A
.
ÅÅA B
Append
ÅÅB H
(
ÅÅH I

secure_key
ÅÅI S
)
ÅÅS T
;
ÅÅT U
byte
ÆÆ 
[
ÆÆ 
]
ÆÆ 
genkey
ÆÆ 
=
ÆÆ 
Encoding
ÆÆ $
.
ÆÆ$ %
UTF8
ÆÆ% )
.
ÆÆ) *
GetBytes
ÆÆ* 2
(
ÆÆ2 3
sb
ÆÆ3 5
.
ÆÆ5 6
ToString
ÆÆ6 >
(
ÆÆ> ?
)
ÆÆ? @
)
ÆÆ@ A
;
ÆÆA B
HashAlgorithm
ÈÈ 
sha1
ÈÈ 
=
ÈÈ  
HashAlgorithm
ÈÈ! .
.
ÈÈ. /
Create
ÈÈ/ 5
(
ÈÈ5 6
$str
ÈÈ6 >
)
ÈÈ> ?
;
ÈÈ? @
byte
ÉÉ 
[
ÉÉ 
]
ÉÉ 
sec_key
ÉÉ 
=
ÉÉ 
sha1
ÉÉ !
.
ÉÉ! "
ComputeHash
ÉÉ" -
(
ÉÉ- .
genkey
ÉÉ. 4
)
ÉÉ4 5
;
ÉÉ5 6
StringBuilder
ËË 
sb1
ËË 
=
ËË 
new
ËË  #
StringBuilder
ËË$ 1
(
ËË1 2
)
ËË2 3
;
ËË3 4
for
ÌÌ 
(
ÌÌ 
int
ÌÌ 
i
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
;
ÌÌ 
i
ÌÌ 
<
ÌÌ 
sec_key
ÌÌ  '
.
ÌÌ' (
Length
ÌÌ( .
;
ÌÌ. /
i
ÌÌ0 1
++
ÌÌ1 3
)
ÌÌ3 4
{
ÍÍ 
sb1
ÎÎ 
.
ÎÎ 
Append
ÎÎ 
(
ÎÎ 
sec_key
ÎÎ "
[
ÎÎ" #
i
ÎÎ# $
]
ÎÎ$ %
.
ÎÎ% &
ToString
ÎÎ& .
(
ÎÎ. /
$str
ÎÎ/ 3
)
ÎÎ3 4
)
ÎÎ4 5
;
ÎÎ5 6
}
ÏÏ 
return
ĞĞ 
sb1
ĞĞ 
.
ĞĞ 
ToString
ĞĞ 
(
ĞĞ  
)
ĞĞ  !
;
ĞĞ! "
}
ÑÑ 	
	protected
ÒÒ 
static
ÒÒ 
String
ÒÒ 
encryptedPasswod
ÒÒ  0
(
ÒÒ0 1
String
ÒÒ1 7
password
ÒÒ8 @
)
ÒÒ@ A
{
ÓÓ 	
byte
ÔÔ 
[
ÔÔ 
]
ÔÔ 
encPwd
ÔÔ 
=
ÔÔ 
Encoding
ÔÔ $
.
ÔÔ$ %
UTF8
ÔÔ% )
.
ÔÔ) *
GetBytes
ÔÔ* 2
(
ÔÔ2 3
password
ÔÔ3 ;
)
ÔÔ; <
;
ÔÔ< =
HashAlgorithm
ÖÖ 
sha1
ÖÖ 
=
ÖÖ  
HashAlgorithm
ÖÖ! .
.
ÖÖ. /
Create
ÖÖ/ 5
(
ÖÖ5 6
$str
ÖÖ6 <
)
ÖÖ< =
;
ÖÖ= >
byte
×× 
[
×× 
]
×× 
pp
×× 
=
×× 
sha1
×× 
.
×× 
ComputeHash
×× (
(
××( )
encPwd
××) /
)
××/ 0
;
××0 1
StringBuilder
ÙÙ 
sb
ÙÙ 
=
ÙÙ 
new
ÙÙ "
StringBuilder
ÙÙ# 0
(
ÙÙ0 1
)
ÙÙ1 2
;
ÙÙ2 3
foreach
ÚÚ 
(
ÚÚ 
byte
ÚÚ 
b
ÚÚ 
in
ÚÚ 
pp
ÚÚ !
)
ÚÚ! "
{
ÛÛ 
sb
İİ 
.
İİ 
Append
İİ 
(
İİ 
b
İİ 
.
İİ 
ToString
İİ $
(
İİ$ %
$str
İİ% )
)
İİ) *
)
İİ* +
;
İİ+ ,
}
ŞŞ 
return
ßß 
sb
ßß 
.
ßß 
ToString
ßß 
(
ßß 
)
ßß  
;
ßß  !
}
àà 	
public
áá 
static
áá 
string
áá 
ConcatString
áá )
(
áá) *
string
áá* 0
strtext1
áá1 9
,
áá9 :
string
áá; A
strtext2
ááB J
,
ááJ K
string
ááL R
	seperator
ááS \
)
áá\ ]
{
ââ 	
return
ãã 
string
ãã 
.
ãã 
Concat
ãã  
(
ãã  !
strtext1
ãã! )
,
ãã) *
	seperator
ãã+ 4
,
ãã4 5
strtext2
ãã6 >
)
ãã> ?
;
ãã? @
}
åå 	
public
èè 
async
èè 
Task
èè 
<
èè 
CouchDBResponse
èè )
>
èè) *
UplodToCouchDB
èè+ 9
(
èè9 :
CouchDBRequest
èè: H

attachInfo
èèI S
)
èèS T
{
éé 	
var
êê 
dbClient
êê 
=
êê 
DbHttpClient
êê '
(
êê' (
)
êê( )
;
êê) *
var
ëë 
jsonData
ëë 
=
ëë 
JsonConvert
ëë &
.
ëë& '
SerializeObject
ëë' 6
(
ëë6 7

attachInfo
ëë7 A
)
ëëA B
;
ëëB C
var
ìì 
httpContent
ìì 
=
ìì 
new
ìì !
StringContent
ìì" /
(
ìì/ 0
jsonData
ìì0 8
,
ìì8 9
Encoding
ìì: B
.
ììB C
UTF8
ììC G
,
ììG H
$str
ììI [
)
ìì[ \
;
ìì\ ]
var
íí 

postResult
íí 
=
íí 
await
íí "
dbClient
íí# +
.
íí+ ,
	PostAsync
íí, 5
(
íí5 6
_couchDbName
íí6 B
,
ííB C
httpContent
ííD O
)
ííO P
.
ííP Q
ConfigureAwait
ííQ _
(
íí_ `
true
íí` d
)
ííd e
;
ííe f
var
ïï 
result
ïï 
=
ïï 
await
ïï 

postResult
ïï )
.
ïï) *
Content
ïï* 1
.
ïï1 2
ReadAsStringAsync
ïï2 C
(
ïïC D
)
ïïD E
;
ïïE F
var
ññ 
	savedInfo
ññ 
=
ññ 
JsonConvert
ññ '
.
ññ' (
DeserializeObject
ññ( 9
<
ññ9 :
CouchDBResponse
ññ: I
>
ññI J
(
ññJ K
result
ññK Q
)
ññQ R
;
ññR S
var
òò 
requestContent
òò 
=
òò  
new
òò! $
ByteArrayContent
òò% 5
(
òò5 6

attachInfo
òò6 @
.
òò@ A
AttachmentData
òòA O
)
òòO P
;
òòP Q
requestContent
óó 
.
óó 
Headers
óó "
.
óó" #
ContentType
óó# .
=
óó/ 0
new
óó1 4"
MediaTypeHeaderValue
óó5 I
(
óóI J
$str
óóJ _
)
óó_ `
;
óó` a
var
õõ 
	putResult
õõ 
=
õõ 
await
õõ !
dbClient
õõ" *
.
õõ* +
PutAsync
õõ+ 3
(
õõ3 4
_couchDbName
õõ4 @
+
õõA B
$str
õõC F
+
õõG H
	savedInfo
õõI R
.
õõR S
Id
õõS U
+
õõV W
$str
õõX [
+
õõ\ ]

attachInfo
õõ^ h
.
õõh i
FileName
õõi q
+
õõr s
$str
õõt {
+
õõ| }
	savedInfoõõ~ 
.õõ 
Revõõ 
,õõ 
requestContentõõ 
)õõ 
;õõ 
CouchDBResponse
öö 
couchDBResponse
öö +
=
öö, -
new
öö. 1
CouchDBResponse
öö2 A
(
ööA B
)
ööB C
;
ööC D
if
÷÷ 
(
÷÷ 
	putResult
÷÷ 
.
÷÷ !
IsSuccessStatusCode
÷÷ -
)
÷÷- .
{
øø 
couchDBResponse
úú 
.
úú  
	IsSuccess
úú  )
=
úú* +
true
úú, 0
;
úú0 1
couchDBResponse
ûû 
.
ûû  
Id
ûû  "
=
ûû# $
	savedInfo
ûû% .
.
ûû. /
Id
ûû/ 1
;
ûû1 2
couchDBResponse
üü 
.
üü  
Rev
üü  #
=
üü$ %
	savedInfo
üü& /
.
üü/ 0
Rev
üü0 3
;
üü3 4
couchDBResponse
ıı 
.
ıı  
Result
ıı  &
=
ıı' (
	savedInfo
ıı) 2
.
ıı2 3
Result
ıı3 9
;
ıı9 :
return
ÿÿ 
couchDBResponse
ÿÿ &
;
ÿÿ& '
}
 
couchDBResponse
 
.
 
	IsSuccess
 %
=
& '
false
( -
;
- .
couchDBResponse
 
.
 
Result
 "
=
# $
	putResult
% .
.
. /
ReasonPhrase
/ ;
;
; <
return
 
couchDBResponse
 "
;
" #
}
 	
private
 

HttpClient
 
DbHttpClient
 '
(
' (
)
( )
{
 	
var
 

httpClient
 
=
 
_clientFactory
 +
.
+ ,
CreateClient
, 8
(
8 9
)
9 :
;
: ;

httpClient
 
.
 #
DefaultRequestHeaders
 ,
.
, -
Accept
- 3
.
3 4
Clear
4 9
(
9 :
)
: ;
;
; <

httpClient
 
.
 #
DefaultRequestHeaders
 ,
.
, -
Clear
- 2
(
2 3
)
3 4
;
4 5

httpClient
 
.
 
BaseAddress
 "
=
# $
new
% (
Uri
) ,
(
, -
_couchDbUrl
- 8
)
8 9
;
9 :
var
 
dbUserByteArray
 
=
  !
Encoding
" *
.
* +
ASCII
+ 0
.
0 1
GetBytes
1 9
(
9 :
_couchDbUser
: F
)
F G
;
G H

httpClient
 
.
 #
DefaultRequestHeaders
 ,
.
, -
Add
- 0
(
0 1
$str
1 @
,
@ A
$str
B J
+
K L
Convert
M T
.
T U
ToBase64String
U c
(
c d
dbUserByteArray
d s
)
s t
)
t u
;
u v
return
 

httpClient
 
;
 
}
 	
public
 
async
 
Task
 
<
 
CouchDBResponse
 )
>
) *$
GetAttachmentByteArray
+ A
(
A B
string
B H
DocId
I N
,
N O
string
P V
AttName
W ^
)
^ _
{
 	
var
 
dbClient
 
=
 
DbHttpClient
 '
(
' (
)
( )
;
) *
var
 
dbResult
 
=
 
await
  
dbClient
! )
.
) *
GetAsync
* 2
(
2 3
_couchDbName
3 ?
+
@ A
$str
B E
+
F G
DocId
H M
+
N O
$str
P S
+
T U
AttName
V ]
)
] ^
;
^ _
CouchDBResponse
 
couchDBResponse
 +
=
, -
new
. 1
CouchDBResponse
2 A
(
A B
)
B C
;
C D
if
 
(
 
dbResult
 
.
 !
IsSuccessStatusCode
 ,
)
, -
{
 
couchDBResponse
 
.
  
	IsSuccess
  )
=
* +
true
, 0
;
0 1
couchDBResponse
 
.
  
	ImageData
  )
=
* +
dbResult
, 4
.
4 5
Content
5 <
.
< ="
ReadAsByteArrayAsync
= Q
(
Q R
)
R S
;
S T
return
 
couchDBResponse
 &
;
& '
}
   
couchDBResponse
££ 
.
££ 
	IsSuccess
££ %
=
££& '
false
££( -
;
££- .
couchDBResponse
¤¤ 
.
¤¤ 
Result
¤¤ "
=
¤¤# $
dbResult
¤¤% -
.
¤¤- .
ReasonPhrase
¤¤. :
;
¤¤: ;
return
¥¥ 
couchDBResponse
¥¥ "
;
¥¥" #
}
§§ 	
public
©© 
async
©© 
Task
©© 
<
©© 
CouchDBResponse
©© )
>
©©) *"
GetDocumentByteArray
©©+ ?
(
©©? @
string
©©@ F
DocId
©©G L
,
©©L M
string
©©N T
AttName
©©U \
)
©©\ ]
{
ªª 	
var
«« 
dbClient
«« 
=
«« 
DbHttpClient
«« '
(
««' (
)
««( )
;
««) *
var
¬¬ 
dbResult
¬¬ 
=
¬¬ 
await
¬¬  
dbClient
¬¬! )
.
¬¬) *
GetAsync
¬¬* 2
(
¬¬2 3
_couchDbName
¬¬3 ?
+
¬¬@ A
$str
¬¬B E
+
¬¬F G
DocId
¬¬H M
+
¬¬N O
$str
¬¬P S
+
¬¬T U
AttName
¬¬V ]
)
¬¬] ^
;
¬¬^ _
CouchDBResponse
­­ 
couchDBResponse
­­ +
=
­­, -
new
­­. 1
CouchDBResponse
­­2 A
(
­­A B
)
­­B C
;
­­C D
if
®® 
(
®® 
dbResult
®® 
.
®® !
IsSuccessStatusCode
®® ,
)
®®, -
{
¯¯ 
couchDBResponse
±± 
.
±±  
	IsSuccess
±±  )
=
±±* +
true
±±, 0
;
±±0 1
couchDBResponse
²² 
.
²²  
	ImageData
²²  )
=
²²* +
dbResult
²², 4
.
²²4 5
Content
²²5 <
.
²²< ="
ReadAsByteArrayAsync
²²= Q
(
²²Q R
)
²²R S
;
²²S T
return
³³ 
couchDBResponse
³³ &
;
³³& '
}
¶¶ 
couchDBResponse
·· 
.
·· 
	IsSuccess
·· %
=
··& '
false
··( -
;
··- .
couchDBResponse
¸¸ 
.
¸¸ 
Result
¸¸ "
=
¸¸# $
dbResult
¸¸% -
.
¸¸- .
ReasonPhrase
¸¸. :
;
¸¸: ;
return
¹¹ 
couchDBResponse
¹¹ "
;
¹¹" #
}
ºº 	
public
¼¼ 
async
¼¼ 
Task
¼¼ 
<
¼¼ 
dynamic
¼¼ !
>
¼¼! "
UpdateAttachment
¼¼# 3
(
¼¼3 4
CouchDBRequest
¼¼4 B

attachInfo
¼¼C M
)
¼¼M N
{
½½ 	
var
¾¾ 
dbClient
¾¾ 
=
¾¾ 
DbHttpClient
¾¾ '
(
¾¾' (
)
¾¾( )
;
¾¾) *
var
¿¿ 
jsonData
¿¿ 
=
¿¿ 
JsonConvert
¿¿ &
.
¿¿& '
SerializeObject
¿¿' 6
(
¿¿6 7

attachInfo
¿¿7 A
)
¿¿A B
;
¿¿B C
var
ÀÀ 
httpContent
ÀÀ 
=
ÀÀ 
new
ÀÀ !
StringContent
ÀÀ" /
(
ÀÀ/ 0
jsonData
ÀÀ0 8
,
ÀÀ8 9
Encoding
ÀÀ: B
.
ÀÀB C
UTF8
ÀÀC G
,
ÀÀG H
$str
ÀÀI [
)
ÀÀ[ \
;
ÀÀ\ ]
var
ÁÁ 

postResult
ÁÁ 
=
ÁÁ 
await
ÁÁ "
dbClient
ÁÁ# +
.
ÁÁ+ ,
PutAsync
ÁÁ, 4
(
ÁÁ4 5
_couchDbName
ÁÁ5 A
+
ÁÁB C
$str
ÁÁD G
+
ÁÁH I

attachInfo
ÁÁJ T
.
ÁÁT U
Id
ÁÁU W
+
ÁÁX Y
$str
ÁÁZ a
+
ÁÁb c

attachInfo
ÁÁd n
.
ÁÁn o
Rev
ÁÁo r
,
ÁÁr s
httpContent
ÁÁt 
)ÁÁ 
;ÁÁ 
var
ÂÂ 
result
ÂÂ 
=
ÂÂ 
await
ÂÂ 

postResult
ÂÂ )
.
ÂÂ) *
Content
ÂÂ* 1
.
ÂÂ1 2
ReadAsStringAsync
ÂÂ2 C
(
ÂÂC D
)
ÂÂD E
;
ÂÂE F
var
ÃÃ 
	savedInfo
ÃÃ 
=
ÃÃ 
JsonConvert
ÃÃ '
.
ÃÃ' (
DeserializeObject
ÃÃ( 9
<
ÃÃ9 :
CouchDBResponse
ÃÃ: I
>
ÃÃI J
(
ÃÃJ K
result
ÃÃK Q
)
ÃÃQ R
;
ÃÃR S

attachInfo
ÄÄ 
.
ÄÄ 
Id
ÄÄ 
=
ÄÄ 
	savedInfo
ÄÄ %
.
ÄÄ% &
Id
ÄÄ& (
;
ÄÄ( )

attachInfo
ÅÅ 
.
ÅÅ 
Rev
ÅÅ 
=
ÅÅ 
	savedInfo
ÅÅ &
.
ÅÅ& '
Rev
ÅÅ' *
;
ÅÅ* +
var
ÆÆ 
requestContent
ÆÆ 
=
ÆÆ  
new
ÆÆ! $
ByteArrayContent
ÆÆ% 5
(
ÆÆ5 6

attachInfo
ÆÆ6 @
.
ÆÆ@ A
AttachmentData
ÆÆA O
)
ÆÆO P
;
ÆÆP Q
requestContent
ÇÇ 
.
ÇÇ 
Headers
ÇÇ "
.
ÇÇ" #
ContentType
ÇÇ# .
=
ÇÇ/ 0
new
ÇÇ1 4"
MediaTypeHeaderValue
ÇÇ5 I
(
ÇÇI J
$str
ÇÇJ _
)
ÇÇ_ `
;
ÇÇ` a
var
ÈÈ 
	putResult
ÈÈ 
=
ÈÈ 
await
ÈÈ !
dbClient
ÈÈ" *
.
ÈÈ* +
PutAsync
ÈÈ+ 3
(
ÈÈ3 4
_couchDbName
ÈÈ4 @
+
ÈÈA B
$str
ÈÈC F
+
ÈÈG H
	savedInfo
ÈÈI R
.
ÈÈR S
Id
ÈÈS U
+
ÈÈV W
$str
ÈÈX [
+
ÈÈ\ ]

attachInfo
ÈÈ^ h
.
ÈÈh i
FileName
ÈÈi q
+
ÈÈr s
$str
ÈÈt {
+
ÈÈ| }
	savedInfoÈÈ~ 
.ÈÈ 
RevÈÈ 
,ÈÈ 
requestContentÈÈ 
)ÈÈ 
;ÈÈ 
if
ÉÉ 
(
ÉÉ 
	putResult
ÉÉ 
.
ÉÉ !
IsSuccessStatusCode
ÉÉ -
)
ÉÉ- .
{
ÊÊ 
return
ËË 
new
ËË 
{
ÌÌ 
	IsSuccess
ÍÍ 
=
ÍÍ 
true
ÍÍ  $
,
ÍÍ$ %
Result
ÎÎ 
=
ÎÎ 
await
ÎÎ "
	putResult
ÎÎ# ,
.
ÎÎ, -
Content
ÎÎ- 4
.
ÎÎ4 5
ReadAsStringAsync
ÎÎ5 F
(
ÎÎF G
)
ÎÎG H
}
ÏÏ 
;
ÏÏ 
}
ĞĞ 
return
ÑÑ 
new
ÑÑ 
{
ÒÒ 
	IsSuccess
ÓÓ 
=
ÓÓ 
false
ÓÓ !
,
ÓÓ! "
Result
ÔÔ 
=
ÔÔ 
	putResult
ÔÔ "
.
ÔÔ" #
ReasonPhrase
ÔÔ# /
}
ÕÕ 
;
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
static
ÚÚ 
string
ÚÚ 
GetLocalIPAddress
ÚÚ .
(
ÚÚ. /
)
ÚÚ/ 0
{
ÛÛ 	
var
ÜÜ 
host
ÜÜ 
=
ÜÜ 
Dns
ÜÜ 
.
ÜÜ 
GetHostEntry
ÜÜ '
(
ÜÜ' (
Dns
ÜÜ( +
.
ÜÜ+ ,
GetHostName
ÜÜ, 7
(
ÜÜ7 8
)
ÜÜ8 9
)
ÜÜ9 :
;
ÜÜ: ;
foreach
İİ 
(
İİ 
var
İİ 
ip
İİ 
in
İİ 
host
İİ #
.
İİ# $
AddressList
İİ$ /
)
İİ/ 0
{
ŞŞ 
if
ßß 
(
ßß 
ip
ßß 
.
ßß 
AddressFamily
ßß $
==
ßß% '
AddressFamily
ßß( 5
.
ßß5 6
InterNetwork
ßß6 B
)
ßßB C
{
àà 
return
áá 
ip
áá 
.
áá 
ToString
áá &
(
áá& '
)
áá' (
;
áá( )
}
ââ 
}
ãã 
throw
ää 
new
ää 
	Exception
ää 
(
ää  
$str
ää  Y
)
ääY Z
;
ääZ [
}
åå 	
public
ææ 
static
ææ 
string
ææ 
GetHostName
ææ (
(
ææ( )
)
ææ) *
{
çç 	
var
èè 
host
èè 
=
èè 
Dns
èè 
.
èè 
GetHostEntry
èè '
(
èè' (
Dns
èè( +
.
èè+ ,
GetHostName
èè, 7
(
èè7 8
)
èè8 9
)
èè9 :
;
èè: ;
return
éé 
host
éé 
.
éé 
HostName
éé  
;
éé  !
}
êê 	
public
ìì 
static
ìì 
	DataTable
ìì 
ToDataTable
ìì  +
<
ìì+ ,
T
ìì, -
>
ìì- .
(
ìì. /
List
ìì/ 3
<
ìì3 4
T
ìì4 5
>
ìì5 6
items
ìì7 <
)
ìì< =
{
íí 	
	DataTable
îî 
	dataTable
îî 
=
îî  !
new
îî" %
	DataTable
îî& /
(
îî/ 0
typeof
îî0 6
(
îî6 7
T
îî7 8
)
îî8 9
.
îî9 :
Name
îî: >
)
îî> ?
;
îî? @
PropertyInfo
ğğ 
[
ğğ 
]
ğğ 
Props
ğğ  
=
ğğ! "
typeof
ğğ# )
(
ğğ) *
T
ğğ* +
)
ğğ+ ,
.
ğğ, -
GetProperties
ğğ- :
(
ğğ: ;
BindingFlags
ğğ; G
.
ğğG H
Public
ğğH N
|
ğğO P
BindingFlags
ğğQ ]
.
ğğ] ^
Instance
ğğ^ f
)
ğğf g
;
ğğg h
foreach
òò 
(
òò 
PropertyInfo
òò !
prop
òò" &
in
òò' )
Props
òò* /
)
òò/ 0
{
óó 
var
ôô 
type
ôô 
=
ôô 
(
ôô 
prop
ôô  
.
ôô  !
PropertyType
ôô! -
.
ôô- .
IsGenericType
ôô. ;
&&
ôô< >
prop
ôô? C
.
ôôC D
PropertyType
ôôD P
.
ôôP Q&
GetGenericTypeDefinition
ôôQ i
(
ôôi j
)
ôôj k
==
ôôl n
typeof
ôôo u
(
ôôu v
Nullable
ôôv ~
<
ôô~ 
>ôô 
)ôô 
?ôô 
Nullableôô 
.ôô !
GetUnderlyingTypeôô 
(ôô 
propôô £
.ôô£ ¤
PropertyTypeôô¤ °
)ôô° ±
:ôô² ³
propôô´ ¸
.ôô¸ ¹
PropertyTypeôô¹ Å
)ôôÅ Æ
;ôôÆ Ç
	dataTable
öö 
.
öö 
Columns
öö !
.
öö! "
Add
öö" %
(
öö% &
prop
öö& *
.
öö* +
Name
öö+ /
.
öö/ 0
ToLower
öö0 7
(
öö7 8
)
öö8 9
,
öö9 :
type
öö; ?
)
öö? @
;
öö@ A
}
÷÷ 
foreach
øø 
(
øø 
T
øø 
item
øø 
in
øø 
items
øø $
)
øø$ %
{
ùù 
var
úú 
values
úú 
=
úú 
new
úú  
object
úú! '
[
úú' (
Props
úú( -
.
úú- .
Length
úú. 4
]
úú4 5
;
úú5 6
for
ûû 
(
ûû 
int
ûû 
i
ûû 
=
ûû 
$num
ûû 
;
ûû 
i
ûû  !
<
ûû" #
Props
ûû$ )
.
ûû) *
Length
ûû* 0
;
ûû0 1
i
ûû2 3
++
ûû3 5
)
ûû5 6
{
üü 
values
şş 
[
şş 
i
şş 
]
şş 
=
şş 
Props
şş  %
[
şş% &
i
şş& '
]
şş' (
.
şş( )
GetValue
şş) 1
(
şş1 2
item
şş2 6
,
şş6 7
null
şş8 <
)
şş< =
;
şş= >
}
ÿÿ 
	dataTable
 
.
 
Rows
 
.
 
Add
 "
(
" #
values
# )
)
) *
;
* +
}
 
return
 
	dataTable
 
;
 
}
 	
public
 
static
 
string
 

EncryptCRY
 '
(
' (
string
( .
	clearText
/ 8
)
8 9
{
 	
string
 
EncryptionKey
  
=
! "
Convert
# *
.
* +
ToString
+ 3
(
3 4
$str
4 @
)
@ A
;
A B
byte
 
[
 
]
 

clearBytes
 
=
 
Encoding
  (
.
( )
Unicode
) 0
.
0 1
GetBytes
1 9
(
9 :
	clearText
: C
)
C D
;
D E
using
 
(
 
Aes
 
	encryptor
  
=
! "
Aes
# &
.
& '
Create
' -
(
- .
)
. /
)
/ 0
{
  
Rfc2898DeriveBytes
 "
pdb
# &
=
' (
new
) , 
Rfc2898DeriveBytes
- ?
(
? @
EncryptionKey
@ M
,
M N
new
O R
byte
S W
[
W X
]
X Y
{
Z [
$num
 
,
 
$num
 
,
 
$num
 
,
 
$num
 #
,
# $
$num
$ (
,
( )
$num
) -
,
- .
$num
. 2
,
2 3
$num
3 7
,
7 8
$num
8 <
,
< =
$num
= A
,
A B
$num
B F
,
F G
$num
G K
,
K L
$num
L P
}
P Q
)
Q R
;
R S
	encryptor
 
.
 
Key
 
=
 
pdb
  #
.
# $
GetBytes
$ ,
(
, -
$num
- /
)
/ 0
;
0 1
	encryptor
 
.
 
IV
 
=
 
pdb
 "
.
" #
GetBytes
# +
(
+ ,
$num
, .
)
. /
;
/ 0
using
 
(
 
MemoryStream
 #
ms
$ &
=
' (
new
) ,
MemoryStream
- 9
(
9 :
)
: ;
)
; <
{
 
using
 
(
 
CryptoStream
 '
cs
( *
=
+ ,
new
- 0
CryptoStream
1 =
(
= >
ms
> @
,
@ A
	encryptor
B K
.
K L
CreateEncryptor
L [
(
[ \
)
\ ]
,
] ^
CryptoStreamMode
_ o
.
o p
Write
p u
)
u v
)
v w
{
 
cs
 
.
 
Write
  
(
  !

clearBytes
! +
,
+ ,
$num
- .
,
. /

clearBytes
0 :
.
: ;
Length
; A
)
A B
;
B C
cs
 
.
 
Close
  
(
  !
)
! "
;
" #
}
 
	clearText
 
=
 
Convert
  '
.
' (
ToBase64String
( 6
(
6 7
ms
7 9
.
9 :
ToArray
: A
(
A B
)
B C
)
C D
.
D E
Replace
E L
(
L M
$char
M P
,
P Q
$char
R U
)
U V
;
V W
}
 
}
 
return
 
	clearText
 
;
 
}
 	
public
 
static
 
string
 

DecryptCRY
 '
(
' (
string
( .

cipherText
/ 9
)
9 :
{
   	
string
¡¡ 
EncryptionKey
¡¡  
=
¡¡! "
Convert
¡¡# *
.
¡¡* +
ToString
¡¡+ 3
(
¡¡3 4
$str
¡¡4 @
)
¡¡@ A
;
¡¡A B
if
¢¢ 
(
¢¢ 

cipherText
¢¢ 
!=
¢¢ 
null
¢¢ "
)
¢¢" #

cipherText
¢¢$ .
=
¢¢/ 0

cipherText
¢¢1 ;
.
¢¢; <
Replace
¢¢< C
(
¢¢C D
$str
¢¢D G
,
¢¢G H
$str
¢¢I L
)
¢¢L M
.
¢¢M N
Replace
¢¢N U
(
¢¢U V
$char
¢¢V Y
,
¢¢Y Z
$char
¢¢[ ^
)
¢¢^ _
;
¢¢_ `
byte
££ 
[
££ 
]
££ 
cipherBytes
££ 
=
££  
Convert
££! (
.
££( )
FromBase64String
££) 9
(
££9 :

cipherText
££: D
)
££D E
;
££E F
using
¤¤ 
(
¤¤ 
Aes
¤¤ 
	encryptor
¤¤  
=
¤¤! "
Aes
¤¤# &
.
¤¤& '
Create
¤¤' -
(
¤¤- .
)
¤¤. /
)
¤¤/ 0
{
¥¥  
Rfc2898DeriveBytes
¦¦ "
pdb
¦¦# &
=
¦¦' (
new
¦¦) , 
Rfc2898DeriveBytes
¦¦- ?
(
¦¦? @
EncryptionKey
¦¦@ M
,
¦¦M N
new
¦¦O R
byte
¦¦S W
[
¦¦W X
]
¦¦X Y
{
¦¦Z [
$num
§§ 
,
§§ 
$num
§§ 
,
§§ 
$num
§§ 
,
§§ 
$num
§§ #
,
§§# $
$num
§§$ (
,
§§( )
$num
§§) -
,
§§- .
$num
§§. 2
,
§§2 3
$num
§§3 7
,
§§7 8
$num
§§8 <
,
§§< =
$num
§§= A
,
§§A B
$num
§§B F
,
§§F G
$num
§§G K
,
§§K L
$num
§§L P
}
§§P Q
)
§§Q R
;
§§R S
	encryptor
¨¨ 
.
¨¨ 
Key
¨¨ 
=
¨¨ 
pdb
¨¨  #
.
¨¨# $
GetBytes
¨¨$ ,
(
¨¨, -
$num
¨¨- /
)
¨¨/ 0
;
¨¨0 1
	encryptor
©© 
.
©© 
IV
©© 
=
©© 
pdb
©© "
.
©©" #
GetBytes
©©# +
(
©©+ ,
$num
©©, .
)
©©. /
;
©©/ 0
using
ªª 
(
ªª 
MemoryStream
ªª #
ms
ªª$ &
=
ªª' (
new
ªª) ,
MemoryStream
ªª- 9
(
ªª9 :
)
ªª: ;
)
ªª; <
{
«« 
using
¬¬ 
(
¬¬ 
CryptoStream
¬¬ '
cs
¬¬( *
=
¬¬+ ,
new
¬¬- 0
CryptoStream
¬¬1 =
(
¬¬= >
ms
¬¬> @
,
¬¬@ A
	encryptor
¬¬B K
.
¬¬K L
CreateDecryptor
¬¬L [
(
¬¬[ \
)
¬¬\ ]
,
¬¬] ^
CryptoStreamMode
¬¬_ o
.
¬¬o p
Write
¬¬p u
)
¬¬u v
)
¬¬v w
{
­­ 
cs
®® 
.
®® 
Write
®®  
(
®®  !
cipherBytes
®®! ,
,
®®, -
$num
®®. /
,
®®/ 0
cipherBytes
®®1 <
.
®®< =
Length
®®= C
)
®®C D
;
®®D E
cs
¯¯ 
.
¯¯ 
Close
¯¯  
(
¯¯  !
)
¯¯! "
;
¯¯" #
}
°° 

cipherText
±± 
=
±±  
Encoding
±±! )
.
±±) *
Unicode
±±* 1
.
±±1 2
	GetString
±±2 ;
(
±±; <
ms
±±< >
.
±±> ?
ToArray
±±? F
(
±±F G
)
±±G H
)
±±H I
;
±±I J
}
²² 
}
³³ 
return
´´ 

cipherText
´´ 
;
´´ 
}
µµ 	
public
·· 
static
·· 
string
·· 
Encrypt
·· $
(
··$ %
string
··% +
	inputText
··, 5
)
··5 6
{
¸¸ 	
string
¹¹ 
encryptionkey
¹¹  
=
¹¹! "
Convert
¹¹# *
.
¹¹* +
ToString
¹¹+ 3
(
¹¹3 4
$str
¹¹4 @
)
¹¹@ A
;
¹¹A B
byte
ºº 
[
ºº 
]
ºº 
keybytes
ºº 
=
ºº 
Encoding
ºº &
.
ºº& '
ASCII
ºº' ,
.
ºº, -
GetBytes
ºº- 5
(
ºº5 6
encryptionkey
ºº6 C
.
ººC D
Length
ººD J
.
ººJ K
ToString
ººK S
(
ººS T
)
ººT U
)
ººU V
;
ººV W
RijndaelManaged
»» 
rijndaelCipher
»» *
=
»»+ ,
new
»»- 0
RijndaelManaged
»»1 @
(
»»@ A
)
»»A B
;
»»B C
byte
¼¼ 
[
¼¼ 
]
¼¼ 
	plainText
¼¼ 
=
¼¼ 
Encoding
¼¼ '
.
¼¼' (
Unicode
¼¼( /
.
¼¼/ 0
GetBytes
¼¼0 8
(
¼¼8 9
	inputText
¼¼9 B
)
¼¼B C
;
¼¼C D!
PasswordDeriveBytes
½½ 
pwdbytes
½½  (
=
½½) *
new
½½+ .!
PasswordDeriveBytes
½½/ B
(
½½B C
encryptionkey
½½C P
,
½½P Q
keybytes
½½R Z
)
½½Z [
;
½½[ \
using
¾¾ 
(
¾¾ 
ICryptoTransform
¾¾ #
encryptrans
¾¾$ /
=
¾¾0 1
rijndaelCipher
¾¾2 @
.
¾¾@ A
CreateEncryptor
¾¾A P
(
¾¾P Q
pwdbytes
¾¾Q Y
.
¾¾Y Z
GetBytes
¾¾Z b
(
¾¾b c
$num
¾¾c e
)
¾¾e f
,
¾¾f g
pwdbytes
¾¾h p
.
¾¾p q
GetBytes
¾¾q y
(
¾¾y z
$num
¾¾z |
)
¾¾| }
)
¾¾} ~
)
¾¾~ 
{
¿¿ 
using
ÀÀ 
(
ÀÀ 
MemoryStream
ÀÀ #
mstrm
ÀÀ$ )
=
ÀÀ* +
new
ÀÀ, /
MemoryStream
ÀÀ0 <
(
ÀÀ< =
)
ÀÀ= >
)
ÀÀ> ?
{
ÁÁ 
using
ÂÂ 
(
ÂÂ 
CryptoStream
ÂÂ '
cryptstm
ÂÂ( 0
=
ÂÂ1 2
new
ÂÂ3 6
CryptoStream
ÂÂ7 C
(
ÂÂC D
mstrm
ÂÂD I
,
ÂÂI J
encryptrans
ÂÂK V
,
ÂÂV W
CryptoStreamMode
ÂÂX h
.
ÂÂh i
Write
ÂÂi n
)
ÂÂn o
)
ÂÂo p
{
ÃÃ 
cryptstm
ÄÄ  
.
ÄÄ  !
Write
ÄÄ! &
(
ÄÄ& '
	plainText
ÄÄ' 0
,
ÄÄ0 1
$num
ÄÄ2 3
,
ÄÄ3 4
	plainText
ÄÄ5 >
.
ÄÄ> ?
Length
ÄÄ? E
)
ÄÄE F
;
ÄÄF G
cryptstm
ÅÅ  
.
ÅÅ  !
Close
ÅÅ! &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
return
ÆÆ 
Convert
ÆÆ &
.
ÆÆ& '
ToBase64String
ÆÆ' 5
(
ÆÆ5 6
mstrm
ÆÆ6 ;
.
ÆÆ; <
ToArray
ÆÆ< C
(
ÆÆC D
)
ÆÆD E
)
ÆÆE F
;
ÆÆF G
}
ÇÇ 
}
ÈÈ 
}
ÉÉ 
}
ÊÊ 	
public
ËË 
static
ËË 
string
ËË 
Decrypt
ËË $
(
ËË$ %
string
ËË% +
encryptText
ËË, 7
)
ËË7 8
{
ÌÌ 	
string
ÍÍ 
encryptionkey
ÍÍ  
=
ÍÍ! "
Convert
ÍÍ# *
.
ÍÍ* +
ToString
ÍÍ+ 3
(
ÍÍ3 4
$str
ÍÍ4 @
)
ÍÍ@ A
;
ÍÍA B
byte
ÎÎ 
[
ÎÎ 
]
ÎÎ 
keybytes
ÎÎ 
=
ÎÎ 
Encoding
ÎÎ &
.
ÎÎ& '
ASCII
ÎÎ' ,
.
ÎÎ, -
GetBytes
ÎÎ- 5
(
ÎÎ5 6
encryptionkey
ÎÎ6 C
.
ÎÎC D
Length
ÎÎD J
.
ÎÎJ K
ToString
ÎÎK S
(
ÎÎS T
)
ÎÎT U
)
ÎÎU V
;
ÎÎV W
RijndaelManaged
ÏÏ 
rijndaelCipher
ÏÏ *
=
ÏÏ+ ,
new
ÏÏ- 0
RijndaelManaged
ÏÏ1 @
(
ÏÏ@ A
)
ÏÏA B
;
ÏÏB C
byte
ĞĞ 
[
ĞĞ 
]
ĞĞ 
encryptedData
ĞĞ  
=
ĞĞ! "
Convert
ĞĞ# *
.
ĞĞ* +
FromBase64String
ĞĞ+ ;
(
ĞĞ; <
encryptText
ĞĞ< G
.
ĞĞG H
Replace
ĞĞH O
(
ĞĞO P
$str
ĞĞP S
,
ĞĞS T
$str
ĞĞU X
)
ĞĞX Y
)
ĞĞY Z
;
ĞĞZ [!
PasswordDeriveBytes
ÑÑ 
pwdbytes
ÑÑ  (
=
ÑÑ) *
new
ÑÑ+ .!
PasswordDeriveBytes
ÑÑ/ B
(
ÑÑB C
encryptionkey
ÑÑC P
,
ÑÑP Q
keybytes
ÑÑR Z
)
ÑÑZ [
;
ÑÑ[ \
using
ÒÒ 
(
ÒÒ 
ICryptoTransform
ÒÒ #
decryptrans
ÒÒ$ /
=
ÒÒ0 1
rijndaelCipher
ÒÒ2 @
.
ÒÒ@ A
CreateDecryptor
ÒÒA P
(
ÒÒP Q
pwdbytes
ÒÒQ Y
.
ÒÒY Z
GetBytes
ÒÒZ b
(
ÒÒb c
$num
ÒÒc e
)
ÒÒe f
,
ÒÒf g
pwdbytes
ÒÒh p
.
ÒÒp q
GetBytes
ÒÒq y
(
ÒÒy z
$num
ÒÒz |
)
ÒÒ| }
)
ÒÒ} ~
)
ÒÒ~ 
{
ÓÓ 
using
ÔÔ 
(
ÔÔ 
MemoryStream
ÔÔ #
mstrm
ÔÔ$ )
=
ÔÔ* +
new
ÔÔ, /
MemoryStream
ÔÔ0 <
(
ÔÔ< =
encryptedData
ÔÔ= J
)
ÔÔJ K
)
ÔÔK L
{
ÕÕ 
using
ÖÖ 
(
ÖÖ 
CryptoStream
ÖÖ '
cryptstm
ÖÖ( 0
=
ÖÖ1 2
new
ÖÖ3 6
CryptoStream
ÖÖ7 C
(
ÖÖC D
mstrm
ÖÖD I
,
ÖÖI J
decryptrans
ÖÖK V
,
ÖÖV W
CryptoStreamMode
ÖÖX h
.
ÖÖh i
Read
ÖÖi m
)
ÖÖm n
)
ÖÖn o
{
×× 
byte
ØØ 
[
ØØ 
]
ØØ 
	plainText
ØØ (
=
ØØ) *
new
ØØ+ .
byte
ØØ/ 3
[
ØØ3 4
encryptedData
ØØ4 A
.
ØØA B
Length
ØØB H
]
ØØH I
;
ØØI J
int
ÙÙ 
decryptedCount
ÙÙ *
=
ÙÙ+ ,
cryptstm
ÙÙ- 5
.
ÙÙ5 6
Read
ÙÙ6 :
(
ÙÙ: ;
	plainText
ÙÙ; D
,
ÙÙD E
$num
ÙÙF G
,
ÙÙG H
	plainText
ÙÙI R
.
ÙÙR S
Length
ÙÙS Y
)
ÙÙY Z
;
ÙÙZ [
return
ÚÚ 
Encoding
ÚÚ '
.
ÚÚ' (
Unicode
ÚÚ( /
.
ÚÚ/ 0
	GetString
ÚÚ0 9
(
ÚÚ9 :
	plainText
ÚÚ: C
,
ÚÚC D
$num
ÚÚE F
,
ÚÚF G
decryptedCount
ÚÚH V
)
ÚÚV W
;
ÚÚW X
}
ÛÛ 
}
İİ 
}
ŞŞ 
}
ßß 	
public
áá 
static
áá 
string
áá 

MaskString
áá '
(
áá' (
string
áá( .
	plainText
áá/ 8
)
áá8 9
{
ââ 	
if
ãã 
(
ãã 
	plainText
ãã 
!=
ãã 
null
ãã !
&&
ãã" $
	plainText
ãã% .
!=
ãã/ 1
$str
ãã2 4
)
ãã4 5
{
ää 
var
èè 

lastDigits
èè 
=
èè  
	plainText
èè! *
.
èè* +
	Substring
èè+ 4
(
èè4 5
	plainText
èè5 >
.
èè> ?
Length
èè? E
-
èèF G
$num
èèH I
,
èèI J
$num
èèK L
)
èèL M
;
èèM N
var
êê 
requiredMask
êê  
=
êê! "
new
êê# &
String
êê' -
(
êê- .
$char
êê. 1
,
êê1 2
	plainText
êê3 <
.
êê< =
Length
êê= C
-
êêD E

lastDigits
êêF P
.
êêP Q
Length
êêQ W
)
êêW X
;
êêX Y
var
ìì 
maskedString
ìì  
=
ìì! "
string
ìì# )
.
ìì) *
Concat
ìì* 0
(
ìì0 1
requiredMask
ìì1 =
,
ìì= >

lastDigits
ìì? I
)
ììI J
;
ììJ K
var
íí (
maskedCardNumberWithSpaces
íí .
=
íí/ 0
Regex
íí1 6
.
íí6 7
Replace
íí7 >
(
íí> ?
maskedString
íí? K
,
ííK L
$str
ííM S
,
ííS T
$str
ííU Z
)
ííZ [
;
íí[ \
return
îî (
maskedCardNumberWithSpaces
îî 1
;
îî1 2
}
ïï 
else
ğğ 
{
ññ 
return
òò 
$str
òò 
;
òò 
}
óó 
}
ôô 	
public
÷÷ 
static
÷÷ 
byte
÷÷ 
[
÷÷ 
]
÷÷ !
GenerateReportExcel
÷÷ 0
(
÷÷0 1
DataSet
÷÷1 8
ds
÷÷9 ;
,
÷÷; <
string
÷÷= C
RootPath
÷÷D L
,
÷÷L M
string
÷÷N T
RDLCFileName
÷÷U a
,
÷÷a b
string
÷÷c i

ReportName
÷÷j t
,
÷÷t u
string
÷÷v |
FileType÷÷} 
,÷÷ 
bool÷÷ 
	IsRunTime÷÷ 
,÷÷ 
string÷÷ 

reportPara÷÷ ¨
=÷÷© ª
$str÷÷« ­
)÷÷­ ®
{
øø 	
try
 
{
 
string
 
path
 
=
 
$str
  
;
  !
string
 

reportName
 !
=
" #
$str
$ 0
;
0 1
string
 

reportPath
 !
=
" #
string
$ *
.
* +
Empty
+ 0
;
0 1
if
 
(
 
OperatingSystem
 #
.
# $
	IsWindows
$ -
(
- .
)
. /
)
/ 0

reportPath
 
=
  
RootPath
! )
+
* +
$str
, 9
+
: ;
RDLCFileName
< H
;
H I
else
 
if
 
(
 
OperatingSystem
 (
.
( )
IsLinux
) 0
(
0 1
)
1 2
)
2 3

reportPath
 
=
  
RootPath
! )
+
* +
$str
, 9
+
: ;
RDLCFileName
< H
;
H I
else
 
{
 

reportPath
 
=
  
$str
! #
;
# $
}
 
Warning
 
[
 
]
 
warnings
 "
;
" #
string
 
[
 
]
 
	streamIds
 "
;
" #
string
 
mimeType
 
=
  !
string
" (
.
( )
Empty
) .
;
. /
string
 
encoding
 
=
  !
string
" (
.
( )
Empty
) .
;
. /
string
 

extension1
 !
=
" #
string
$ *
.
* +
Empty
+ 0
;
0 1
Stream
 
reportDefinition
 '
;
' (
using
 
var
 
fs
 
=
 
new
 "

FileStream
# -
(
- .

reportPath
. 8
,
8 9
FileMode
: B
.
B C
Open
C G
)
G H
;
H I
reportDefinition
  
=
! "
fs
# %
;
% &
LocalReport
 
report
 "
=
# $
new
% (
LocalReport
) 4
(
4 5
)
5 6
;
6 7
report
 
.
 "
EnableExternalImages
 +
=
, -
true
. 2
;
2 3
report
   
.
   "
LoadReportDefinition
   +
(
  + ,
reportDefinition
  , <
)
  < =
;
  = >
if
¢¢ 
(
¢¢ 
ds
¢¢ 
.
¢¢ 
Tables
¢¢ 
.
¢¢ 
Count
¢¢ #
>
¢¢$ %
$num
¢¢& '
)
¢¢' (
{
££ 
if
¤¤ 
(
¤¤ 
!
¤¤ 
string
¤¤ 
.
¤¤  
IsNullOrEmpty
¤¤  -
(
¤¤- .

reportPara
¤¤. 8
)
¤¤8 9
)
¤¤9 :
{
¥¥ 
ReportParameter
¦¦ '
[
¦¦' (
]
¦¦( )

parameters
¦¦* 4
=
¦¦5 6
new
¦¦7 :
ReportParameter
¦¦; J
[
¦¦J K
$num
¦¦K L
]
¦¦L M
;
¦¦M N

parameters
¨¨ "
[
¨¨" #
$num
¨¨# $
]
¨¨$ %
=
¨¨& '
new
¨¨( +
ReportParameter
¨¨, ;
(
¨¨; <
$str
¨¨< I
,
¨¨I J

reportPara
¨¨K U
)
¨¨U V
;
¨¨V W
report
©© 
.
©© 
SetParameters
©© ,
(
©©, -

parameters
©©- 7
)
©©7 8
;
©©8 9
}
ªª 
for
«« 
(
«« 
int
«« 
i
«« 
=
««  
$num
««! "
;
««" #
i
««$ %
<
««& '
ds
««( *
.
««* +
Tables
««+ 1
.
««1 2
Count
««2 7
;
««7 8
i
««9 :
++
««: <
)
««< =
{
¬¬ 
if
­­ 
(
­­ 
i
­­ 
==
­­  
$num
­­! "
)
­­" #
{
®® 
ReportDataSource
¯¯ ,

datasource
¯¯- 7
=
¯¯8 9
new
¯¯: =
ReportDataSource
¯¯> N
(
¯¯N O
$str
¯¯O X
,
¯¯X Y
ds
¯¯Z \
.
¯¯\ ]
Tables
¯¯] c
[
¯¯c d
$num
¯¯d e
]
¯¯e f
)
¯¯f g
;
¯¯g h
report
°° "
.
°°" #
DataSources
°°# .
.
°°. /
Add
°°/ 2
(
°°2 3

datasource
°°3 =
)
°°= >
;
°°> ?
}
±± 
else
²² 
{
³³ 
ReportDataSource
´´ ,

datasource
´´- 7
=
´´8 9
new
´´: =
ReportDataSource
´´> N
(
´´N O
$str
´´O X
+
´´Y Z
i
´´[ \
+
´´] ^
$str
´´_ a
,
´´a b
ds
´´c e
.
´´e f
Tables
´´f l
[
´´l m
i
´´m n
]
´´n o
)
´´o p
;
´´p q
report
µµ "
.
µµ" #
DataSources
µµ# .
.
µµ. /
Add
µµ/ 2
(
µµ2 3

datasource
µµ3 =
)
µµ= >
;
µµ> ?
}
¶¶ 
}
·· 
}
¸¸ 
byte
ÀÀ 
[
ÀÀ 
]
ÀÀ 
bytes
ÀÀ 
=
ÀÀ 
report
ÀÀ %
.
ÀÀ% &
Render
ÀÀ& ,
(
ÀÀ, -
FileType
ÀÀ- 5
,
ÀÀ5 6
null
ÀÀ7 ;
,
ÀÀ; <
out
ÀÀ= @
mimeType
ÀÀA I
,
ÀÀI J
out
ÀÀK N
encoding
ÀÀO W
,
ÀÀW X
out
ÀÀY \

extension1
ÀÀ] g
,
ÀÀg h
out
ÀÀi l
	streamIds
ÀÀm v
,
ÀÀv w
out
ÀÀx {
warningsÀÀ| 
)ÀÀ 
;ÀÀ 
fs
ÅÅ 
.
ÅÅ 
Dispose
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
if
ÇÇ 
(
ÇÇ 
	IsRunTime
ÇÇ 
==
ÇÇ  
false
ÇÇ! &
)
ÇÇ& '
{
ÈÈ 
string
ÊÊ 
filename
ÊÊ #
=
ÊÊ$ %
string
ÊÊ& ,
.
ÊÊ, -
Empty
ÊÊ- 2
;
ÊÊ2 3
if
ËË 
(
ËË 
OperatingSystem
ËË '
.
ËË' (
	IsWindows
ËË( 1
(
ËË1 2
)
ËË2 3
)
ËË3 4
filename
ÌÌ  
=
ÌÌ! "
Path
ÌÌ# '
.
ÌÌ' (
Combine
ÌÌ( /
(
ÌÌ/ 0
RootPath
ÌÌ0 8
+
ÌÌ9 :
$str
ÌÌ; H
,
ÌÌH I
RDLCFileName
ÌÌJ V
)
ÌÌV W
;
ÌÌW X
else
ÍÍ 
if
ÍÍ 
(
ÍÍ 
OperatingSystem
ÍÍ ,
.
ÍÍ, -
IsLinux
ÍÍ- 4
(
ÍÍ4 5
)
ÍÍ5 6
)
ÍÍ6 7
filename
ÎÎ  
=
ÎÎ! "
Path
ÎÎ# '
.
ÎÎ' (
Combine
ÎÎ( /
(
ÎÎ/ 0
RootPath
ÎÎ0 8
+
ÎÎ9 :
$str
ÎÎ; H
,
ÎÎH I
RDLCFileName
ÎÎJ V
)
ÎÎV W
;
ÎÎW X
else
ÏÏ 
{
ĞĞ 
filename
ÑÑ  
=
ÑÑ! "
$str
ÑÑ# %
;
ÑÑ% &
}
ÒÒ 
using
ÔÔ 
(
ÔÔ 
var
ÔÔ 
fstream
ÔÔ &
=
ÔÔ' (
new
ÔÔ) ,

FileStream
ÔÔ- 7
(
ÔÔ7 8
filename
ÔÔ8 @
,
ÔÔ@ A
FileMode
ÔÔB J
.
ÔÔJ K
Create
ÔÔK Q
)
ÔÔQ R
)
ÔÔR S
{
ÕÕ 
fstream
ÖÖ 
.
ÖÖ  
Write
ÖÖ  %
(
ÖÖ% &
bytes
ÖÖ& +
,
ÖÖ+ ,
$num
ÖÖ- .
,
ÖÖ. /
bytes
ÖÖ0 5
.
ÖÖ5 6
Length
ÖÖ6 <
)
ÖÖ< =
;
ÖÖ= >
fstream
×× 
.
××  
Close
××  %
(
××% &
)
××& '
;
××' (
}
ØØ 
return
ÙÙ 
bytes
ÙÙ  
;
ÙÙ  !
}
ÚÚ 
else
ÛÛ 
{
ÜÜ 
return
İİ 
bytes
İİ  
;
İİ  !
}
ŞŞ 
}
ßß 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
áá 
throw
ææ 
ex
ææ 
;
ææ 
}
èè 
finally
éé 
{
éé 
}
éé 
}
êê 	
public
ìì 
static
ìì 
byte
ìì 
[
ìì 
]
ìì %
TestGenerateReportExcel
ìì 4
(
ìì4 5
DataSet
ìì5 <
ds
ìì= ?
,
ìì? @
string
ììA G
RootPath
ììH P
,
ììP Q
string
ììR X
RDLCFileName
ììY e
,
ììe f
string
ììg m

ReportName
ììn x
,
ììx y
stringììz 
FileTypeìì 
,ìì 
boolìì 
	IsRunTimeìì 
,ìì 
stringìì ¡

reportParaìì¢ ¬
=ìì­ ®
$strìì¯ ±
)ìì± ²
{
íí 	
try
îî 
{
ïï 
string
ññ 
path
ññ 
=
ññ 
$str
ññ  
;
ññ  !
string
òò 

reportName
òò !
=
òò" #
$str
òò$ 0
;
òò0 1
string
õõ 

reportPath
õõ !
=
õõ" #
string
õõ$ *
.
õõ* +
Empty
õõ+ 0
;
õõ0 1
if
öö 
(
öö 
OperatingSystem
öö #
.
öö# $
	IsWindows
öö$ -
(
öö- .
)
öö. /
)
öö/ 0

reportPath
÷÷ 
=
÷÷  
RootPath
÷÷! )
+
÷÷* +
$str
÷÷, 9
+
÷÷: ;
RDLCFileName
÷÷< H
;
÷÷H I
else
øø 
if
øø 
(
øø 
OperatingSystem
øø (
.
øø( )
IsLinux
øø) 0
(
øø0 1
)
øø1 2
)
øø2 3

reportPath
ùù 
=
ùù  
RootPath
ùù! )
+
ùù* +
$str
ùù, 9
+
ùù: ;
RDLCFileName
ùù< H
;
ùùH I
else
úú 
{
ûû 

reportPath
üü 
=
üü  
$str
üü! #
;
üü# $
}
ıı 
Warning
ÿÿ 
[
ÿÿ 
]
ÿÿ 
warnings
ÿÿ "
;
ÿÿ" #
string
 
[
 
]
 
	streamIds
 "
;
" #
string
 
mimeType
 
=
  !
string
" (
.
( )
Empty
) .
;
. /
string
 
encoding
 
=
  !
string
" (
.
( )
Empty
) .
;
. /
string
 

extension1
 !
=
" #
string
$ *
.
* +
Empty
+ 0
;
0 1
Stream
 
reportDefinition
 '
;
' (
using
 
var
 
fs
 
=
 
new
 "

FileStream
# -
(
- .

reportPath
. 8
,
8 9
FileMode
: B
.
B C
Open
C G
)
G H
;
H I
reportDefinition
  
=
! "
fs
# %
;
% &
LocalReport
 
report
 "
=
# $
new
% (
LocalReport
) 4
(
4 5
)
5 6
;
6 7
report
 
.
 "
EnableExternalImages
 +
=
, -
true
. 2
;
2 3
report
 
.
 "
LoadReportDefinition
 +
(
+ ,
reportDefinition
, <
)
< =
;
= >
byte
 
[
 
]
 
bytes
 
=
 
report
 %
.
% &
Render
& ,
(
, -
FileType
- 5
,
5 6
null
7 ;
,
; <
out
= @
mimeType
A I
,
I J
out
K N
encoding
O W
,
W X
out
Y \

extension1
] g
,
g h
out
i l
	streamIds
m v
,
v w
out
x {
warnings| 
) 
; 
fs
 
.
 
Dispose
 
(
 
)
 
;
 
if
 
(
 
	IsRunTime
 
==
  
false
! &
)
& '
{
 
string
 
filename
 #
=
$ %
string
& ,
.
, -
Empty
- 2
;
2 3
if
 
(
 
OperatingSystem
 '
.
' (
	IsWindows
( 1
(
1 2
)
2 3
)
3 4
filename
  
=
! "
Path
# '
.
' (
Combine
( /
(
/ 0
RootPath
0 8
+
9 :
$str
; H
,
H I
RDLCFileName
J V
)
V W
;
W X
else
 
if
 
(
 
OperatingSystem
 ,
.
, -
IsLinux
- 4
(
4 5
)
5 6
)
6 7
filename
  
=
! "
Path
# '
.
' (
Combine
( /
(
/ 0
RootPath
0 8
+
9 :
$str
; H
,
H I
RDLCFileName
J V
)
V W
;
W X
else
 
{
 
filename
  
=
! "
$str
# %
;
% &
}
 
using
 
(
 
var
 
fstream
 &
=
' (
new
) ,

FileStream
- 7
(
7 8
filename
8 @
,
@ A
FileMode
B J
.
J K
Create
K Q
)
Q R
)
R S
{
 
fstream
 
.
  
Write
  %
(
% &
bytes
& +
,
+ ,
$num
- .
,
. /
bytes
0 5
.
5 6
Length
6 <
)
< =
;
= >
fstream
   
.
    
Close
    %
(
  % &
)
  & '
;
  ' (
}
¡¡ 
return
¢¢ 
bytes
¢¢  
;
¢¢  !
}
££ 
else
¤¤ 
{
¥¥ 
return
¦¦ 
bytes
¦¦  
;
¦¦  !
}
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
throw
«« 
ex
«« 
;
«« 
}
¬¬ 
finally
­­ 
{
­­ 
}
­­ 
}
®® 	
public
³³ 
static
³³ 
byte
³³ 
[
³³ 
]
³³ 
ExportToCSV
³³ (
(
³³( )
	DataTable
³³) 2

exportData
³³3 =
,
³³= >
string
³³? E
	tableName
³³F O
,
³³O P
bool
³³Q U
headerRequired
³³V d
=
³³e f
true
³³g k
)
³³k l
{
´´ 	
using
µµ 
(
µµ 

XLWorkbook
µµ 
wb
µµ  
=
µµ! "
new
µµ# &

XLWorkbook
µµ' 1
(
µµ1 2
)
µµ2 3
)
µµ3 4
{
¶¶ 

exportData
·· 
.
·· 
	TableName
·· $
=
··% &
	tableName
··' 0
;
··0 1
var
¸¸ 
ws
¸¸ 
=
¸¸ 
wb
¸¸ 
.
¸¸ 

Worksheets
¸¸ &
.
¸¸& '
Add
¸¸' *
(
¸¸* +

exportData
¸¸+ 5
)
¸¸5 6
;
¸¸6 7
if
ºº 
(
ºº 
!
ºº 
headerRequired
ºº #
)
ºº# $
{
»» 
ws
ÁÁ 
.
ÁÁ 
Range
ÁÁ 
(
ÁÁ 
$str
ÁÁ !
,
ÁÁ! "
$str
ÁÁ# '
)
ÁÁ' (
.
ÁÁ( )
Delete
ÁÁ) /
(
ÁÁ/ 0!
XLShiftDeletedCells
ÁÁ0 C
.
ÁÁC D
ShiftCellsUp
ÁÁD P
)
ÁÁP Q
;
ÁÁQ R
ws
ÂÂ 
.
ÂÂ 
Range
ÂÂ 
(
ÂÂ 
$str
ÂÂ !
,
ÂÂ! "
$str
ÂÂ# '
)
ÂÂ' (
.
ÂÂ( )
Delete
ÂÂ) /
(
ÂÂ/ 0!
XLShiftDeletedCells
ÂÂ0 C
.
ÂÂC D
ShiftCellsUp
ÂÂD P
)
ÂÂP Q
;
ÂÂQ R
ws
ÃÃ 
.
ÃÃ 
Range
ÃÃ 
(
ÃÃ 
$str
ÃÃ !
,
ÃÃ! "
$str
ÃÃ# '
)
ÃÃ' (
.
ÃÃ( )
Delete
ÃÃ) /
(
ÃÃ/ 0!
XLShiftDeletedCells
ÃÃ0 C
.
ÃÃC D
ShiftCellsUp
ÃÃD P
)
ÃÃP Q
;
ÃÃQ R
ws
ÄÄ 
.
ÄÄ 
Range
ÄÄ 
(
ÄÄ 
$str
ÄÄ !
,
ÄÄ! "
$str
ÄÄ# '
)
ÄÄ' (
.
ÄÄ( )
Delete
ÄÄ) /
(
ÄÄ/ 0!
XLShiftDeletedCells
ÄÄ0 C
.
ÄÄC D
ShiftCellsUp
ÄÄD P
)
ÄÄP Q
;
ÄÄQ R
ws
ÅÅ 
.
ÅÅ 
Range
ÅÅ 
(
ÅÅ 
$str
ÅÅ !
,
ÅÅ! "
$str
ÅÅ# '
)
ÅÅ' (
.
ÅÅ( )
Delete
ÅÅ) /
(
ÅÅ/ 0!
XLShiftDeletedCells
ÅÅ0 C
.
ÅÅC D
ShiftCellsUp
ÅÅD P
)
ÅÅP Q
;
ÅÅQ R
ws
ÆÆ 
.
ÆÆ 
Range
ÆÆ 
(
ÆÆ 
$str
ÆÆ !
,
ÆÆ! "
$str
ÆÆ# '
)
ÆÆ' (
.
ÆÆ( )
Delete
ÆÆ) /
(
ÆÆ/ 0!
XLShiftDeletedCells
ÆÆ0 C
.
ÆÆC D
ShiftCellsUp
ÆÆD P
)
ÆÆP Q
;
ÆÆQ R
ws
ÇÇ 
.
ÇÇ 
Range
ÇÇ 
(
ÇÇ 
$str
ÇÇ !
,
ÇÇ! "
$str
ÇÇ# '
)
ÇÇ' (
.
ÇÇ( )
Delete
ÇÇ) /
(
ÇÇ/ 0!
XLShiftDeletedCells
ÇÇ0 C
.
ÇÇC D
ShiftCellsUp
ÇÇD P
)
ÇÇP Q
;
ÇÇQ R
ws
ÈÈ 
.
ÈÈ 
Range
ÈÈ 
(
ÈÈ 
$str
ÈÈ !
,
ÈÈ! "
$str
ÈÈ# '
)
ÈÈ' (
.
ÈÈ( )
Delete
ÈÈ) /
(
ÈÈ/ 0!
XLShiftDeletedCells
ÈÈ0 C
.
ÈÈC D
ShiftCellsUp
ÈÈD P
)
ÈÈP Q
;
ÈÈQ R
ws
ÉÉ 
.
ÉÉ 
Range
ÉÉ 
(
ÉÉ 
$str
ÉÉ !
,
ÉÉ! "
$str
ÉÉ# '
)
ÉÉ' (
.
ÉÉ( )
Delete
ÉÉ) /
(
ÉÉ/ 0!
XLShiftDeletedCells
ÉÉ0 C
.
ÉÉC D
ShiftCellsUp
ÉÉD P
)
ÉÉP Q
;
ÉÉQ R
ws
ÊÊ 
.
ÊÊ 
Range
ÊÊ 
(
ÊÊ 
$str
ÊÊ !
,
ÊÊ! "
$str
ÊÊ# '
)
ÊÊ' (
.
ÊÊ( )
Delete
ÊÊ) /
(
ÊÊ/ 0!
XLShiftDeletedCells
ÊÊ0 C
.
ÊÊC D
ShiftCellsUp
ÊÊD P
)
ÊÊP Q
;
ÊÊQ R
ws
ËË 
.
ËË 
Range
ËË 
(
ËË 
$str
ËË !
,
ËË! "
$str
ËË# '
)
ËË' (
.
ËË( )
Delete
ËË) /
(
ËË/ 0!
XLShiftDeletedCells
ËË0 C
.
ËËC D
ShiftCellsUp
ËËD P
)
ËËP Q
;
ËËQ R
ws
ÌÌ 
.
ÌÌ 
Range
ÌÌ 
(
ÌÌ 
$str
ÌÌ !
,
ÌÌ! "
$str
ÌÌ# '
)
ÌÌ' (
.
ÌÌ( )
Delete
ÌÌ) /
(
ÌÌ/ 0!
XLShiftDeletedCells
ÌÌ0 C
.
ÌÌC D
ShiftCellsUp
ÌÌD P
)
ÌÌP Q
;
ÌÌQ R
ws
ÍÍ 
.
ÍÍ 
Table
ÍÍ 
(
ÍÍ 
$num
ÍÍ 
)
ÍÍ 
.
ÍÍ  
Theme
ÍÍ  %
=
ÍÍ& '
XLTableTheme
ÍÍ( 4
.
ÍÍ4 5
None
ÍÍ5 9
;
ÍÍ9 :
}
ÎÎ 
ws
ÏÏ 
.
ÏÏ 
Tables
ÏÏ 
.
ÏÏ 
FirstOrDefault
ÏÏ (
(
ÏÏ( )
)
ÏÏ) *
.
ÏÏ* +
ShowAutoFilter
ÏÏ+ 9
=
ÏÏ: ;
false
ÏÏ< A
;
ÏÏA B
ws
ÓÓ 
.
ÓÓ 
	CellsUsed
ÓÓ 
(
ÓÓ 
)
ÓÓ 
.
ÓÓ 
Style
ÓÓ $
.
ÓÓ$ %
Border
ÓÓ% +
.
ÓÓ+ ,
BottomBorder
ÓÓ, 8
=
ÓÓ9 :
	ClosedXML
ÓÓ; D
.
ÓÓD E
Excel
ÓÓE J
.
ÓÓJ K!
XLBorderStyleValues
ÓÓK ^
.
ÓÓ^ _
Thin
ÓÓ_ c
;
ÓÓc d
ws
ÔÔ 
.
ÔÔ 
	CellsUsed
ÔÔ 
(
ÔÔ 
)
ÔÔ 
.
ÔÔ 
Style
ÔÔ $
.
ÔÔ$ %
Border
ÔÔ% +
.
ÔÔ+ ,
BottomBorderColor
ÔÔ, =
=
ÔÔ> ?
	ClosedXML
ÔÔ@ I
.
ÔÔI J
Excel
ÔÔJ O
.
ÔÔO P
XLColor
ÔÔP W
.
ÔÔW X
Black
ÔÔX ]
;
ÔÔ] ^
ws
ÕÕ 
.
ÕÕ 
	CellsUsed
ÕÕ 
(
ÕÕ 
)
ÕÕ 
.
ÕÕ 
Style
ÕÕ $
.
ÕÕ$ %
Border
ÕÕ% +
.
ÕÕ+ ,
	TopBorder
ÕÕ, 5
=
ÕÕ6 7
	ClosedXML
ÕÕ8 A
.
ÕÕA B
Excel
ÕÕB G
.
ÕÕG H!
XLBorderStyleValues
ÕÕH [
.
ÕÕ[ \
Thin
ÕÕ\ `
;
ÕÕ` a
ws
ÖÖ 
.
ÖÖ 
	CellsUsed
ÖÖ 
(
ÖÖ 
)
ÖÖ 
.
ÖÖ 
Style
ÖÖ $
.
ÖÖ$ %
Border
ÖÖ% +
.
ÖÖ+ ,
TopBorderColor
ÖÖ, :
=
ÖÖ; <
	ClosedXML
ÖÖ= F
.
ÖÖF G
Excel
ÖÖG L
.
ÖÖL M
XLColor
ÖÖM T
.
ÖÖT U
Black
ÖÖU Z
;
ÖÖZ [
ws
×× 
.
×× 
	CellsUsed
×× 
(
×× 
)
×× 
.
×× 
Style
×× $
.
××$ %
Border
××% +
.
××+ ,

LeftBorder
××, 6
=
××7 8
	ClosedXML
××9 B
.
××B C
Excel
××C H
.
××H I!
XLBorderStyleValues
××I \
.
××\ ]
Thin
××] a
;
××a b
ws
ØØ 
.
ØØ 
	CellsUsed
ØØ 
(
ØØ 
)
ØØ 
.
ØØ 
Style
ØØ $
.
ØØ$ %
Border
ØØ% +
.
ØØ+ ,
LeftBorderColor
ØØ, ;
=
ØØ< =
	ClosedXML
ØØ> G
.
ØØG H
Excel
ØØH M
.
ØØM N
XLColor
ØØN U
.
ØØU V
Black
ØØV [
;
ØØ[ \
ws
ÙÙ 
.
ÙÙ 
	CellsUsed
ÙÙ 
(
ÙÙ 
)
ÙÙ 
.
ÙÙ 
Style
ÙÙ $
.
ÙÙ$ %
Border
ÙÙ% +
.
ÙÙ+ ,
RightBorder
ÙÙ, 7
=
ÙÙ8 9
	ClosedXML
ÙÙ: C
.
ÙÙC D
Excel
ÙÙD I
.
ÙÙI J!
XLBorderStyleValues
ÙÙJ ]
.
ÙÙ] ^
Thin
ÙÙ^ b
;
ÙÙb c
ws
ÚÚ 
.
ÚÚ 
	CellsUsed
ÚÚ 
(
ÚÚ 
)
ÚÚ 
.
ÚÚ 
Style
ÚÚ $
.
ÚÚ$ %
Border
ÚÚ% +
.
ÚÚ+ ,
RightBorderColor
ÚÚ, <
=
ÚÚ= >
	ClosedXML
ÚÚ? H
.
ÚÚH I
Excel
ÚÚI N
.
ÚÚN O
XLColor
ÚÚO V
.
ÚÚV W
Black
ÚÚW \
;
ÚÚ\ ]
using
àà 
(
àà 
MemoryStream
àà #
stream
àà$ *
=
àà+ ,
new
àà- 0
MemoryStream
àà1 =
(
àà= >
)
àà> ?
)
àà? @
{
áá 
wb
ââ 
.
ââ 
SaveAs
ââ 
(
ââ 
stream
ââ $
)
ââ$ %
;
ââ% &
return
ãã 
stream
ãã !
.
ãã! "
ToArray
ãã" )
(
ãã) *
)
ãã* +
;
ãã+ ,
}
ää 
}
ææ 
}
èè 	
public
êê 
static
êê 
byte
êê 
[
êê 
]
êê #
ExportToCSVUsingComma
êê 2
(
êê2 3
	DataTable
êê3 <
dt
êê= ?
)
êê? @
{
ëë 	
Log
ìì 
.
ìì 
Information
ìì 
(
ìì 
$str
ìì p
+
ììq r
DateTime
ììs {
.
ìì{ |
Now
ìì| 
.ìì 
ToStringìì 
(ìì 
$strìì 
)ìì 
+ìì 
$strìì  µ
)ììµ ¶
;ìì¶ ·
byte
íí 
[
íí 
]
íí 
csvData
íí 
=
íí 
null
íí !
;
íí! "
if
îî 
(
îî 
dt
îî 
.
îî 
Rows
îî 
.
îî 
Count
îî 
>
îî 
$num
îî  !
)
îî! "
{
ïï 
try
òò 
{
óó 
if
õõ 
(
õõ 
dt
õõ 
!=
õõ 
null
õõ "
&&
õõ# %
dt
õõ& (
.
õõ( )
Rows
õõ) -
.
õõ- .
Count
õõ. 3
>
õõ4 5
$num
õõ6 7
)
õõ7 8
{
öö 
StringBuilder
øø %
sb
øø& (
=
øø) *
new
øø+ .
StringBuilder
øø/ <
(
øø< =
)
øø= >
;
øø> ?
foreach
ûû 
(
ûû  !
DataRow
ûû! (
row
ûû) ,
in
ûû- /
dt
ûû0 2
.
ûû2 3
Rows
ûû3 7
)
ûû7 8
{
üü 
IEnumerable
ıı '
<
ıı' (
string
ıı( .
>
ıı. /
fields
ıı0 6
=
ıı7 8
row
ıı9 <
.
ıı< =
	ItemArray
ıı= F
.
ııF G
Select
ııG M
(
ııM N
field
ııN S
=>
ııT V
field
ııW \
.
ıı\ ]
ToString
ıı] e
(
ııe f
)
ııf g
)
ııg h
;
ııh i
sb
şş 
.
şş 

AppendLine
şş )
(
şş) *
string
şş* 0
.
şş0 1
Join
şş1 5
(
şş5 6
$str
şş6 9
,
şş9 :
fields
şş; A
)
şşA B
)
şşB C
;
şşC D
}
		 
Log
		 
.
		 
Information
		 '
(
		' (
$str
		( T
+
		U V
sb
		W Y
.
		Y Z
ToString
		Z b
(
		b c
)
		c d
+
		e f
$str
		g |
)
		| }
;
		} ~
csvData
		 
=
		  !
Encoding
		" *
.
		* +
ASCII
		+ 0
.
		0 1
GetBytes
		1 9
(
		9 :
sb
		: <
.
		< =
ToString
		= E
(
		E F
)
		F G
)
		G H
;
		H I
Log
		 
.
		 
Information
		 '
(
		' (
$str
		( ^
+
		_ `
csvData
		a h
+
		i j
$str		k 
)		 
;		 
}
		 
}
		 
catch
		 
(
		 
	Exception
		  
ex
		! #
)
		# $
{
		 
return
		 
csvData
		 "
;
		" #
}
		 
}
		 
return
		 
csvData
		 
;
		 
}
		 	
public
		 
int
		 $
BOCWUploadFileOnServer
		 )
(
		) *
string
		* 0

SourceFile
		1 ;
)
		; <
{
		 	
Log
		 
.
		 
Information
		 
(
		 
$str
		 U
+
		V W
DateTime
		X `
.
		` a
Now
		a d
.
		d e
ToString
		e m
(
		m n
$str		n 
)		 
+		 
$str		 
)		 
;		 
int
		 
result
		 
=
		 
$num
		 
;
		 
try
		 
{
		 
using
		 
(
		 

SftpClient
		 !
client
		" (
=
		) *
new
		+ .

SftpClient
		/ 9
(
		9 :
	_sftpHost
		: C
,
		C D
	_sftpPort
		E N
,
		N O
_sftpUserName
		P ]
,
		] ^
_sftpPassword
		_ l
)
		l m
)
		m n
{
		 
client
		 
.
		 
Connect
		 "
(
		" #
)
		# $
;
		$ %
if
 	 	 
(
 	 	 
client
 	 	 
.
 	 	 
IsConnected
 	 	 *
)
 	 	* +
{
¡	¡	 
Log
¢	¢	 
.
¢	¢	 
Information
¢	¢	 '
(
¢	¢	' (
$str
¢	¢	( ?
)
¢	¢	? @
;
¢	¢	@ A
client
£	£	 
.
£	£	 
ChangeDirectory
£	£	 .
(
£	£	. /(
_sftpDestinationUploadPath
£	£	/ I
)
£	£	I J
;
£	£	J K
using
¤	¤	 
(
¤	¤	 

FileStream
¤	¤	 )
fs
¤	¤	* ,
=
¤	¤	- .
new
¤	¤	/ 2

FileStream
¤	¤	3 =
(
¤	¤	= >

SourceFile
¤	¤	> H
,
¤	¤	H I
FileMode
¤	¤	J R
.
¤	¤	R S
Open
¤	¤	S W
)
¤	¤	W X
)
¤	¤	X Y
{
¥	¥	 
if
¨	¨	 
(
¨	¨	  
System
¨	¨	  &
.
¨	¨	& '
IO
¨	¨	' )
.
¨	¨	) *
File
¨	¨	* .
.
¨	¨	. /
Exists
¨	¨	/ 5
(
¨	¨	5 6
Path
¨	¨	6 :
.
¨	¨	: ;
Combine
¨	¨	; B
(
¨	¨	B C(
_sftpDestinationUploadPath
¨	¨	C ]
,
¨	¨	] ^
Path
¨	¨	_ c
.
¨	¨	c d
GetFileName
¨	¨	d o
(
¨	¨	o p

SourceFile
¨	¨	p z
)
¨	¨	z {
)
¨	¨	{ |
)
¨	¨	| }
)
¨	¨	} ~
{
©	©	 
Log
ª	ª	  #
.
ª	ª	# $
Information
ª	ª	$ /
(
ª	ª	/ 0
$str
ª	ª	0 R
+
ª	ª	S T

SourceFile
ª	ª	U _
+
ª	ª	` a
$str
ª	ª	b e
)
ª	ª	e f
;
ª	ª	f g
}
«	«	 
else
¬	¬	  
{
­	­	 
client
®	®	  &
.
®	®	& '

UploadFile
®	®	' 1
(
®	®	1 2
fs
®	®	2 4
,
®	®	4 5
Path
®	®	6 :
.
®	®	: ;
GetFileName
®	®	; F
(
®	®	F G

SourceFile
®	®	G Q
)
®	®	Q R
)
®	®	R S
;
®	®	S T
Log
¯	¯	  #
.
¯	¯	# $
Information
¯	¯	$ /
(
¯	¯	/ 0
$str
¯	¯	0 G
)
¯	¯	G H
;
¯	¯	H I
}
°	°	 
}
²	²	 
client
³	³	 
.
³	³	 
Dispose
³	³	 &
(
³	³	& '
)
³	³	' (
;
³	³	( )
result
´	´	 
=
´	´	  
$num
´	´	! "
;
´	´	" #
}
µ	µ	 
else
¶	¶	 
{
·	·	 
Log
¸	¸	 
.
¸	¸	 
Information
¸	¸	 '
(
¸	¸	' (
$str
¸	¸	( C
)
¸	¸	C D
;
¸	¸	D E
}
¹	¹	 
}
»	»	 
}
½	½	 
catch
¾	¾	 
(
¾	¾	 
	Exception
¾	¾	 
ex
¾	¾	 
)
¾	¾	  
{
¿	¿	 
throw
À	À	 
ex
À	À	 
;
À	À	 
}
Á	Á	 
return
Â	Â	 
result
Â	Â	 
;
Â	Â	 
Log
Å	Å	 
.
Å	Å	 
Information
Å	Å	 
(
Å	Å	 
$str
Å	Å	 S
+
Å	Å	T U
DateTime
Å	Å	V ^
.
Å	Å	^ _
Now
Å	Å	_ b
.
Å	Å	b c
ToString
Å	Å	c k
(
Å	Å	k l
$str
Å	Å	l 
)Å	Å	 
+Å	Å	 
$strÅ	Å	 
)Å	Å	 
;Å	Å	 
}
Æ	Æ	 	
public
È	È	 
int
È	È	 $
BOCWReadFileFromServer
È	È	 )
(
È	È	) *
string
È	È	* 0
[
È	È	0 1
]
È	È	1 2
FileNameToRead
È	È	3 A
,
È	È	A B
string
È	È	C I
rootPath
È	È	J R
)
È	È	R S
{
É	É	 	
Log
Ë	Ë	 
.
Ë	Ë	 
Information
Ë	Ë	 
(
Ë	Ë	 
$str
Ë	Ë	 U
+
Ë	Ë	V W
DateTime
Ë	Ë	X `
.
Ë	Ë	` a
Now
Ë	Ë	a d
.
Ë	Ë	d e
ToString
Ë	Ë	e m
(
Ë	Ë	m n
$strË	Ë	n 
)Ë	Ë	 
+Ë	Ë	 
$strË	Ë	 
)Ë	Ë	 
;Ë	Ë	 
int
Î	Î	 
result
Î	Î	 
=
Î	Î	 
$num
Î	Î	 
;
Î	Î	 
try
Ï	Ï	 
{
Ğ	Ğ	 
using
Ñ	Ñ	 
(
Ñ	Ñ	 
var
Ñ	Ñ	 

sftpClient
Ñ	Ñ	 %
=
Ñ	Ñ	& '
new
Ñ	Ñ	( +

SftpClient
Ñ	Ñ	, 6
(
Ñ	Ñ	6 7
	_sftpHost
Ñ	Ñ	7 @
,
Ñ	Ñ	@ A
	_sftpPort
Ñ	Ñ	B K
,
Ñ	Ñ	K L
_sftpUserName
Ñ	Ñ	M Z
,
Ñ	Ñ	Z [
_sftpPassword
Ñ	Ñ	\ i
)
Ñ	Ñ	i j
)
Ñ	Ñ	j k
{
Ò	Ò	 

sftpClient
Ó	Ó	 
.
Ó	Ó	 
Connect
Ó	Ó	 &
(
Ó	Ó	& '
)
Ó	Ó	' (
;
Ó	Ó	( )
if
Ô	Ô	 
(
Ô	Ô	 

sftpClient
Ô	Ô	 "
.
Ô	Ô	" #
IsConnected
Ô	Ô	# .
)
Ô	Ô	. /
{
Õ	Õ	 
Log
Ö	Ö	 
.
Ö	Ö	 
Information
Ö	Ö	 '
(
Ö	Ö	' (
$str
Ö	Ö	( ?
)
Ö	Ö	? @
;
Ö	Ö	@ A
rootPath
×	×	  
=
×	×	! "
Path
×	×	# '
.
×	×	' (
Combine
×	×	( /
(
×	×	/ 0
rootPath
×	×	0 8
+
×	×	9 :
$str
×	×	; >
,
×	×	> ?
_BOCWResponsePath
×	×	@ Q
)
×	×	Q R
;
×	×	R S
foreach
Ø	Ø	 
(
Ø	Ø	  !
var
Ø	Ø	! $
fileItemToRead
Ø	Ø	% 3
in
Ø	Ø	4 6
FileNameToRead
Ø	Ø	7 E
)
Ø	Ø	E F
{
Ù	Ù	 
string
Ú	Ú	 "
fileName
Ú	Ú	# +
=
Ú	Ú	, -
_BOCWCorporateId
Ú	Ú	. >
+
Ú	Ú	? @
$str
Ú	Ú	A H
+
Ú	Ú	I J
fileItemToRead
Ú	Ú	K Y
;
Ú	Ú	Y Z
var
Ü	Ü	 
files
Ü	Ü	  %
=
Ü	Ü	& '

sftpClient
Ü	Ü	( 2
.
Ü	Ü	2 3
ListDirectory
Ü	Ü	3 @
(
Ü	Ü	@ A&
_sftpDestinationReadPath
Ü	Ü	A Y
)
Ü	Ü	Y Z
;
Ü	Ü	Z [
Log
Ş	Ş	 
.
Ş	Ş	  
Information
Ş	Ş	  +
(
Ş	Ş	+ ,
$str
Ş	Ş	, B
+
Ş	Ş	C D
fileName
Ş	Ş	E M
)
Ş	Ş	M N
;
Ş	Ş	N O
if
ß	ß	 
(
ß	ß	  
files
ß	ß	  %
!=
ß	ß	& (
null
ß	ß	) -
)
ß	ß	- .
{
à	à	 
files
â	â	  %
=
â	â	& '
files
â	â	( -
.
â	â	- .
Where
â	â	. 3
(
â	â	3 4
f
â	â	4 5
=>
â	â	6 8
f
â	â	9 :
.
â	â	: ;
Name
â	â	; ?
==
â	â	@ B
fileName
â	â	C K
)
â	â	K L
.
â	â	L M
ToList
â	â	M S
(
â	â	S T
)
â	â	T U
;
â	â	U V
if
æ	æ	  "
(
æ	æ	# $
!
æ	æ	$ %
	Directory
æ	æ	% .
.
æ	æ	. /
Exists
æ	æ	/ 5
(
æ	æ	5 6
rootPath
æ	æ	6 >
)
æ	æ	> ?
)
æ	æ	? @
{
ç	ç	  !
	Directory
è	è	$ -
.
è	è	- .
CreateDirectory
è	è	. =
(
è	è	= >
rootPath
è	è	> F
)
è	è	F G
;
è	è	G H
}
é	é	  !
foreach
ê	ê	  '
(
ê	ê	( )
var
ê	ê	) ,
file
ê	ê	- 1
in
ê	ê	2 4
files
ê	ê	5 :
)
ê	ê	: ;
{
ë	ë	  !
string
ì	ì	$ *
FileName
ì	ì	+ 3
=
ì	ì	4 5
Path
ì	ì	6 :
.
ì	ì	: ;
GetFileName
ì	ì	; F
(
ì	ì	F G
file
ì	ì	G K
.
ì	ì	K L
Name
ì	ì	L P
.
ì	ì	P Q
ToString
ì	ì	Q Y
(
ì	ì	Y Z
)
ì	ì	Z [
)
ì	ì	[ \
;
ì	ì	\ ]3
%DownloadResponseFileFromServerToLocal
í	í	$ I
(
í	í	I J

sftpClient
í	í	J T
,
í	í	T U
file
í	í	V Z
,
í	í	Z [
rootPath
í	í	\ d
)
í	í	d e
;
í	í	e f
}


  !
}


 
Log


 
.


  
Information


  +
(


+ ,
$str


, @
+


A B
fileName


C K
)


K L
;


L M
}


 
}


 
else


 
{


 
Log


 
.


 
Information


 '
(


' (
$str


( C
)


C D
;


D E
}


 

sftpClient


 
.


 
Dispose


 &
(


& '
)


' (
;


( )
}


 
}


 
catch


 
(


 
	Exception


 
ex


 
)


  
{


 
throw


 
ex


 
;


 
}


 
return


 
result


 
;


 
Log


 
.


 
Information


 
(


 
$str


 S
+


T U
DateTime


V ^
.


^ _
Now


_ b
.


b c
ToString


c k
(


k l
$str


l 
)

 
+

 
$str

 
)

 
;

 
}


 	
public
¡
¡
 
	DataTable
¡
¡
 ,
BOCWReadCSVFileFromLocalServer
¡
¡
 7
(
¡
¡
7 8
string
¡
¡
8 >
dest
¡
¡
? C
,
¡
¡
C D
string
¡
¡
E K
file
¡
¡
L P
)
¡
¡
P Q
{
¢
¢
 	
Log
¤
¤
 
.
¤
¤
 
Information
¤
¤
 
(
¤
¤
 
$str
¤
¤
 ]
+
¤
¤
^ _
DateTime
¤
¤
` h
.
¤
¤
h i
Now
¤
¤
i l
.
¤
¤
l m
ToString
¤
¤
m u
(
¤
¤
u v
$str¤
¤
v 
)¤
¤
 
+¤
¤
 
$str¤
¤
 ¢
)¤
¤
¢ £
;¤
¤
£ ¤
	DataTable
¥
¥
 
dtCsv
¥
¥
 
=
¥
¥
 
new
¥
¥
 !
	DataTable
¥
¥
" +
(
¥
¥
+ ,
)
¥
¥
, -
;
¥
¥
- .
Log
¦
¦
 
.
¦
¦
 
Information
¦
¦
 
(
¦
¦
 
$str
¦
¦
 #
+
¦
¦
$ %
dest
¦
¦
& *
+
¦
¦
+ ,
$str
¦
¦
- ?
+
¦
¦
@ A
file
¦
¦
B F
+
¦
¦
G H
$str
¦
¦
I K
)
¦
¦
K L
;
¦
¦
L M
try
§
§
 
{
¨
¨
 
using
©
©
 
(
©
©
 
StreamReader
©
©
 #
sr
©
©
$ &
=
©
©
' (
new
©
©
) ,
StreamReader
©
©
- 9
(
©
©
9 :
Path
©
©
: >
.
©
©
> ?
Combine
©
©
? F
(
©
©
F G
dest
©
©
G K
,
©
©
K L
file
©
©
M Q
)
©
©
Q R
)
©
©
R S
)
©
©
S T
{
ª
ª
 
dtCsv
¬
¬
 
.
¬
¬
 
Columns
¬
¬
 !
.
¬
¬
! "
Add
¬
¬
" %
(
¬
¬
% &
$str
¬
¬
& ,
,
¬
¬
, -
typeof
¬
¬
. 4
(
¬
¬
4 5
System
¬
¬
5 ;
.
¬
¬
; <
String
¬
¬
< B
)
¬
¬
B C
)
¬
¬
C D
;
¬
¬
D E
dtCsv
­
­
 
.
­
­
 
Columns
­
­
 !
.
­
­
! "
Add
­
­
" %
(
­
­
% &
$str
­
­
& 9
,
­
­
9 :
typeof
­
­
; A
(
­
­
A B
System
­
­
B H
.
­
­
H I
String
­
­
I O
)
­
­
O P
)
­
­
P Q
;
­
­
Q R
dtCsv
®
®
 
.
®
®
 
Columns
®
®
 !
.
®
®
! "
Add
®
®
" %
(
®
®
% &
$str
®
®
& -
,
®
®
- .
typeof
®
®
/ 5
(
®
®
5 6
System
®
®
6 <
.
®
®
< =
String
®
®
= C
)
®
®
C D
)
®
®
D E
;
®
®
E F
dtCsv
¯
¯
 
.
¯
¯
 
Columns
¯
¯
 !
.
¯
¯
! "
Add
¯
¯
" %
(
¯
¯
% &
$str
¯
¯
& 5
,
¯
¯
5 6
typeof
¯
¯
7 =
(
¯
¯
= >
System
¯
¯
> D
.
¯
¯
D E
String
¯
¯
E K
)
¯
¯
K L
)
¯
¯
L M
;
¯
¯
M N
dtCsv
°
°
 
.
°
°
 
Columns
°
°
 !
.
°
°
! "
Add
°
°
" %
(
°
°
% &
$str
°
°
& <
,
°
°
< =
typeof
°
°
> D
(
°
°
D E
System
°
°
E K
.
°
°
K L
String
°
°
L R
)
°
°
R S
)
°
°
S T
;
°
°
T U
dtCsv
±
±
 
.
±
±
 
Columns
±
±
 !
.
±
±
! "
Add
±
±
" %
(
±
±
% &
$str
±
±
& 0
,
±
±
0 1
typeof
±
±
2 8
(
±
±
8 9
System
±
±
9 ?
.
±
±
? @
String
±
±
@ F
)
±
±
F G
)
±
±
G H
;
±
±
H I
dtCsv
²
²
 
.
²
²
 
Columns
²
²
 !
.
²
²
! "
Add
²
²
" %
(
²
²
% &
$str
²
²
& .
,
²
²
. /
typeof
²
²
0 6
(
²
²
6 7
System
²
²
7 =
.
²
²
= >
Decimal
²
²
> E
)
²
²
E F
)
²
²
F G
;
²
²
G H
dtCsv
³
³
 
.
³
³
 
Columns
³
³
 !
.
³
³
! "
Add
³
³
" %
(
³
³
% &
$str
³
³
& 1
,
³
³
1 2
typeof
³
³
3 9
(
³
³
9 :
System
³
³
: @
.
³
³
@ A
String
³
³
A G
)
³
³
G H
)
³
³
H I
;
³
³
I J
dtCsv
´
´
 
.
´
´
 
Columns
´
´
 !
.
´
´
! "
Add
´
´
" %
(
´
´
% &
$str
´
´
& ?
,
´
´
? @
typeof
´
´
A G
(
´
´
G H
System
´
´
H N
.
´
´
N O
String
´
´
O U
)
´
´
U V
)
´
´
V W
;
´
´
W X
dtCsv
µ
µ
 
.
µ
µ
 
Columns
µ
µ
 !
.
µ
µ
! "
Add
µ
µ
" %
(
µ
µ
% &
$str
µ
µ
& 3
,
µ
µ
3 4
typeof
µ
µ
5 ;
(
µ
µ
; <
System
µ
µ
< B
.
µ
µ
B C
String
µ
µ
C I
)
µ
µ
I J
)
µ
µ
J K
;
µ
µ
K L
dtCsv
¶
¶
 
.
¶
¶
 
Columns
¶
¶
 !
.
¶
¶
! "
Add
¶
¶
" %
(
¶
¶
% &
$str
¶
¶
& 0
,
¶
¶
0 1
typeof
¶
¶
2 8
(
¶
¶
8 9
System
¶
¶
9 ?
.
¶
¶
? @
String
¶
¶
@ F
)
¶
¶
F G
)
¶
¶
G H
;
¶
¶
H I
dtCsv
·
·
 
.
·
·
 
Columns
·
·
 !
.
·
·
! "
Add
·
·
" %
(
·
·
% &
$str
·
·
& 2
,
·
·
2 3
typeof
·
·
4 :
(
·
·
: ;
System
·
·
; A
.
·
·
A B
String
·
·
B H
)
·
·
H I
)
·
·
I J
;
·
·
J K
dtCsv
¸
¸
 
.
¸
¸
 
Columns
¸
¸
 !
.
¸
¸
! "
Add
¸
¸
" %
(
¸
¸
% &
$str
¸
¸
& 7
,
¸
¸
7 8
typeof
¸
¸
9 ?
(
¸
¸
? @
System
¸
¸
@ F
.
¸
¸
F G
String
¸
¸
G M
)
¸
¸
M N
)
¸
¸
N O
;
¸
¸
O P
dtCsv
¹
¹
 
.
¹
¹
 
Columns
¹
¹
 !
.
¹
¹
! "
Add
¹
¹
" %
(
¹
¹
% &
$str
¹
¹
& 9
,
¹
¹
9 :
typeof
¹
¹
; A
(
¹
¹
A B
System
¹
¹
B H
.
¹
¹
H I
String
¹
¹
I O
)
¹
¹
O P
)
¹
¹
P Q
;
¹
¹
Q R
dtCsv
º
º
 
.
º
º
 
Columns
º
º
 !
.
º
º
! "
Add
º
º
" %
(
º
º
% &
$str
º
º
& -
,
º
º
- .
typeof
º
º
/ 5
(
º
º
5 6
System
º
º
6 <
.
º
º
< =
String
º
º
= C
)
º
º
C D
)
º
º
D E
;
º
º
E F
dtCsv
»
»
 
.
»
»
 
Columns
»
»
 !
.
»
»
! "
Add
»
»
" %
(
»
»
% &
$str
»
»
& 4
,
»
»
4 5
typeof
»
»
6 <
(
»
»
< =
System
»
»
= C
.
»
»
C D
String
»
»
D J
)
»
»
J K
)
»
»
K L
;
»
»
L M
while
¿
¿
 
(
¿
¿
 
!
¿
¿
 
sr
¿
¿
 
.
¿
¿
 
EndOfStream
¿
¿
 *
)
¿
¿
* +
{
À
À
 
string
Á
Á
 
FullText
Á
Á
 '
;
Á
Á
' (
FullText
Â
Â
  
=
Â
Â
! "
sr
Â
Â
# %
.
Â
Â
% &
	ReadToEnd
Â
Â
& /
(
Â
Â
/ 0
)
Â
Â
0 1
;
Â
Â
1 2
string
Ã
Ã
 
[
Ã
Ã
 
]
Ã
Ã
  
rows
Ã
Ã
! %
=
Ã
Ã
& '
FullText
Ã
Ã
( 0
.
Ã
Ã
0 1
Split
Ã
Ã
1 6
(
Ã
Ã
6 7
$char
Ã
Ã
7 ;
)
Ã
Ã
; <
;
Ã
Ã
< =
for
Å
Å
 
(
Å
Å
 
int
Å
Å
  
i
Å
Å
! "
=
Å
Å
# $
$num
Å
Å
% &
;
Å
Å
& '
i
Å
Å
( )
<
Å
Å
* +
rows
Å
Å
, 0
.
Å
Å
0 1
Length
Å
Å
1 7
-
Å
Å
8 9
$num
Å
Å
: ;
;
Å
Å
; <
i
Å
Å
= >
++
Å
Å
> @
)
Å
Å
@ A
{
Æ
Æ
 
string
È
È
 "
[
È
È
" #
]
È
È
# $

rowValues0
È
È
% /
=
È
È
0 1
rows
È
È
2 6
[
È
È
6 7
i
È
È
7 8
]
È
È
8 9
.
È
È
9 :
Split
È
È
: ?
(
È
È
? @
$char
È
È
@ C
)
È
È
C D
;
È
È
D E
DataRow
É
É
 #
row
É
É
$ '
=
É
É
( )
dtCsv
É
É
* /
.
É
É
/ 0
Rows
É
É
0 4
.
É
É
4 5
Add
É
É
5 8
(
É
É
8 9
)
É
É
9 :
;
É
É
: ;
for
Ê
Ê
 
(
Ê
Ê
  !
int
Ê
Ê
! $
j
Ê
Ê
% &
=
Ê
Ê
' (
$num
Ê
Ê
) *
;
Ê
Ê
* +
j
Ê
Ê
, -
<
Ê
Ê
. /

rowValues0
Ê
Ê
0 :
.
Ê
Ê
: ;
Length
Ê
Ê
; A
;
Ê
Ê
A B
j
Ê
Ê
C D
++
Ê
Ê
D F
)
Ê
Ê
F G
{
Ë
Ë
 
row
Ì
Ì
  #
.
Ì
Ì
# $
SetField
Ì
Ì
$ ,
(
Ì
Ì
, -
j
Ì
Ì
- .
,
Ì
Ì
. /

rowValues0
Ì
Ì
0 :
[
Ì
Ì
: ;
j
Ì
Ì
; <
]
Ì
Ì
< =
)
Ì
Ì
= >
;
Ì
Ì
> ?
}
Í
Í
 
}
Î
Î
 
}
Ğ
Ğ
 
return
Ñ
Ñ
 
dtCsv
Ñ
Ñ
  
;
Ñ
Ñ
  !
}
Ò
Ò
 
return
Ô
Ô
 
null
Ô
Ô
 
;
Ô
Ô
 
}
Õ
Õ
 
catch
Ö
Ö
 
(
Ö
Ö
 
	Exception
Ö
Ö
 
ex
Ö
Ö
 
)
Ö
Ö
  
{
×
×
 
return
Ù
Ù
 
dtCsv
Ù
Ù
 
;
Ù
Ù
 
}
Ú
Ú
 
Log
Ü
Ü
 
.
Ü
Ü
 
Information
Ü
Ü
 
(
Ü
Ü
 
$str
Ü
Ü
 [
+
Ü
Ü
\ ]
DateTime
Ü
Ü
^ f
.
Ü
Ü
f g
Now
Ü
Ü
g j
.
Ü
Ü
j k
ToString
Ü
Ü
k s
(
Ü
Ü
s t
$strÜ
Ü
t 
)Ü
Ü
 
+Ü
Ü
 
$strÜ
Ü
  
)Ü
Ü
  ¡
;Ü
Ü
¡ ¢
}
İ
İ
 	
private
à
à
 
void
à
à
 3
%DownloadResponseFileFromServerToLocal
à
à
 :
(
à
à
: ;

SftpClient
à
à
; E
client
à
à
F L
,
à
à
L M
SftpFile
à
à
N V
file
à
à
W [
,
à
à
[ \
string
à
à
] c"
destinationDirectory
à
à
d x
)
à
à
x y
{
á
á
 	
Log
â
â
 
.
â
â
 
Information
â
â
 
(
â
â
 
$str
â
â
 d
+
â
â
e f
DateTime
â
â
g o
.
â
â
o p
Now
â
â
p s
.
â
â
s t
ToString
â
â
t |
(
â
â
| }
$strâ
â
} 
)â
â
 
+â
â
 
$strâ
â
 ©
)â
â
© ª
;â
â
ª «
try
ã
ã
 
{
ä
ä
 
using
å
å
 
(
å
å
 
Stream
å
å
 

fileStream
å
å
 (
=
å
å
) *
File
å
å
+ /
.
å
å
/ 0
	OpenWrite
å
å
0 9
(
å
å
9 :
Path
å
å
: >
.
å
å
> ?
Combine
å
å
? F
(
å
å
F G"
destinationDirectory
å
å
G [
,
å
å
[ \
file
å
å
] a
.
å
å
a b
Name
å
å
b f
)
å
å
f g
)
å
å
g h
)
å
å
h i
{
æ
æ
 
string
ç
ç
 
FileName
ç
ç
 #
=
ç
ç
$ %
Path
ç
ç
& *
.
ç
ç
* +
GetFileName
ç
ç
+ 6
(
ç
ç
6 7
file
ç
ç
7 ;
.
ç
ç
; <
Name
ç
ç
< @
.
ç
ç
@ A
ToString
ç
ç
A I
(
ç
ç
I J
)
ç
ç
J K
)
ç
ç
K L
;
ç
ç
L M
if
é
é
 
(
é
é
 
File
é
é
 
.
é
é
 
Exists
é
é
 #
(
é
é
# $
Path
é
é
$ (
.
é
é
( )
Combine
é
é
) 0
(
é
é
0 1"
destinationDirectory
é
é
1 E
,
é
é
E F
file
é
é
G K
.
é
é
K L
Name
é
é
L P
)
é
é
P Q
)
é
é
Q R
)
é
é
R S
{
ê
ê
 
if
ë
ë
 
(
ë
ë
 
file
ë
ë
  
.
ë
ë
  !
Length
ë
ë
! '
!=
ë
ë
( *

fileStream
ë
ë
+ 5
.
ë
ë
5 6
Length
ë
ë
6 <
)
ë
ë
< =
{
ì
ì
 
client
î
î
 "
.
î
î
" #
DownloadFile
î
î
# /
(
î
î
/ 0
file
î
î
0 4
.
î
î
4 5
FullName
î
î
5 =
,
î
î
= >

fileStream
î
î
? I
)
î
î
I J
;
î
î
J K
Log
ï
ï
 
.
ï
ï
  
Information
ï
ï
  +
(
ï
ï
+ ,
$str
ï
ï
, g
+
ï
ï
h i
file
ï
ï
j n
.
ï
ï
n o
FullName
ï
ï
o w
)
ï
ï
w x
;
ï
ï
x y
}
ğ
ğ
 
else
ñ
ñ
 
{
ò
ò
 
Log
ó
ó
 
.
ó
ó
  
Information
ó
ó
  +
(
ó
ó
+ ,
$str
ó
ó
, M
+
ó
ó
N O
file
ó
ó
P T
.
ó
ó
T U
FullName
ó
ó
U ]
)
ó
ó
] ^
;
ó
ó
^ _
}
ô
ô
 
}
õ
õ
 
else
ö
ö
 
{
÷
÷
 
client
ø
ø
 
.
ø
ø
 
DownloadFile
ø
ø
 +
(
ø
ø
+ ,
file
ø
ø
, 0
.
ø
ø
0 1
FullName
ø
ø
1 9
,
ø
ø
9 :

fileStream
ø
ø
; E
)
ø
ø
E F
;
ø
ø
F G
Log
ù
ù
 
.
ù
ù
 
Information
ù
ù
 '
(
ù
ù
' (
$str
ù
ù
( O
+
ù
ù
P Q
file
ù
ù
R V
.
ù
ù
V W
FullName
ù
ù
W _
)
ù
ù
_ `
;
ù
ù
` a
}
ú
ú
 
}
û
û
 
}
ü
ü
 
catch
ı
ı
 
(
ı
ı
 
	Exception
ı
ı
 
e
ı
ı
 
)
ı
ı
 
{
ş
ş
 
Log
ÿ
ÿ
 
.
ÿ
ÿ
 
Information
ÿ
ÿ
 
(
ÿ
ÿ
  
$str
ÿ
ÿ
  g
+
ÿ
ÿ
h i
e
ÿ
ÿ
j k
.
ÿ
ÿ
k l
Message
ÿ
ÿ
l s
)
ÿ
ÿ
s t
;
ÿ
ÿ
t u
throw
 
;
 
}
 
Log
 
.
 
Information
 
(
 
$str
 b
+
c d
DateTime
e m
.
m n
Now
n q
.
q r
ToString
r z
(
z {
$str{ 
) 
+ 
$str §
)§ ¨
;¨ ©
}
 	
public
 
int
 $
GLWBUploadFileOnServer
 )
(
) *
string
* 0

SourceFile
1 ;
)
; <
{
 	
Log
 
.
 
Information
 
(
 
$str
 U
+
V W
DateTime
X `
.
` a
Now
a d
.
d e
ToString
e m
(
m n
$strn 
) 
+ 
$str 
) 
; 
int
 
result
 
=
 
$num
 
;
 
try
 
{
 
using
 
(
 

SftpClient
 !
client
" (
=
) *
new
+ .

SftpClient
/ 9
(
9 :
	_sftpHost
: C
,
C D
	_sftpPort
E N
,
N O
_sftpUserName
P ]
,
] ^
_sftpPassword
_ l
)
l m
)
m n
{
 
client
 
.
 
Connect
 "
(
" #
)
# $
;
$ %
if
 
(
 
client
 
.
 
IsConnected
 *
)
* +
{
 
Log
 
.
 
Information
 '
(
' (
$str
( ?
)
? @
;
@ A
client
 
.
 
ChangeDirectory
 .
(
. /(
_sftpDestinationUploadPath
/ I
)
I J
;
J K
using
 
(
 

FileStream
 )
fs
* ,
=
- .
new
/ 2

FileStream
3 =
(
= >

SourceFile
> H
,
H I
FileMode
J R
.
R S
Open
S W
)
W X
)
X Y
{
 
if
 
(
  
System
  &
.
& '
IO
' )
.
) *
File
* .
.
. /
Exists
/ 5
(
5 6
Path
6 :
.
: ;
Combine
; B
(
B C(
_sftpDestinationUploadPath
C ]
,
] ^
Path
_ c
.
c d
GetFileName
d o
(
o p

SourceFile
p z
)
z {
)
{ |
)
| }
)
} ~
{
 
Log
  #
.
# $
Information
$ /
(
/ 0
$str
0 R
+
S T

SourceFile
U _
+
` a
$str
b e
)
e f
;
f g
}
 
else
    
{
¡¡ 
client
¢¢  &
.
¢¢& '

UploadFile
¢¢' 1
(
¢¢1 2
fs
¢¢2 4
,
¢¢4 5
Path
¢¢6 :
.
¢¢: ;
GetFileName
¢¢; F
(
¢¢F G

SourceFile
¢¢G Q
)
¢¢Q R
)
¢¢R S
;
¢¢S T
Log
££  #
.
££# $
Information
££$ /
(
££/ 0
$str
££0 G
)
££G H
;
££H I
}
¤¤ 
}
¦¦ 
client
§§ 
.
§§ 
Dispose
§§ &
(
§§& '
)
§§' (
;
§§( )
result
¨¨ 
=
¨¨  
$num
¨¨! "
;
¨¨" #
}
©© 
else
ªª 
{
«« 
Log
¬¬ 
.
¬¬ 
Information
¬¬ '
(
¬¬' (
$str
¬¬( C
)
¬¬C D
;
¬¬D E
}
­­ 
}
¯¯ 
}
±± 
catch
²² 
(
²² 
	Exception
²² 
ex
²² 
)
²²  
{
³³ 
Log
´´ 
.
´´ 
Information
´´ 
(
´´  
$str
´´  >
+
´´? @
ex
´´A C
.
´´C D
Message
´´D K
)
´´K L
;
´´L M
throw
µµ 
ex
µµ 
;
µµ 
}
¶¶ 
return
·· 
result
·· 
;
·· 
Log
ºº 
.
ºº 
Information
ºº 
(
ºº 
$str
ºº S
+
ººT U
DateTime
ººV ^
.
ºº^ _
Now
ºº_ b
.
ººb c
ToString
ººc k
(
ººk l
$str
ººl 
)ºº 
+ºº 
$strºº 
)ºº 
;ºº 
}
»» 	
public
½½ 
int
½½ $
GLWBReadFileFromServer
½½ )
(
½½) *
string
½½* 0
[
½½0 1
]
½½1 2
FileNameToRead
½½3 A
,
½½A B
string
½½C I
rootPath
½½J R
)
½½R S
{
¾¾ 	
Log
ÀÀ 
.
ÀÀ 
Information
ÀÀ 
(
ÀÀ 
$str
ÀÀ U
+
ÀÀV W
DateTime
ÀÀX `
.
ÀÀ` a
Now
ÀÀa d
.
ÀÀd e
ToString
ÀÀe m
(
ÀÀm n
$strÀÀn 
)ÀÀ 
+ÀÀ 
$strÀÀ 
)ÀÀ 
;ÀÀ 
int
ÃÃ 
result
ÃÃ 
=
ÃÃ 
$num
ÃÃ 
;
ÃÃ 
try
ÄÄ 
{
ÅÅ 
using
ÆÆ 
(
ÆÆ 
var
ÆÆ 

sftpClient
ÆÆ %
=
ÆÆ& '
new
ÆÆ( +

SftpClient
ÆÆ, 6
(
ÆÆ6 7
	_sftpHost
ÆÆ7 @
,
ÆÆ@ A
	_sftpPort
ÆÆB K
,
ÆÆK L
_sftpUserName
ÆÆM Z
,
ÆÆZ [
_sftpPassword
ÆÆ\ i
)
ÆÆi j
)
ÆÆj k
{
ÇÇ 

sftpClient
ÈÈ 
.
ÈÈ 
Connect
ÈÈ &
(
ÈÈ& '
)
ÈÈ' (
;
ÈÈ( )
if
ÉÉ 
(
ÉÉ 

sftpClient
ÉÉ "
.
ÉÉ" #
IsConnected
ÉÉ# .
)
ÉÉ. /
{
ÊÊ 
Log
ËË 
.
ËË 
Information
ËË '
(
ËË' (
$str
ËË( ?
)
ËË? @
;
ËË@ A
rootPath
ÌÌ  
=
ÌÌ! "
Path
ÌÌ# '
.
ÌÌ' (
Combine
ÌÌ( /
(
ÌÌ/ 0
rootPath
ÌÌ0 8
+
ÌÌ9 :
$str
ÌÌ; >
,
ÌÌ> ?
_GLWBResponsePath
ÌÌ@ Q
)
ÌÌQ R
;
ÌÌR S
foreach
ÍÍ 
(
ÍÍ  !
var
ÍÍ! $
fileItemToRead
ÍÍ% 3
in
ÍÍ4 6
FileNameToRead
ÍÍ7 E
)
ÍÍE F
{
ÎÎ 
string
ÏÏ "
fileName
ÏÏ# +
=
ÏÏ, -
_GLWBCorporateId
ÏÏ. >
+
ÏÏ? @
$str
ÏÏA H
+
ÏÏI J
fileItemToRead
ÏÏK Y
;
ÏÏY Z
var
ÑÑ 
files
ÑÑ  %
=
ÑÑ& '

sftpClient
ÑÑ( 2
.
ÑÑ2 3
ListDirectory
ÑÑ3 @
(
ÑÑ@ A&
_sftpDestinationReadPath
ÑÑA Y
)
ÑÑY Z
;
ÑÑZ [
Log
ÓÓ 
.
ÓÓ  
Information
ÓÓ  +
(
ÓÓ+ ,
$str
ÓÓ, B
+
ÓÓC D
fileName
ÓÓE M
)
ÓÓM N
;
ÓÓN O
if
ÔÔ 
(
ÔÔ  
files
ÔÔ  %
!=
ÔÔ& (
null
ÔÔ) -
)
ÔÔ- .
{
ÕÕ 
files
ÖÖ  %
=
ÖÖ& '
files
ÖÖ( -
.
ÖÖ- .
Where
ÖÖ. 3
(
ÖÖ3 4
f
ÖÖ4 5
=>
ÖÖ6 8
f
ÖÖ9 :
.
ÖÖ: ;
Name
ÖÖ; ?
==
ÖÖ@ B
fileName
ÖÖC K
)
ÖÖK L
.
ÖÖL M
ToList
ÖÖM S
(
ÖÖS T
)
ÖÖT U
;
ÖÖU V
if
ÚÚ  "
(
ÚÚ# $
!
ÚÚ$ %
	Directory
ÚÚ% .
.
ÚÚ. /
Exists
ÚÚ/ 5
(
ÚÚ5 6
rootPath
ÚÚ6 >
)
ÚÚ> ?
)
ÚÚ? @
{
ÛÛ  !
	Directory
ÜÜ$ -
.
ÜÜ- .
CreateDirectory
ÜÜ. =
(
ÜÜ= >
rootPath
ÜÜ> F
)
ÜÜF G
;
ÜÜG H
}
İİ  !
foreach
ŞŞ  '
(
ŞŞ( )
var
ŞŞ) ,
file
ŞŞ- 1
in
ŞŞ2 4
files
ŞŞ5 :
)
ŞŞ: ;
{
ßß  !
string
àà$ *
FileName
àà+ 3
=
àà4 5
Path
àà6 :
.
àà: ;
GetFileName
àà; F
(
ààF G
file
ààG K
.
ààK L
Name
ààL P
.
ààP Q
ToString
ààQ Y
(
ààY Z
)
ààZ [
)
àà[ \
;
àà\ ]3
%DownloadResponseFileFromServerToLocal
áá$ I
(
ááI J

sftpClient
ááJ T
,
ááT U
file
ááV Z
,
ááZ [
rootPath
áá\ d
)
áád e
;
ááe f
}
ùù  !
}
ûû 
Log
ıı 
.
ıı  
Information
ıı  +
(
ıı+ ,
$str
ıı, @
+
ııA B
fileName
ııC K
)
ııK L
;
ııL M
}
ÿÿ 
}
 
else
 
{
 
Log
 
.
 
Information
 '
(
' (
$str
( C
)
C D
;
D E
}
 

sftpClient
 
.
 
Dispose
 &
(
& '
)
' (
;
( )
}
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
throw
 
ex
 
;
 
}
 
return
 
result
 
;
 
Log
 
.
 
Information
 
(
 
$str
 S
+
T U
DateTime
V ^
.
^ _
Now
_ b
.
b c
ToString
c k
(
k l
$str
l 
) 
+ 
$str 
) 
; 
}
 	
public
 
	DataTable
 ,
GLWBReadCSVFileFromLocalServer
 7
(
7 8
string
8 >
dest
? C
,
C D
string
E K
file
L P
)
P Q
{
 	
Log
 
.
 
Information
 
(
 
$str
 ]
+
^ _
DateTime
` h
.
h i
Now
i l
.
l m
ToString
m u
(
u v
$strv 
) 
+ 
$str ¢
)¢ £
;£ ¤
	DataTable
 
dtCsv
 
=
 
new
 !
	DataTable
" +
(
+ ,
)
, -
;
- .
Log
 
.
 
Information
 
(
 
$str
 #
+
$ %
dest
& *
+
+ ,
$str
- ?
+
@ A
file
B F
+
G H
$str
I K
)
K L
;
L M
try
 
{
 
using
 
(
 
StreamReader
 #
sr
$ &
=
' (
new
) ,
StreamReader
- 9
(
9 :
Path
: >
.
> ?
Combine
? F
(
F G
dest
G K
,
K L
file
M Q
)
Q R
)
R S
)
S T
{
 
dtCsv
   
.
   
Columns
   !
.
  ! "
Add
  " %
(
  % &
$str
  & ,
,
  , -
typeof
  . 4
(
  4 5
System
  5 ;
.
  ; <
String
  < B
)
  B C
)
  C D
;
  D E
dtCsv
¡¡ 
.
¡¡ 
Columns
¡¡ !
.
¡¡! "
Add
¡¡" %
(
¡¡% &
$str
¡¡& 9
,
¡¡9 :
typeof
¡¡; A
(
¡¡A B
System
¡¡B H
.
¡¡H I
String
¡¡I O
)
¡¡O P
)
¡¡P Q
;
¡¡Q R
dtCsv
¢¢ 
.
¢¢ 
Columns
¢¢ !
.
¢¢! "
Add
¢¢" %
(
¢¢% &
$str
¢¢& -
,
¢¢- .
typeof
¢¢/ 5
(
¢¢5 6
System
¢¢6 <
.
¢¢< =
String
¢¢= C
)
¢¢C D
)
¢¢D E
;
¢¢E F
dtCsv
££ 
.
££ 
Columns
££ !
.
££! "
Add
££" %
(
££% &
$str
££& 5
,
££5 6
typeof
££7 =
(
££= >
System
££> D
.
££D E
String
££E K
)
££K L
)
££L M
;
££M N
dtCsv
¤¤ 
.
¤¤ 
Columns
¤¤ !
.
¤¤! "
Add
¤¤" %
(
¤¤% &
$str
¤¤& <
,
¤¤< =
typeof
¤¤> D
(
¤¤D E
System
¤¤E K
.
¤¤K L
String
¤¤L R
)
¤¤R S
)
¤¤S T
;
¤¤T U
dtCsv
¥¥ 
.
¥¥ 
Columns
¥¥ !
.
¥¥! "
Add
¥¥" %
(
¥¥% &
$str
¥¥& 0
,
¥¥0 1
typeof
¥¥2 8
(
¥¥8 9
System
¥¥9 ?
.
¥¥? @
String
¥¥@ F
)
¥¥F G
)
¥¥G H
;
¥¥H I
dtCsv
¦¦ 
.
¦¦ 
Columns
¦¦ !
.
¦¦! "
Add
¦¦" %
(
¦¦% &
$str
¦¦& .
,
¦¦. /
typeof
¦¦0 6
(
¦¦6 7
System
¦¦7 =
.
¦¦= >
Decimal
¦¦> E
)
¦¦E F
)
¦¦F G
;
¦¦G H
dtCsv
§§ 
.
§§ 
Columns
§§ !
.
§§! "
Add
§§" %
(
§§% &
$str
§§& 1
,
§§1 2
typeof
§§3 9
(
§§9 :
System
§§: @
.
§§@ A
String
§§A G
)
§§G H
)
§§H I
;
§§I J
dtCsv
¨¨ 
.
¨¨ 
Columns
¨¨ !
.
¨¨! "
Add
¨¨" %
(
¨¨% &
$str
¨¨& ?
,
¨¨? @
typeof
¨¨A G
(
¨¨G H
System
¨¨H N
.
¨¨N O
String
¨¨O U
)
¨¨U V
)
¨¨V W
;
¨¨W X
dtCsv
©© 
.
©© 
Columns
©© !
.
©©! "
Add
©©" %
(
©©% &
$str
©©& 3
,
©©3 4
typeof
©©5 ;
(
©©; <
System
©©< B
.
©©B C
String
©©C I
)
©©I J
)
©©J K
;
©©K L
dtCsv
ªª 
.
ªª 
Columns
ªª !
.
ªª! "
Add
ªª" %
(
ªª% &
$str
ªª& 0
,
ªª0 1
typeof
ªª2 8
(
ªª8 9
System
ªª9 ?
.
ªª? @
String
ªª@ F
)
ªªF G
)
ªªG H
;
ªªH I
dtCsv
«« 
.
«« 
Columns
«« !
.
««! "
Add
««" %
(
««% &
$str
««& 2
,
««2 3
typeof
««4 :
(
««: ;
System
««; A
.
««A B
String
««B H
)
««H I
)
««I J
;
««J K
dtCsv
¬¬ 
.
¬¬ 
Columns
¬¬ !
.
¬¬! "
Add
¬¬" %
(
¬¬% &
$str
¬¬& 7
,
¬¬7 8
typeof
¬¬9 ?
(
¬¬? @
System
¬¬@ F
.
¬¬F G
String
¬¬G M
)
¬¬M N
)
¬¬N O
;
¬¬O P
dtCsv
­­ 
.
­­ 
Columns
­­ !
.
­­! "
Add
­­" %
(
­­% &
$str
­­& 9
,
­­9 :
typeof
­­; A
(
­­A B
System
­­B H
.
­­H I
String
­­I O
)
­­O P
)
­­P Q
;
­­Q R
dtCsv
®® 
.
®® 
Columns
®® !
.
®®! "
Add
®®" %
(
®®% &
$str
®®& -
,
®®- .
typeof
®®/ 5
(
®®5 6
System
®®6 <
.
®®< =
String
®®= C
)
®®C D
)
®®D E
;
®®E F
dtCsv
¯¯ 
.
¯¯ 
Columns
¯¯ !
.
¯¯! "
Add
¯¯" %
(
¯¯% &
$str
¯¯& 4
,
¯¯4 5
typeof
¯¯6 <
(
¯¯< =
System
¯¯= C
.
¯¯C D
String
¯¯D J
)
¯¯J K
)
¯¯K L
;
¯¯L M
while
³³ 
(
³³ 
!
³³ 
sr
³³ 
.
³³ 
EndOfStream
³³ *
)
³³* +
{
´´ 
string
µµ 
FullText
µµ '
;
µµ' (
FullText
¶¶  
=
¶¶! "
sr
¶¶# %
.
¶¶% &
	ReadToEnd
¶¶& /
(
¶¶/ 0
)
¶¶0 1
;
¶¶1 2
string
·· 
[
·· 
]
··  
rows
··! %
=
··& '
FullText
··( 0
.
··0 1
Split
··1 6
(
··6 7
$char
··7 ;
)
··; <
;
··< =
for
¹¹ 
(
¹¹ 
int
¹¹  
i
¹¹! "
=
¹¹# $
$num
¹¹% &
;
¹¹& '
i
¹¹( )
<
¹¹* +
rows
¹¹, 0
.
¹¹0 1
Length
¹¹1 7
-
¹¹8 9
$num
¹¹: ;
;
¹¹; <
i
¹¹= >
++
¹¹> @
)
¹¹@ A
{
ºº 
string
¼¼ "
[
¼¼" #
]
¼¼# $

rowValues0
¼¼% /
=
¼¼0 1
rows
¼¼2 6
[
¼¼6 7
i
¼¼7 8
]
¼¼8 9
.
¼¼9 :
Split
¼¼: ?
(
¼¼? @
$char
¼¼@ C
)
¼¼C D
;
¼¼D E
DataRow
½½ #
row
½½$ '
=
½½( )
dtCsv
½½* /
.
½½/ 0
Rows
½½0 4
.
½½4 5
Add
½½5 8
(
½½8 9
)
½½9 :
;
½½: ;
for
¾¾ 
(
¾¾  !
int
¾¾! $
j
¾¾% &
=
¾¾' (
$num
¾¾) *
;
¾¾* +
j
¾¾, -
<
¾¾. /

rowValues0
¾¾0 :
.
¾¾: ;
Length
¾¾; A
;
¾¾A B
j
¾¾C D
++
¾¾D F
)
¾¾F G
{
¿¿ 
row
ÀÀ  #
.
ÀÀ# $
SetField
ÀÀ$ ,
(
ÀÀ, -
j
ÀÀ- .
,
ÀÀ. /

rowValues0
ÀÀ0 :
[
ÀÀ: ;
j
ÀÀ; <
]
ÀÀ< =
)
ÀÀ= >
;
ÀÀ> ?
}
ÁÁ 
}
ÂÂ 
}
ÄÄ 
return
ÅÅ 
dtCsv
ÅÅ  
;
ÅÅ  !
}
ÆÆ 
return
ÈÈ 
null
ÈÈ 
;
ÈÈ 
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
return
ÍÍ 
dtCsv
ÍÍ 
;
ÍÍ 
}
ÎÎ 
Log
ĞĞ 
.
ĞĞ 
Information
ĞĞ 
(
ĞĞ 
$str
ĞĞ [
+
ĞĞ\ ]
DateTime
ĞĞ^ f
.
ĞĞf g
Now
ĞĞg j
.
ĞĞj k
ToString
ĞĞk s
(
ĞĞs t
$strĞĞt 
)ĞĞ 
+ĞĞ 
$strĞĞ  
)ĞĞ  ¡
;ĞĞ¡ ¢
}
ÑÑ 	
private
ÖÖ 
static
ÖÖ 
readonly
ÖÖ 
char
ÖÖ  $
[
ÖÖ$ %
]
ÖÖ% &
Punctuations
ÖÖ' 3
=
ÖÖ4 5
$str
ÖÖ6 N
.
ÖÖN O
ToCharArray
ÖÖO Z
(
ÖÖZ [
)
ÖÖ[ \
;
ÖÖ\ ]
public
×× 
static
×× 
string
×× 
Generate
×× %
(
××% &
int
××& )
length
××* 0
,
××0 1
int
××2 5/
!numberOfNonAlphanumericCharacters
××6 W
)
××W X
{
ØØ 	
if
ÙÙ 
(
ÙÙ 
length
ÙÙ 
<
ÙÙ 
$num
ÙÙ 
||
ÙÙ 
length
ÙÙ $
>
ÙÙ% &
$num
ÙÙ' *
)
ÙÙ* +
{
ÚÚ 
throw
ÛÛ 
new
ÛÛ 
ArgumentException
ÛÛ +
(
ÛÛ+ ,
$str
ÛÛ, 4
)
ÛÛ4 5
;
ÛÛ5 6
}
ÜÜ 
if
ŞŞ 
(
ŞŞ /
!numberOfNonAlphanumericCharacters
ŞŞ 1
>
ŞŞ2 3
length
ŞŞ4 :
||
ŞŞ; =/
!numberOfNonAlphanumericCharacters
ŞŞ> _
<
ŞŞ` a
$num
ŞŞb c
)
ŞŞc d
{
ßß 
throw
àà 
new
àà 
ArgumentException
àà +
(
àà+ ,
$str
àà, O
)
ààO P
;
ààP Q
}
áá 
using
ãã 
(
ãã 
var
ãã 
rng
ãã 
=
ãã #
RandomNumberGenerator
ãã 2
.
ãã2 3
Create
ãã3 9
(
ãã9 :
)
ãã: ;
)
ãã; <
{
ää 
var
åå 

byteBuffer
åå 
=
åå  
new
åå! $
byte
åå% )
[
åå) *
length
åå* 0
]
åå0 1
;
åå1 2
rng
çç 
.
çç 
GetBytes
çç 
(
çç 

byteBuffer
çç '
)
çç' (
;
çç( )
var
éé 
count
éé 
=
éé 
$num
éé 
;
éé 
var
êê 
characterBuffer
êê #
=
êê$ %
new
êê& )
char
êê* .
[
êê. /
length
êê/ 5
]
êê5 6
;
êê6 7
for
ìì 
(
ìì 
var
ìì 
iter
ìì 
=
ìì 
$num
ìì  !
;
ìì! "
iter
ìì# '
<
ìì( )
length
ìì* 0
;
ìì0 1
iter
ìì2 6
++
ìì6 8
)
ìì8 9
{
íí 
var
îî 
i
îî 
=
îî 

byteBuffer
îî &
[
îî& '
iter
îî' +
]
îî+ ,
%
îî- .
$num
îî/ 1
;
îî1 2
if
ğğ 
(
ğğ 
i
ğğ 
<
ğğ 
$num
ğğ 
)
ğğ 
{
ññ 
characterBuffer
òò '
[
òò' (
iter
òò( ,
]
òò, -
=
òò. /
(
òò0 1
char
òò1 5
)
òò5 6
(
òò6 7
$char
òò7 :
+
òò; <
i
òò= >
)
òò> ?
;
òò? @
}
óó 
else
ôô 
if
ôô 
(
ôô 
i
ôô 
<
ôô  
$num
ôô! #
)
ôô# $
{
õõ 
characterBuffer
öö '
[
öö' (
iter
öö( ,
]
öö, -
=
öö. /
(
öö0 1
char
öö1 5
)
öö5 6
(
öö6 7
$char
öö7 :
+
öö; <
i
öö= >
-
öö? @
$num
ööA C
)
ööC D
;
ööD E
}
÷÷ 
else
øø 
if
øø 
(
øø 
i
øø 
<
øø  
$num
øø! #
)
øø# $
{
ùù 
characterBuffer
úú '
[
úú' (
iter
úú( ,
]
úú, -
=
úú. /
(
úú0 1
char
úú1 5
)
úú5 6
(
úú6 7
$char
úú7 :
+
úú; <
i
úú= >
-
úú? @
$num
úúA C
)
úúC D
;
úúD E
}
ûû 
else
üü 
{
ıı 
characterBuffer
şş '
[
şş' (
iter
şş( ,
]
şş, -
=
şş. /
Punctuations
şş0 <
[
şş< =
GetRandomInt
şş= I
(
şşI J
rng
şşJ M
,
şşM N
Punctuations
şşO [
.
şş[ \
Length
şş\ b
)
şşb c
]
şşc d
;
şşd e
count
ÿÿ 
++
ÿÿ 
;
ÿÿ  
}
 
}
 
if
 
(
 
count
 
>=
 /
!numberOfNonAlphanumericCharacters
 >
)
> ?
{
 
return
 
new
 
string
 %
(
% &
characterBuffer
& 5
)
5 6
;
6 7
}
 
int
 
j
 
;
 
for
 
(
 
j
 
=
 
$num
 
;
 
j
 
<
 /
!numberOfNonAlphanumericCharacters
  A
-
B C
count
D I
;
I J
j
K L
++
L N
)
N O
{
 
int
 
k
 
;
 
do
 
{
 
k
 
=
 
GetRandomInt
 (
(
( )
rng
) ,
,
, -
length
. 4
)
4 5
;
5 6
}
 
while
 
(
 
!
 
char
  
.
  !
IsLetterOrDigit
! 0
(
0 1
characterBuffer
1 @
[
@ A
k
A B
]
B C
)
C D
)
D E
;
E F
characterBuffer
 #
[
# $
k
$ %
]
% &
=
' (
Punctuations
) 5
[
5 6
GetRandomInt
6 B
(
B C
rng
C F
,
F G
Punctuations
H T
.
T U
Length
U [
)
[ \
]
\ ]
;
] ^
}
 
return
 
new
 
string
 !
(
! "
characterBuffer
" 1
)
1 2
;
2 3
}
 
}
 	
private
 
static
 
int
 
GetRandomInt
 '
(
' (#
RandomNumberGenerator
( =
randomGenerator
> M
)
M N
{
 	
var
 
buffer
 
=
 
new
 
byte
 !
[
! "
$num
" #
]
# $
;
$ %
randomGenerator
 
.
 
GetBytes
 $
(
$ %
buffer
% +
)
+ ,
;
, -
return
 
BitConverter
 
.
  
ToInt32
  '
(
' (
buffer
( .
)
. /
;
/ 0
}
   	
private
¡¡ 
static
¡¡ 
int
¡¡ 
GetRandomInt
¡¡ '
(
¡¡' (#
RandomNumberGenerator
¡¡( =
randomGenerator
¡¡> M
,
¡¡M N
int
¡¡O R
maxInput
¡¡S [
)
¡¡[ \
{
¢¢ 	
return
££ 
Math
££ 
.
££ 
Abs
££ 
(
££ 
GetRandomInt
££ (
(
££( )
randomGenerator
££) 8
)
££8 9
%
££: ;
maxInput
££< D
)
££D E
;
££E F
}
¤¤ 	
public
§§ 
static
§§ 
string
§§ *
GenerateRandomStrongPassword
§§ 9
(
§§9 :
int
§§: =
length
§§> D
)
§§D E
{
¨¨ 	
string
©© 
	alphaCaps
©© 
=
©© 
$str
©© ;
;
©©; <
string
ªª 
alphaLow
ªª 
=
ªª 
$str
ªª :
;
ªª: ;
string
«« 
numerics
«« 
=
«« 
$str
«« *
;
««* +
string
¬¬ 
special
¬¬ 
=
¬¬ 
$str
¬¬ #
;
¬¬# $
string
­­ 
allChars
­­ 
=
­­ 
	alphaCaps
­­ '
+
­­( )
alphaLow
­­* 2
+
­­3 4
numerics
­­5 =
;
­­= >
String
¯¯ 
generatedPassword
¯¯ $
=
¯¯% &
$str
¯¯' )
;
¯¯) *
if
°° 
(
°° 
length
°° 
<
°° 
$num
°° 
)
°° 
throw
±± 
new
±± 
	Exception
±± #
(
±±# $
$str
±±$ T
)
±±T U
;
±±U V
int
³³ 
	lowerpass
³³ 
,
³³ 
	upperpass
³³ $
,
³³$ %
numpass
³³& -
,
³³- .
specialchar
³³/ :
;
³³: ;
string
´´ 
posarray
´´ 
=
´´ 
$str
´´ *
;
´´* +
if
µµ 
(
µµ 
length
µµ 
<
µµ 
posarray
µµ !
.
µµ! "
Length
µµ" (
)
µµ( )
posarray
¶¶ 
=
¶¶ 
posarray
¶¶ #
.
¶¶# $
	Substring
¶¶$ -
(
¶¶- .
$num
¶¶. /
,
¶¶/ 0
length
¶¶1 7
)
¶¶7 8
;
¶¶8 9
	lowerpass
·· 
=
·· 
getRandomPosition
·· )
(
··) *
ref
··* -
posarray
··. 6
)
··6 7
;
··7 8
	upperpass
¸¸ 
=
¸¸ 
getRandomPosition
¸¸ )
(
¸¸) *
ref
¸¸* -
posarray
¸¸. 6
)
¸¸6 7
;
¸¸7 8
numpass
¹¹ 
=
¹¹ 
getRandomPosition
¹¹ '
(
¹¹' (
ref
¹¹( +
posarray
¹¹, 4
)
¹¹4 5
;
¹¹5 6
specialchar
ºº 
=
ºº 
getRandomPosition
ºº +
(
ºº+ ,
ref
ºº, /
posarray
ºº0 8
)
ºº8 9
;
ºº9 :
for
½½ 
(
½½ 
int
½½ 
i
½½ 
=
½½ 
$num
½½ 
;
½½ 
i
½½ 
<
½½ 
length
½½  &
;
½½& '
i
½½( )
++
½½) +
)
½½+ ,
{
¾¾ 
if
¿¿ 
(
¿¿ 
i
¿¿ 
==
¿¿ 
	lowerpass
¿¿ "
)
¿¿" #
generatedPassword
ÀÀ %
+=
ÀÀ& (
getRandomChar
ÀÀ) 6
(
ÀÀ6 7
	alphaCaps
ÀÀ7 @
)
ÀÀ@ A
;
ÀÀA B
else
ÁÁ 
if
ÁÁ 
(
ÁÁ 
i
ÁÁ 
==
ÁÁ 
	upperpass
ÁÁ '
)
ÁÁ' (
generatedPassword
ÂÂ %
+=
ÂÂ& (
getRandomChar
ÂÂ) 6
(
ÂÂ6 7
alphaLow
ÂÂ7 ?
)
ÂÂ? @
;
ÂÂ@ A
else
ÃÃ 
if
ÃÃ 
(
ÃÃ 
i
ÃÃ 
==
ÃÃ 
numpass
ÃÃ %
)
ÃÃ% &
generatedPassword
ÄÄ %
+=
ÄÄ& (
getRandomChar
ÄÄ) 6
(
ÄÄ6 7
numerics
ÄÄ7 ?
)
ÄÄ? @
;
ÄÄ@ A
else
ÅÅ 
if
ÅÅ 
(
ÅÅ 
i
ÅÅ 
==
ÅÅ 
specialchar
ÅÅ )
)
ÅÅ) *
generatedPassword
ÆÆ %
+=
ÆÆ& (
getRandomChar
ÆÆ) 6
(
ÆÆ6 7
special
ÆÆ7 >
)
ÆÆ> ?
;
ÆÆ? @
else
ÇÇ 
generatedPassword
ÈÈ %
+=
ÈÈ& (
getRandomChar
ÈÈ) 6
(
ÈÈ6 7
allChars
ÈÈ7 ?
)
ÈÈ? @
;
ÈÈ@ A
}
ÉÉ 
return
ÊÊ 
generatedPassword
ÊÊ $
;
ÊÊ$ %
}
ËË 	
private
ÎÎ 
static
ÎÎ 
string
ÎÎ 
getRandomChar
ÎÎ +
(
ÎÎ+ ,
string
ÎÎ, 2

fullString
ÎÎ3 =
)
ÎÎ= >
{
ÏÏ 	
return
ĞĞ 

fullString
ĞĞ 
.
ĞĞ 
ToCharArray
ĞĞ )
(
ĞĞ) *
)
ĞĞ* +
[
ĞĞ+ ,
(
ĞĞ, -
int
ĞĞ- 0
)
ĞĞ0 1
Math
ĞĞ1 5
.
ĞĞ5 6
Floor
ĞĞ6 ;
(
ĞĞ; <
new
ĞĞ< ?
Random
ĞĞ@ F
(
ĞĞF G
)
ĞĞG H
.
ĞĞH I

NextDouble
ĞĞI S
(
ĞĞS T
)
ĞĞT U
*
ĞĞV W

fullString
ĞĞX b
.
ĞĞb c
Length
ĞĞc i
)
ĞĞi j
]
ĞĞj k
.
ĞĞk l
ToString
ĞĞl t
(
ĞĞt u
)
ĞĞu v
;
ĞĞv w
}
ÑÑ 	
private
ÓÓ 
static
ÓÓ 
int
ÓÓ 
getRandomPosition
ÓÓ ,
(
ÓÓ, -
ref
ÓÓ- 0
string
ÓÓ1 7
posArray
ÓÓ8 @
)
ÓÓ@ A
{
ÔÔ 	
int
ÕÕ 
pos
ÕÕ 
;
ÕÕ 
string
ÖÖ 

randomChar
ÖÖ 
=
ÖÖ 
posArray
ÖÖ  (
.
ÖÖ( )
ToCharArray
ÖÖ) 4
(
ÖÖ4 5
)
ÖÖ5 6
[
ÖÖ6 7
(
ÖÖ7 8
int
ÖÖ8 ;
)
ÖÖ; <
Math
ÖÖ< @
.
ÖÖ@ A
Floor
ÖÖA F
(
ÖÖF G
new
ÖÖG J
Random
ÖÖK Q
(
ÖÖQ R
)
ÖÖR S
.
ÖÖS T

NextDouble
ÖÖT ^
(
ÖÖ^ _
)
ÖÖ_ `
*
ÖÖa b
posArray
ÖÖc k
.
ÖÖk l
Length
ÖÖl r
)
ÖÖr s
]
ÖÖs t
.
ÖÖt u
ToString
ÖÖu }
(
ÖÖ} ~
)
ÖÖ~ 
;ÖÖ 
pos
×× 
=
×× 
int
×× 
.
×× 
Parse
×× 
(
×× 

randomChar
×× &
)
××& '
;
××' (
posArray
ØØ 
=
ØØ 
posArray
ØØ 
.
ØØ  
Replace
ØØ  '
(
ØØ' (

randomChar
ØØ( 2
,
ØØ2 3
$str
ØØ4 6
)
ØØ6 7
;
ØØ7 8
return
ÙÙ 
pos
ÙÙ 
;
ÙÙ 
}
ÚÚ 	
public
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
<
ÜÜ 
APIResponse
ÜÜ %
>
ÜÜ% &

CallWebAPI
ÜÜ' 1
(
ÜÜ1 2
object
ÜÜ2 8

dataobject
ÜÜ9 C
)
ÜÜC D
{
İİ 	
try
ßß 
{
àà 
APIResponse
ãã 
objApiResponse
ãã *
=
ãã+ ,
new
ãã- 0
APIResponse
ãã1 <
(
ãã< =
)
ãã= >
;
ãã> ?
using
ää 
(
ää 
var
ää 
client
ää !
=
ää" #
new
ää$ '

HttpClient
ää( 2
(
ää2 3
)
ää3 4
)
ää4 5
{
åå 
client
çç 
.
çç 
BaseAddress
çç &
=
çç' (
new
çç) ,
Uri
çç- 0
(
çç0 1
Convert
çç1 8
.
çç8 9
ToString
çç9 A
(
ççA B"
_bocwRegistrationAPI
ççB V
)
ççV W
)
ççW X
;
ççX Y
client
ëë 
.
ëë #
DefaultRequestHeaders
ëë 0
.
ëë0 1
Accept
ëë1 7
.
ëë7 8
Add
ëë8 ;
(
ëë; <
new
ëë< ?-
MediaTypeWithQualityHeaderValue
ëë@ _
(
ëë_ `
$str
ëë` r
)
ëër s
)
ëës t
;
ëët u
client
ìì 
.
ìì #
DefaultRequestHeaders
ìì 0
.
ìì0 1
Add
ìì1 4
(
ìì4 5
$str
ìì5 D
,
ììD E
_bocwAuthHeader
ììF U
)
ììU V
;
ììV W!
HttpResponseMessage
ğğ '
response
ğğ( 0
=
ğğ1 2
new
ğğ3 6!
HttpResponseMessage
ğğ7 J
(
ğğJ K
)
ğğK L
;
ğğL M
response
ûû 
=
ûû 
await
ûû $
client
ûû% +
.
ûû+ ,
PostAsJsonAsync
ûû, ;
(
ûû; <"
_bocwRegistrationAPI
ûû< P
,
ûûP Q

dataobject
ûûR \
)
ûû\ ]
;
ûû] ^
if
ÿÿ 
(
ÿÿ 
response
ÿÿ  
.
ÿÿ  !!
IsSuccessStatusCode
ÿÿ! 4
)
ÿÿ4 5
{
 
var
 
result
 "
=
# $
response
% -
.
- .
Content
. 5
.
5 6
ReadAsStringAsync
6 G
(
G H
)
H I
.
I J
Result
J P
;
P Q
objApiResponse
 &
.
& '
Result
' -
=
. /
result
0 6
;
6 7
}
 
}
 
return
 
objApiResponse
 %
;
% &
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
throw
 
;
 
}
 
}
 	
public
 
static
 
String
 
CreateCTPPOSTForm
 .
(
. /
string
/ 5
url
6 9
,
9 :!
NameValueCollection
; N
data
O S
)
S T
{
 	
try
 
{
 
string
 
formID
 
=
 
$str
  -
;
- .
string
 

outputHTML
 !
=
" #
$str
$ ,
;
, -

outputHTML
 
+=
 
(
 
$str
 '
)
' (
;
( )

outputHTML
 
+=
 
(
 
$str
 F
)
F G
;
G H

outputHTML
 
+=
 
(
 
$str
 (
)
( )
;
) *

outputHTML
 
+=
 
(
 
$str
 '
)
' (
;
( )

outputHTML
 
+=
 
$str
 \
;
\ ]

outputHTML
 
+=
 
$str
 8
+
8 9
formID
: @
+
A B
$str
C O
+
P Q
url
R U
+
V W
$str
X b
+
c d
formID
e k
+
l m
$str
n r
;
r s

outputHTML
 
+=
 
$str
 2
;
2 3

outputHTML
 
+=
 
$str
 '
;
' (
foreach
 
(
 
string
 
key
  #
in
$ &
data
' +
.
+ ,
Keys
, 0
)
0 1
{
 

outputHTML
   
+=
   !
$str
  " ?
+
  @ A
key
  B E
+
  F G
$str
  H S
+
  T U
data
  V Z
[
  Z [
key
  [ ^
]
  ^ _
+
  ` a
$str
  b g
;
  g h
}
¡¡ 

outputHTML
§§ 
+=
§§ 
$str
§§ (
;
§§( )

outputHTML
¨¨ 
+=
¨¨ 
$str
¨¨ (
;
¨¨( )

outputHTML
©© 
+=
©© 
$str
©© ?
;
©©? @

outputHTML
ªª 
+=
ªª 
$str
ªª *
+
ªª* +
formID
ªª, 2
+
ªª3 4
$str
ªª5 B
;
ªªB C

outputHTML
«« 
+=
«« 
$str
«« )
;
««) *

outputHTML
¬¬ 
+=
¬¬ 
$str
¬¬ '
;
¬¬' (

outputHTML
­­ 
+=
­­ 
$str
­­ '
;
­­' (

outputHTML
®® 
+=
®® 
$str
®® '
;
®®' (
return
¯¯ 

outputHTML
¯¯ !
;
¯¯! "
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
return
³³ 
$str
³³ 
;
³³ 
}
´´ 
}
µµ 	
}
·· 
}¹¹ ú
RD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\Utility\Extensions.cs
	namespace 	
LabourCommissioner
 
. 
Common #
.# $
Utility$ +
{ 
public 

class 

Extensions 
{ 
private 
readonly 
IConfiguration '
	appConfig( 1
;1 2
private 
readonly 
IHttpClientFactory +
_clientFactory, :
;: ;
private 
readonly 
ClaimsPrincipal (
_claimPincipal) 7
;7 8
private 
readonly  
IHttpContextAccessor - 
_httpContextAccessor. B
;B C
public 

Extensions 
( 
IConfiguration (
config) /
,/ 0
IHttpClientFactory1 C
clientFactoryD Q
,Q R 
IHttpContextAccessorS g
httpContextAccessorh {
){ |
{ 	 
_httpContextAccessor  
=! "
httpContextAccessor# 6
??7 9
throw: ?
new@ C!
ArgumentNullExceptionD Y
(Y Z
nameofZ `
(` a
httpContextAccessora t
)t u
)u v
;v w
_claimPincipal 
=  
_httpContextAccessor 1
.1 2
HttpContext2 =
.= >
User> B
??C E
throwF K
newL O!
ArgumentNullExceptionP e
(e f
nameoff l
(l m!
_httpContextAccessor	m 
.
 
HttpContext
 
.
 
User
 
)
 
)
 
;
 
} 	
public 
void 
AddUpdateClaim "
(" #
string# )
key* -
,- .
string/ 5
value6 ;
); <
{ 	
var   
identity   
=   
_claimPincipal   )
.  ) *
Identity  * 2
as  3 5
ClaimsIdentity  6 D
;  D E
if!! 
(!! 
identity!! 
==!! 
null!!  
)!!  !
return"" 
;"" 
var%% 
existingClaim%% 
=%% 
identity%%  (
.%%( )
	FindFirst%%) 2
(%%2 3
key%%3 6
)%%6 7
;%%7 8
if&& 
(&& 
existingClaim&& 
!=&&  
null&&! %
)&&% &
identity'' 
.'' 
RemoveClaim'' $
(''$ %
existingClaim''% 2
)''2 3
;''3 4
identity** 
.** 
AddClaim** 
(** 
new** !
Claim**" '
(**' (
key**( +
,**+ ,
value**- 2
)**2 3
)**3 4
;**4 5 
_httpContextAccessor++  
.++  !
HttpContext++! ,
.++, -
SignInAsync++- 8
(++8 9(
CookieAuthenticationDefaults++9 U
.++U V 
AuthenticationScheme++V j
,++j k
_claimPincipal++l z
)++z {
;++{ |
},, 	
}.. 
}// ¡
ZD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\Utility\PermissionConstant.cs
	namespace 	
LabourCommissioner
 
. 
Common #
.# $
Utility$ +
{ 
public		 

enum		 
PermissionConstant		 "
{

 
IsNone 
= 
$num 
, 
IsInsert 
= 
$num 
, 
IsUpdate 
= 
$num 
, 
IsDelete 
= 
$num 
, 
IsView 
= 
$num 
} 
} á[
SD:\Azure DevOps\LabourCommissioner\LabourCommissioner.Common\Utility\UserCookies.cs
	namespace

 	
LabourCommissioner


 
.

 
Common

 #
.

# $
Utility

$ +
{ 
public 

class 
UserCookies 
{ 
private 
static  
IHttpContextAccessor + 
_httpContextAccessor, @
;@ A
private 
static 
HttpContext "
_httpContext# /
;/ 0
public 
UserCookies 
(  
IHttpContextAccessor /
httpContextAccessor0 C
)C D
{ 	 
_httpContextAccessor  
=! "
httpContextAccessor# 6
;6 7
_httpContext 
=  
_httpContextAccessor /
./ 0
HttpContext0 ;
;; <
} 	
public 
static 
int 
UserId  
{ 	
get 
{ 
if 
( 
_httpContext  
.  !
User! %
.% &
Identity& .
.. /
IsAuthenticated/ >
)> ?
{ 
return 
Convert "
." #
ToInt32# *
(* +
_httpContext+ 7
.7 8
User8 <
.< =
Claims= C
.C D
FirstOrDefaultD R
(R S
xS T
=>U W
xX Y
.Y Z
TypeZ ^
==_ a

ClaimTypesb l
.l m
NameIdentifierm {
){ |
.| }
Value	} 
)
 
;
 
} 
else 
{   
return!! 
$num!! 
;!! 
}"" 
}## 
}$$ 	
public&& 
static&& 
string&& 
UserName&& %
{'' 	
get(( 
{)) 
if** 
(** 
_httpContext**  
.**  !
User**! %
.**% &
Identity**& .
.**. /
IsAuthenticated**/ >
)**> ?
{++ 
return,, 
_httpContext,, '
.,,' (
User,,( ,
.,,, -
Claims,,- 3
.,,3 4
FirstOrDefault,,4 B
(,,B C
x,,C D
=>,,E G
x,,H I
.,,I J
Type,,J N
==,,O Q

ClaimTypes,,R \
.,,\ ]
Name,,] a
),,a b
.,,b c
Value,,c h
;,,h i
}-- 
else.. 
{// 
return00 
null00 
;00  
}11 
}22 
}33 	
public55 
static55 
string55 
RoleIds55 $
{66 	
get77 
{88 
if99 
(99 
_httpContext99  
.99  !
User99! %
.99% &
Identity99& .
.99. /
IsAuthenticated99/ >
)99> ?
{:: 
return;; 
_httpContext;; '
.;;' (
User;;( ,
.;;, -
Claims;;- 3
.;;3 4
FirstOrDefault;;4 B
(;;B C
x;;C D
=>;;E G
x;;H I
.;;I J
Type;;J N
==;;O Q

ClaimTypes;;R \
.;;\ ]
Role;;] a
);;a b
.;;b c
Value;;c h
;;;h i
}<< 
else== 
{>> 
return?? 
null?? 
;??  
}@@ 
}AA 
}BB 	
publicCC 
staticCC 
stringCC 
RegistrationIdCC +
{DD 	
getEE 
{FF 
ifGG 
(GG 
_httpContextGG  
.GG  !
UserGG! %
.GG% &
IdentityGG& .
.GG. /
IsAuthenticatedGG/ >
)GG> ?
{HH 
returnII 
_httpContextII '
.II' (
UserII( ,
.II, -
ClaimsII- 3
.II3 4
FirstOrDefaultII4 B
(IIB C
xIIC D
=>IIE G
xIIH I
.III J
TypeIIJ N
==IIO Q
$strIIR b
)IIb c
.IIc d
ValueIId i
;IIi j
}JJ 
elseKK 
{LL 
returnMM 
nullMM 
;MM  
}NN 
}OO 
}PP 	
publicRR 
staticRR 
stringRR 
UserTypeRR %
{SS 	
getTT 
{UU 
ifVV 
(VV 
_httpContextVV  
.VV  !
UserVV! %
.VV% &
IdentityVV& .
.VV. /
IsAuthenticatedVV/ >
)VV> ?
{WW 
returnXX 
_httpContextXX '
.XX' (
UserXX( ,
.XX, -
ClaimsXX- 3
.XX3 4
FirstOrDefaultXX4 B
(XXB C
xXXC D
=>XXE G
xXXH I
.XXI J
TypeXXJ N
==XXO Q
$strXXR \
)XX\ ]
.XX] ^
ValueXX^ c
;XXc d
}YY 
elseZZ 
{[[ 
return\\ 
null\\ 
;\\  
}]] 
}^^ 
}__ 	
publicaa 
staticaa 
stringaa 
DisplayNameaa (
{bb 	
getcc 
{dd 
ifee 
(ee 
_httpContextee  
.ee  !
Useree! %
.ee% &
Identityee& .
.ee. /
IsAuthenticatedee/ >
)ee> ?
{ff 
returngg 
_httpContextgg '
.gg' (
Usergg( ,
.gg, -
Claimsgg- 3
.gg3 4
FirstOrDefaultgg4 B
(ggB C
xggC D
=>ggE G
xggH I
.ggI J
TypeggJ N
==ggO Q
$strggR _
)gg_ `
.gg` a
Valuegga f
;ggf g
}hh 
elseii 
{jj 
returnkk 
nullkk 
;kk  
}ll 
}mm 
}nn 	
publicoo 
staticoo 
stringoo 
MobileNooo %
{pp 	
getqq 
{rr 
ifss 
(ss 
_httpContextss  
.ss  !
Userss! %
.ss% &
Identityss& .
.ss. /
IsAuthenticatedss/ >
)ss> ?
{tt 
returnuu 
_httpContextuu '
.uu' (
Useruu( ,
.uu, -
Claimsuu- 3
.uu3 4
FirstOrDefaultuu4 B
(uuB C
xuuC D
=>uuE G
xuuH I
.uuI J
TypeuuJ N
==uuO Q
$struuR \
)uu\ ]
.uu] ^
Valueuu^ c
;uuc d
}vv 
elseww 
{xx 
returnyy 
nullyy 
;yy  
}zz 
}{{ 
}|| 	
public}} 
static}} 
string}} 
EmailId}} $
{~~ 	
get 
{
 
if
 
(
 
_httpContext
  
.
  !
User
! %
.
% &
Identity
& .
.
. /
IsAuthenticated
/ >
)
> ?
{
 
return
 
_httpContext
 '
.
' (
User
( ,
.
, -
Claims
- 3
.
3 4
FirstOrDefault
4 B
(
B C
x
C D
=>
E G
x
H I
.
I J
Type
J N
==
O Q
$str
R [
)
[ \
.
\ ]
Value
] b
;
b c
}
 
else
 
{
 
return
 
null
 
;
  
}
 
}
 
}
 	
public
 
static
 
string
 
BeneficiaryType
 ,
{
 	
get
 
{
 
if
 
(
 
_httpContext
  
.
  !
User
! %
.
% &
Identity
& .
.
. /
IsAuthenticated
/ >
)
> ?
{
 
return
 
_httpContext
 '
.
' (
User
( ,
.
, -
Claims
- 3
.
3 4
FirstOrDefault
4 B
(
B C
x
C D
=>
E G
x
H I
.
I J
Type
J N
==
O Q
$str
R c
)
c d
.
d e
Value
e j
;
j k
}
 
else
 
{
 
return
 
null
 
;
  
}
 
}
 
}
 	
public
 
static
 
int
 
PostId
  
{
 	
get
 
{
 
if
 
(
 
_httpContext
  
.
  !
User
! %
.
% &
Identity
& .
.
. /
IsAuthenticated
/ >
)
> ?
{
 
return
 
Convert
 "
.
" #
ToInt32
# *
(
* +
_httpContext
+ 7
.
7 8
User
8 <
.
< =
Claims
= C
.
C D
FirstOrDefault
D R
(
R S
x
S T
=>
U W
x
X Y
.
Y Z
Type
Z ^
==
_ a
$str
b j
)
j k
.
k l
Value
l q
)
q r
;
r s
}
   
else
¡¡ 
{
¢¢ 
return
££ 
$num
££ 
;
££ 
}
¤¤ 
}
¥¥ 
}
¦¦ 	
public
¨¨ 
static
¨¨ 
int
¨¨ 
	ServiceId
¨¨ #
{
©© 	
get
ªª 
{
«« 
if
¬¬ 
(
¬¬ 
_httpContext
¬¬  
.
¬¬  !
User
¬¬! %
.
¬¬% &
Identity
¬¬& .
.
¬¬. /
IsAuthenticated
¬¬/ >
)
¬¬> ?
{
­­ 
return
®® 
Convert
®® "
.
®®" #
ToInt32
®®# *
(
®®* +
_httpContext
®®+ 7
.
®®7 8
User
®®8 <
.
®®< =
Claims
®®= C
.
®®C D
FirstOrDefault
®®D R
(
®®R S
x
®®S T
=>
®®U W
x
®®X Y
.
®®Y Z
Type
®®Z ^
==
®®_ a
$str
®®b m
)
®®m n
.
®®n o
Value
®®o t
)
®®t u
;
®®u v
}
¯¯ 
else
°° 
{
±± 
return
²² 
$num
²² 
;
²² 
}
³³ 
}
´´ 
}
µµ 	
public
¸¸ 
static
¸¸ 
string
¸¸ 
GetIpAddress
¸¸ )
(
¸¸) *
)
¸¸* +
{
¹¹ 	
return
ºº 
_httpContext
ºº 
.
ºº  

Connection
ºº  *
.
ºº* +
RemoteIpAddress
ºº+ :
.
ºº: ;
ToString
ºº; C
(
ººC D
)
ººD E
;
ººE F
}
»» 	
public
½½ 
static
½½ 
string
½½ 
GetHostName
½½ (
(
½½( )
)
½½) *
{
¾¾ 	
return
¿¿ 
Dns
¿¿ 
.
¿¿ 
GetHostEntry
¿¿ #
(
¿¿# $
_httpContext
¿¿$ 0
.
¿¿0 1

Connection
¿¿1 ;
.
¿¿; <
RemoteIpAddress
¿¿< K
)
¿¿K L
.
¿¿L M
HostName
¿¿M U
.
¿¿U V
ToString
¿¿V ^
(
¿¿^ _
)
¿¿_ `
;
¿¿` a
}
ÀÀ 	
}
ÁÁ 
}ÂÂ 